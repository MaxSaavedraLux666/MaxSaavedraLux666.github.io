import{a as R,b as W}from"./chunk-JVKVJX4K.js";import{a as H,b as O,c as P,d as Z,e as z,f as A,g as Q,h as J,i as q}from"./chunk-325QIRXI.js";import"./chunk-TL5N3MSS.js";import{$a as M,Aa as p,Ba as g,Bb as b,Cb as L,Db as B,Ib as D,Jb as F,Ta as c,Xb as G,gb as w,hb as E,ib as N,la as f,ob as a,pa as _,pb as o,qb as m,rb as T,sb as x,xb as V,ya as C,yb as k,za as v,zb as j}from"./chunk-JSW376PB.js";var K=["chatContainer"],U=h=>({"background-image":h}),ie=(()=>{let d=class d{constructor(){this.fb=f(J),this.chatService=f(W),this.form=this.fb.group({message:["",O.required]}),this.getChatItems=G(()=>this.chatService.chatItems()),this.getChatItem=M(null)}scrollToBottom(){this.chatContainer&&(this.chatContainer.nativeElement.scrollTop=this.chatContainer.nativeElement.scrollHeight)}pushMessage(l,n){n&&this.chatContainer&&(this.chatContainer.nativeElement.innerHTML=""),l.forEach(e=>{if(this.chatContainer)if(e.isMe){let t=document.createElement("div");t.className="flex flex-col items-end py-6 px-16 ml-2";let r=document.createElement("div");r.className="break-words overflow-hidden flex justify-center items-center bg-blue-500 text-white rounded-t-lg rounded-bl-lg p-4 my-2";let i=document.createElement("span");i.style.maxWidth="40rem",i.textContent=e.message;let s=document.createElement("span");s.className="text-gray-500 text-sm",s.textContent=e.time,r.appendChild(i),t.appendChild(r),t.appendChild(s),this.chatContainer.nativeElement.appendChild(t)}else{let t=document.createElement("div");t.className="flex flex-col items-start py-6 px-16 mr-2 text-gray-500";let r=document.createElement("span");r.className="font-semibold text-base",r.textContent=this.getChatItem()?.profileName||"";let i=document.createElement("div");i.className="break-words overflow-hidden flex justify-center items-center bg-gray-200 rounded-b-lg rounded-tr-lg p-4 my-2";let s=document.createElement("span");s.style.maxWidth="40rem",s.textContent=e.message;let u=document.createElement("span");u.className="text-sm",u.textContent=e.time,i.appendChild(s),t.appendChild(r),t.appendChild(i),t.appendChild(u),this.chatContainer.nativeElement.appendChild(t)}})}ngOnInit(){this.chatItemToLocalStorage()}chatItemToLocalStorage(){localStorage.getItem("chatItems")===null?localStorage.setItem("chatItems",JSON.stringify(this.chatService.chatItems())):this.chatService.chatItems.set(JSON.parse(localStorage.getItem("chatItems")))}onSendMessage(){if(!this.form.invalid){if(this.form.value.message===null||this.form.value.message===void 0)return null;if(this.getChatItem()!==null){let l={message:this.form.value.message,time:new Date().toLocaleTimeString("es-PE",{hour:"2-digit",minute:"2-digit"}),isMe:!0};this.getChatItem.update(n=>n===null?null:(n.message.push(l),n)),this.chatService.chatItems.update(n=>(n.map(e=>(e.profileName===this.getChatItem().profileName&&(e.message=this.getChatItem().message),e)),localStorage.setItem("chatItems",JSON.stringify(n)),n)),this.pushMessage([l])}return this.form.reset(),console.log("Message sent"),this.scrollToBottom(),null}}selectChatItem(l){this.getChatItem.set(l),this.pushMessage(l?.message||[],!0),this.scrollToBottom()}};d.\u0275fac=function(n){return new(n||d)},d.\u0275cmp=_({type:d,selectors:[["app-chat-page"]],viewQuery:function(n,e){if(n&1&&V(K,5),n&2){let t;k(t=j())&&(e.chatContainer=t.first)}},standalone:!0,features:[D],decls:31,vars:18,consts:[["chatContainer",""],[1,"flex","flex-row","h-full","items-center","mx-2"],[1,"chat-messages","w-full","h-full","py-2"],[1,"w-full","h-full","flex","flex-col","bg-white","rounded-xl"],[1,"flex","flex-row","py-5","px-8","border-solid","border-y"],[1,"chat-img","flex","flex-none","justify-end","items-end","w-14","h-14","bg-cover","bg-center"],[1,"w-4","h-4","m-0.5","rounded-full","border-solid","border-2","border-white"],[1,"w-full","flex","flex-col","justify-center","font-semibold","space-y-0","mx-4","pr-28"],[1,"text-sm","text-gray-500","overflow-hidden","overflow-ellipsis","whitespace-nowrap"],[1,"flex","justify-center","items-center","text-gray-500"],[1,"bg-gray-200","rounded","py-2","px-4","border","border-solid"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 576 512","stroke","currentColor","fill","currentColor",1,"size-6"],["d","M0 128C0 92.7 28.7 64 64 64H320c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128zM559.1 99.8c10.4 5.6 16.9 16.4 16.9 28.2V384c0 11.8-6.5 22.6-16.9 28.2s-23 5-32.9-1.6l-96-64L416 337.1V320 192 174.9l14.2-9.5 96-64c9.8-6.5 22.4-7.2 32.9-1.6z"],[1,"flex","flex-col","overflow-y-auto"],[1,"w-full","grow","self-end","flex","flex-row","p-4","border-solid","border-t"],["autocomplete","off",1,"w-full",3,"ngSubmit","formGroup"],[1,"w-full","flex","flex-row","text-gray-500"],[1,"w-full","flex","flex-row","space-x-2","border-solid","rounded","border-2","p-4","bg-gray-100","focus-within:border-gray-400","transition-colors","duration-150"],["type","text","placeholder","Escribe un mensaje...","formControlName","message",1,"w-full","border-0","p-0","m-0","focus:outline-none","focus:shadow-none","bg-gray-100"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-6"],["stroke-linecap","round","stroke-linejoin","round","d","m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13"],["stroke-linecap","round","stroke-linejoin","round","d","M15.182 15.182a4.5 4.5 0 0 1-6.364 0M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0ZM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Z"],["type","submit",1,"bg-blue-500","text-white","rounded-md","p-4","ml-2"],["stroke-linecap","round","stroke-linejoin","round","d","M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"],[1,"w-[30rem]","h-full","grow"],[3,"selectedChatItem","chatItems"]],template:function(n,e){if(n&1){let t=T();a(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),m(5,"span",6),o(),a(6,"div",7)(7,"span"),b(8),o(),a(9,"span",8),b(10),o()(),a(11,"div",9)(12,"div",10),p(),a(13,"svg",11),m(14,"path",12),o()()()(),g(),m(15,"div",13,0),a(17,"div",14)(18,"form",15),x("ngSubmit",function(){return C(t),v(e.onSendMessage())}),a(19,"div",16)(20,"label",17),m(21,"input",18),p(),a(22,"svg",19),m(23,"path",20),o(),a(24,"svg",19),m(25,"path",21),o()(),g(),a(26,"button",22),p(),a(27,"svg",19),m(28,"path",23),o()()()()()()(),g(),a(29,"div",24)(30,"dashboard-search-card",25),x("selectedChatItem",function(i){return C(t),v(e.selectChatItem(i))}),o()()()}if(n&2){let t,r,i,s,u,y,I,S;c(4),N(F(16,U,"url("+((t=e.getChatItem())==null?null:t.profileImage)+")")),c(),E("bg-green-500",((r=e.getChatItem())==null?null:r.status)==="En l\xEDnea")("bg-red-500",((i=e.getChatItem())==null?null:i.status)==="Ocupado")("bg-gray-500",((s=e.getChatItem())==null?null:s.status)==="Desconectado")("bg-yellow-500",((u=e.getChatItem())==null?null:u.status)==="Ausente")("bg-blue-500",((y=e.getChatItem())==null?null:y.status)==="En llamada"),c(3),L((I=e.getChatItem())==null?null:I.profileName),c(2),B(" ",(S=e.getChatItem())==null?null:S.status," "),c(8),w("formGroup",e.form),c(12),w("chatItems",e.getChatItems())}},dependencies:[R,q,z,H,P,Z,A,Q],styles:["[_nghost-%COMP%]{width:100%!important}.chat-img[_ngcontent-%COMP%]{border-radius:50%}"]});let h=d;return h})();export{ie as default};
