import{a as hl,b as fl}from"./chunk-JVKVJX4K.js";import{b as nl,c as sl,d as rl,e as al,f as ol,g as cl,h as ll,i as ul,j as dl}from"./chunk-325QIRXI.js";import"./chunk-TL5N3MSS.js";import{$a as ge,Aa as Me,Ba as Ji,Bb as xt,Db as tl,F as Vc,G as jc,Ga as Jc,H as Mc,Ha as ys,I as Wi,Ib as Dt,J as $c,Jb as il,L as ri,M as Wc,N as Hc,R as pe,S as ai,Ta as me,X as qc,Xb as ks,Yb as At,Z as ve,_ as oi,a as E,b as L,ba as Hi,c as ps,d as yt,e as ni,eb as ot,f as si,fa as Gc,g as b,gb as ct,h as $i,i as Lc,ib as Kc,j as Fc,k as Bc,kb as lt,la as at,lb as zc,mb as Xc,nb as Yc,ob as J,pa as Ot,pb as Z,q as F,qb as be,r as ms,rb as Ss,sb as ut,t as gs,tb as ci,u as bs,xb as Qc,y as we,ya as qi,yb as Zc,z as Nt,za as Gi,zb as el}from"./chunk-JSW376PB.js";var zs=yt((Qm,Ks)=>{"use strict";var w={};w.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)};w.localCName=w.generateIdentifier();w.splitLines=function(i){return i.trim().split(`
`).map(e=>e.trim())};w.splitSections=function(i){return i.split(`
m=`).map((t,n)=>(n>0?"m="+t:t).trim()+`\r
`)};w.getDescription=function(i){let e=w.splitSections(i);return e&&e[0]};w.getMediaSections=function(i){let e=w.splitSections(i);return e.shift(),e};w.matchPrefix=function(i,e){return w.splitLines(i).filter(t=>t.indexOf(e)===0)};w.parseCandidate=function(i){let e;i.indexOf("a=candidate:")===0?e=i.substring(12).split(" "):e=i.substring(10).split(" ");let t={foundation:e[0],component:{1:"rtp",2:"rtcp"}[e[1]]||e[1],protocol:e[2].toLowerCase(),priority:parseInt(e[3],10),ip:e[4],address:e[4],port:parseInt(e[5],10),type:e[7]};for(let n=8;n<e.length;n+=2)switch(e[n]){case"raddr":t.relatedAddress=e[n+1];break;case"rport":t.relatedPort=parseInt(e[n+1],10);break;case"tcptype":t.tcpType=e[n+1];break;case"ufrag":t.ufrag=e[n+1],t.usernameFragment=e[n+1];break;default:t[e[n]]===void 0&&(t[e[n]]=e[n+1]);break}return t};w.writeCandidate=function(i){let e=[];e.push(i.foundation);let t=i.component;t==="rtp"?e.push(1):t==="rtcp"?e.push(2):e.push(t),e.push(i.protocol.toUpperCase()),e.push(i.priority),e.push(i.address||i.ip),e.push(i.port);let n=i.type;return e.push("typ"),e.push(n),n!=="host"&&i.relatedAddress&&i.relatedPort&&(e.push("raddr"),e.push(i.relatedAddress),e.push("rport"),e.push(i.relatedPort)),i.tcpType&&i.protocol.toLowerCase()==="tcp"&&(e.push("tcptype"),e.push(i.tcpType)),(i.usernameFragment||i.ufrag)&&(e.push("ufrag"),e.push(i.usernameFragment||i.ufrag)),"candidate:"+e.join(" ")};w.parseIceOptions=function(i){return i.substring(14).split(" ")};w.parseRtpMap=function(i){let e=i.substring(9).split(" "),t={payloadType:parseInt(e.shift(),10)};return e=e[0].split("/"),t.name=e[0],t.clockRate=parseInt(e[1],10),t.channels=e.length===3?parseInt(e[2],10):1,t.numChannels=t.channels,t};w.writeRtpMap=function(i){let e=i.payloadType;i.preferredPayloadType!==void 0&&(e=i.preferredPayloadType);let t=i.channels||i.numChannels||1;return"a=rtpmap:"+e+" "+i.name+"/"+i.clockRate+(t!==1?"/"+t:"")+`\r
`};w.parseExtmap=function(i){let e=i.substring(9).split(" ");return{id:parseInt(e[0],10),direction:e[0].indexOf("/")>0?e[0].split("/")[1]:"sendrecv",uri:e[1],attributes:e.slice(2).join(" ")}};w.writeExtmap=function(i){return"a=extmap:"+(i.id||i.preferredId)+(i.direction&&i.direction!=="sendrecv"?"/"+i.direction:"")+" "+i.uri+(i.attributes?" "+i.attributes:"")+`\r
`};w.parseFmtp=function(i){let e={},t,n=i.substring(i.indexOf(" ")+1).split(";");for(let s=0;s<n.length;s++)t=n[s].trim().split("="),e[t[0].trim()]=t[1];return e};w.writeFmtp=function(i){let e="",t=i.payloadType;if(i.preferredPayloadType!==void 0&&(t=i.preferredPayloadType),i.parameters&&Object.keys(i.parameters).length){let n=[];Object.keys(i.parameters).forEach(s=>{i.parameters[s]!==void 0?n.push(s+"="+i.parameters[s]):n.push(s)}),e+="a=fmtp:"+t+" "+n.join(";")+`\r
`}return e};w.parseRtcpFb=function(i){let e=i.substring(i.indexOf(" ")+1).split(" ");return{type:e.shift(),parameter:e.join(" ")}};w.writeRtcpFb=function(i){let e="",t=i.payloadType;return i.preferredPayloadType!==void 0&&(t=i.preferredPayloadType),i.rtcpFeedback&&i.rtcpFeedback.length&&i.rtcpFeedback.forEach(n=>{e+="a=rtcp-fb:"+t+" "+n.type+(n.parameter&&n.parameter.length?" "+n.parameter:"")+`\r
`}),e};w.parseSsrcMedia=function(i){let e=i.indexOf(" "),t={ssrc:parseInt(i.substring(7,e),10)},n=i.indexOf(":",e);return n>-1?(t.attribute=i.substring(e+1,n),t.value=i.substring(n+1)):t.attribute=i.substring(e+1),t};w.parseSsrcGroup=function(i){let e=i.substring(13).split(" ");return{semantics:e.shift(),ssrcs:e.map(t=>parseInt(t,10))}};w.getMid=function(i){let e=w.matchPrefix(i,"a=mid:")[0];if(e)return e.substring(6)};w.parseFingerprint=function(i){let e=i.substring(14).split(" ");return{algorithm:e[0].toLowerCase(),value:e[1].toUpperCase()}};w.getDtlsParameters=function(i,e){return{role:"auto",fingerprints:w.matchPrefix(i+e,"a=fingerprint:").map(w.parseFingerprint)}};w.writeDtlsParameters=function(i,e){let t="a=setup:"+e+`\r
`;return i.fingerprints.forEach(n=>{t+="a=fingerprint:"+n.algorithm+" "+n.value+`\r
`}),t};w.parseCryptoLine=function(i){let e=i.substring(9).split(" ");return{tag:parseInt(e[0],10),cryptoSuite:e[1],keyParams:e[2],sessionParams:e.slice(3)}};w.writeCryptoLine=function(i){return"a=crypto:"+i.tag+" "+i.cryptoSuite+" "+(typeof i.keyParams=="object"?w.writeCryptoKeyParams(i.keyParams):i.keyParams)+(i.sessionParams?" "+i.sessionParams.join(" "):"")+`\r
`};w.parseCryptoKeyParams=function(i){if(i.indexOf("inline:")!==0)return null;let e=i.substring(7).split("|");return{keyMethod:"inline",keySalt:e[0],lifeTime:e[1],mkiValue:e[2]?e[2].split(":")[0]:void 0,mkiLength:e[2]?e[2].split(":")[1]:void 0}};w.writeCryptoKeyParams=function(i){return i.keyMethod+":"+i.keySalt+(i.lifeTime?"|"+i.lifeTime:"")+(i.mkiValue&&i.mkiLength?"|"+i.mkiValue+":"+i.mkiLength:"")};w.getCryptoParameters=function(i,e){return w.matchPrefix(i+e,"a=crypto:").map(w.parseCryptoLine)};w.getIceParameters=function(i,e){let t=w.matchPrefix(i+e,"a=ice-ufrag:")[0],n=w.matchPrefix(i+e,"a=ice-pwd:")[0];return t&&n?{usernameFragment:t.substring(12),password:n.substring(10)}:null};w.writeIceParameters=function(i){let e="a=ice-ufrag:"+i.usernameFragment+`\r
a=ice-pwd:`+i.password+`\r
`;return i.iceLite&&(e+=`a=ice-lite\r
`),e};w.parseRtpParameters=function(i){let e={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=w.splitLines(i)[0].split(" ");e.profile=n[2];for(let r=3;r<n.length;r++){let o=n[r],a=w.matchPrefix(i,"a=rtpmap:"+o+" ")[0];if(a){let l=w.parseRtpMap(a),c=w.matchPrefix(i,"a=fmtp:"+o+" ");switch(l.parameters=c.length?w.parseFmtp(c[0]):{},l.rtcpFeedback=w.matchPrefix(i,"a=rtcp-fb:"+o+" ").map(w.parseRtcpFb),e.codecs.push(l),l.name.toUpperCase()){case"RED":case"ULPFEC":e.fecMechanisms.push(l.name.toUpperCase());break;default:break}}}w.matchPrefix(i,"a=extmap:").forEach(r=>{e.headerExtensions.push(w.parseExtmap(r))});let s=w.matchPrefix(i,"a=rtcp-fb:* ").map(w.parseRtcpFb);return e.codecs.forEach(r=>{s.forEach(o=>{r.rtcpFeedback.find(l=>l.type===o.type&&l.parameter===o.parameter)||r.rtcpFeedback.push(o)})}),e};w.writeRtpDescription=function(i,e){let t="";t+="m="+i+" ",t+=e.codecs.length>0?"9":"0",t+=" "+(e.profile||"UDP/TLS/RTP/SAVPF")+" ",t+=e.codecs.map(s=>s.preferredPayloadType!==void 0?s.preferredPayloadType:s.payloadType).join(" ")+`\r
`,t+=`c=IN IP4 0.0.0.0\r
`,t+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,e.codecs.forEach(s=>{t+=w.writeRtpMap(s),t+=w.writeFmtp(s),t+=w.writeRtcpFb(s)});let n=0;return e.codecs.forEach(s=>{s.maxptime>n&&(n=s.maxptime)}),n>0&&(t+="a=maxptime:"+n+`\r
`),e.headerExtensions&&e.headerExtensions.forEach(s=>{t+=w.writeExtmap(s)}),t};w.parseRtpEncodingParameters=function(i){let e=[],t=w.parseRtpParameters(i),n=t.fecMechanisms.indexOf("RED")!==-1,s=t.fecMechanisms.indexOf("ULPFEC")!==-1,r=w.matchPrefix(i,"a=ssrc:").map(u=>w.parseSsrcMedia(u)).filter(u=>u.attribute==="cname"),o=r.length>0&&r[0].ssrc,a,l=w.matchPrefix(i,"a=ssrc-group:FID").map(u=>u.substring(17).split(" ").map(d=>parseInt(d,10)));l.length>0&&l[0].length>1&&l[0][0]===o&&(a=l[0][1]),t.codecs.forEach(u=>{if(u.name.toUpperCase()==="RTX"&&u.parameters.apt){let h={ssrc:o,codecPayloadType:parseInt(u.parameters.apt,10)};o&&a&&(h.rtx={ssrc:a}),e.push(h),n&&(h=JSON.parse(JSON.stringify(h)),h.fec={ssrc:o,mechanism:s?"red+ulpfec":"red"},e.push(h))}}),e.length===0&&o&&e.push({ssrc:o});let c=w.matchPrefix(i,"b=");return c.length&&(c[0].indexOf("b=TIAS:")===0?c=parseInt(c[0].substring(7),10):c[0].indexOf("b=AS:")===0?c=parseInt(c[0].substring(5),10)*1e3*.95-50*40*8:c=void 0,e.forEach(u=>{u.maxBitrate=c})),e};w.parseRtcpParameters=function(i){let e={},t=w.matchPrefix(i,"a=ssrc:").map(r=>w.parseSsrcMedia(r)).filter(r=>r.attribute==="cname")[0];t&&(e.cname=t.value,e.ssrc=t.ssrc);let n=w.matchPrefix(i,"a=rtcp-rsize");e.reducedSize=n.length>0,e.compound=n.length===0;let s=w.matchPrefix(i,"a=rtcp-mux");return e.mux=s.length>0,e};w.writeRtcpParameters=function(i){let e="";return i.reducedSize&&(e+=`a=rtcp-rsize\r
`),i.mux&&(e+=`a=rtcp-mux\r
`),i.ssrc!==void 0&&i.cname&&(e+="a=ssrc:"+i.ssrc+" cname:"+i.cname+`\r
`),e};w.parseMsid=function(i){let e,t=w.matchPrefix(i,"a=msid:");if(t.length===1)return e=t[0].substring(7).split(" "),{stream:e[0],track:e[1]};let n=w.matchPrefix(i,"a=ssrc:").map(s=>w.parseSsrcMedia(s)).filter(s=>s.attribute==="msid");if(n.length>0)return e=n[0].value.split(" "),{stream:e[0],track:e[1]}};w.parseSctpDescription=function(i){let e=w.parseMLine(i),t=w.matchPrefix(i,"a=max-message-size:"),n;t.length>0&&(n=parseInt(t[0].substring(19),10)),isNaN(n)&&(n=65536);let s=w.matchPrefix(i,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substring(12),10),protocol:e.fmt,maxMessageSize:n};let r=w.matchPrefix(i,"a=sctpmap:");if(r.length>0){let o=r[0].substring(10).split(" ");return{port:parseInt(o[0],10),protocol:o[1],maxMessageSize:n}}};w.writeSctpDescription=function(i,e){let t=[];return i.protocol!=="DTLS/SCTP"?t=["m="+i.kind+" 9 "+i.protocol+" "+e.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+e.port+`\r
`]:t=["m="+i.kind+" 9 "+i.protocol+" "+e.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+e.port+" "+e.protocol+` 65535\r
`],e.maxMessageSize!==void 0&&t.push("a=max-message-size:"+e.maxMessageSize+`\r
`),t.join("")};w.generateSessionId=function(){return Math.random().toString().substr(2,22)};w.writeSessionBoilerplate=function(i,e,t){let n,s=e!==void 0?e:2;return i?n=i:n=w.generateSessionId(),`v=0\r
o=`+(t||"thisisadapterortc")+" "+n+" "+s+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`};w.getDirection=function(i,e){let t=w.splitLines(i);for(let n=0;n<t.length;n++)switch(t[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return t[n].substring(2);default:}return e?w.getDirection(e):"sendrecv"};w.getKind=function(i){return w.splitLines(i)[0].split(" ")[0].substring(2)};w.isRejected=function(i){return i.split(" ",2)[1]==="0"};w.parseMLine=function(i){let t=w.splitLines(i)[0].substring(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}};w.parseOLine=function(i){let t=w.matchPrefix(i,"o=")[0].substring(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}};w.isValidSDP=function(i){if(typeof i!="string"||i.length===0)return!1;let e=w.splitLines(i);for(let t=0;t<e.length;t++)if(e[t].length<2||e[t].charAt(1)!=="=")return!1;return!0};typeof Ks=="object"&&(Ks.exports=w)});var Or=yt((xC,Lu)=>{"use strict";var Uu=Lu.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(i){return i.encoding?"rtpmap:%d %s/%s/%s":i.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(i){return i.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(i){return i.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(i){return"extmap:%d"+(i.direction?"/%s":"%v")+(i["encrypt-uri"]?" %s":"%v")+" %s"+(i.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(i){return i.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(i){var e="candidate:%s %d %s %d %s %d typ %s";return e+=i.raddr!=null?" raddr %s rport %d":"%v%v",e+=i.tcptype!=null?" tcptype %s":"%v",i.generation!=null&&(e+=" generation %d"),e+=i["network-id"]!=null?" network-id %d":"%v",e+=i["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(i){var e="ssrc:%d";return i.attribute!=null&&(e+=" %s",i.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(i){return i.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(i){return i.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(i){return"imageattr:%s %s %s"+(i.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(i){return"simulcast:%s %s"+(i.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(i){return"ts-refclk:%s"+(i.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(i){var e="mediaclk:";return e+=i.id!=null?"id=%s %s":"%v%s",e+=i.mediaClockValue!=null?"=%s":"",e+=i.rateNumerator!=null?" rate=%s":"",e+=i.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(Uu).forEach(function(i){var e=Uu[i];e.forEach(function(t){t.reg||(t.reg=/(.*)/),t.format||(t.format="%s")})})});var Vu=yt(tt=>{"use strict";var Wt=function(i){return String(Number(i))===i?Number(i):i},of=function(i,e,t,n){if(n&&!t)e[n]=Wt(i[1]);else for(var s=0;s<t.length;s+=1)i[s+1]!=null&&(e[t[s]]=Wt(i[s+1]))},cf=function(i,e,t){var n=i.name&&i.names;i.push&&!e[i.push]?e[i.push]=[]:n&&!e[i.name]&&(e[i.name]={});var s=i.push?{}:n?e[i.name]:e;of(t.match(i.reg),s,i.names,i.name),i.push&&e[i.push].push(s)},Fu=Or(),lf=RegExp.prototype.test.bind(/^([a-z])=(.*)/);tt.parse=function(i){var e={},t=[],n=e;return i.split(/(\r\n|\r|\n)/).filter(lf).forEach(function(s){var r=s[0],o=s.slice(2);r==="m"&&(t.push({rtp:[],fmtp:[]}),n=t[t.length-1]);for(var a=0;a<(Fu[r]||[]).length;a+=1){var l=Fu[r][a];if(l.reg.test(o))return cf(l,n,o)}}),e.media=t,e};var Bu=function(i,e){var t=e.split(/=(.+)/,2);return t.length===2?i[t[0]]=Wt(t[1]):t.length===1&&e.length>1&&(i[t[0]]=void 0),i};tt.parseParams=function(i){return i.split(/;\s?/).reduce(Bu,{})};tt.parseFmtpConfig=tt.parseParams;tt.parsePayloads=function(i){return i.toString().split(" ").map(Number)};tt.parseRemoteCandidates=function(i){for(var e=[],t=i.split(" ").map(Wt),n=0;n<t.length;n+=3)e.push({component:t[n],ip:t[n+1],port:t[n+2]});return e};tt.parseImageAttributes=function(i){return i.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(Bu,{})})};tt.parseSimulcastStreamList=function(i){return i.split(";").map(function(e){return e.split(",").map(function(t){var n,s=!1;return t[0]!=="~"?n=Wt(t):(n=Wt(t.substring(1,t.length)),s=!0),{scid:n,paused:s}})})}});var Mu=yt((AC,ju)=>{"use strict";var xr=Or(),uf=/%[sdv%]/g,df=function(i){var e=1,t=arguments,n=t.length;return i.replace(uf,function(s){if(e>=n)return s;var r=t[e];switch(e+=1,s){case"%%":return"%";case"%s":return String(r);case"%d":return Number(r);case"%v":return""}})},Pi=function(i,e,t){var n=e.format instanceof Function?e.format(e.push?t:t[e.name]):e.format,s=[i+"="+n];if(e.names)for(var r=0;r<e.names.length;r+=1){var o=e.names[r];e.name?s.push(t[e.name][o]):s.push(t[e.names[r]])}else s.push(t[e.name]);return df.apply(null,s)},hf=["v","o","s","i","u","e","p","c","b","t","r","z","a"],ff=["i","c","b","a"];ju.exports=function(i,e){e=e||{},i.version==null&&(i.version=0),i.name==null&&(i.name=" "),i.media.forEach(function(r){r.payloads==null&&(r.payloads="")});var t=e.outerOrder||hf,n=e.innerOrder||ff,s=[];return t.forEach(function(r){xr[r].forEach(function(o){o.name in i&&i[o.name]!=null?s.push(Pi(r,o,i)):o.push in i&&i[o.push]!=null&&i[o.push].forEach(function(a){s.push(Pi(r,o,a))})})}),i.media.forEach(function(r){s.push(Pi("m",xr.m[0],r)),n.forEach(function(o){xr[o].forEach(function(a){a.name in r&&r[a.name]!=null?s.push(Pi(o,a,r)):a.push in r&&r[a.push]!=null&&r[a.push].forEach(function(l){s.push(Pi(o,a,l))})})})}),s.join(`\r
`)+`\r
`}});var $u=yt(it=>{"use strict";var wt=Vu(),pf=Mu();it.write=pf;it.parse=wt.parse;it.parseParams=wt.parseParams;it.parseFmtpConfig=wt.parseFmtpConfig;it.parsePayloads=wt.parsePayloads;it.parseRemoteCandidates=wt.parseRemoteCandidates;it.parseImageAttributes=wt.parseImageAttributes;it.parseSimulcastStreamList=wt.parseSimulcastStreamList});var Wu=yt((Ni,Bn)=>{"use strict";(function(i,e){"use strict";var t="1.0.38",n="",s="?",r="function",o="undefined",a="object",l="string",c="major",u="model",h="name",d="type",f="vendor",p="version",g="architecture",v="console",k="mobile",_="tablet",P="smarttv",A="wearable",M="embedded",$=500,Y="Amazon",fe="Apple",ze="ASUS",ei="BlackBerry",O="Browser",Q="Chrome",ye="Edge",ne="Firefox",Se="Google",Xe="Huawei",Ye="LG",he="Microsoft",ke="Motorola",Ce="Opera",Bi="Samsung",_c="Sharp",Vi="Sony",ls="Xiaomi",us="Zebra",Pc="Facebook",Nc="Chromium OS",Oc="Mac OS",Fd=function(B,G){var U={};for(var z in B)G[z]&&G[z].length%2===0?U[z]=G[z].concat(B[z]):U[z]=B[z];return U},ji=function(B){for(var G={},U=0;U<B.length;U++)G[B[U].toUpperCase()]=B[U];return G},xc=function(B,G){return typeof B===l?ti(G).indexOf(ti(B))!==-1:!1},ti=function(B){return B.toLowerCase()},Bd=function(B){return typeof B===l?B.replace(/[^\d\.]/g,n).split(".")[0]:e},ds=function(B,G){if(typeof B===l)return B=B.replace(/^\s\s*/,n),typeof G===o?B:B.substring(0,$)},ii=function(B,G){for(var U=0,z,Qe,Ve,W,D,je;U<G.length&&!D;){var fs=G[U],Uc=G[U+1];for(z=Qe=0;z<fs.length&&!D&&fs[z];)if(D=fs[z++].exec(B),D)for(Ve=0;Ve<Uc.length;Ve++)je=D[++Qe],W=Uc[Ve],typeof W===a&&W.length>0?W.length===2?typeof W[1]==r?this[W[0]]=W[1].call(this,je):this[W[0]]=W[1]:W.length===3?typeof W[1]===r&&!(W[1].exec&&W[1].test)?this[W[0]]=je?W[1].call(this,je,W[2]):e:this[W[0]]=je?je.replace(W[1],W[2]):e:W.length===4&&(this[W[0]]=je?W[3].call(this,je.replace(W[1],W[2])):e):this[W]=je||e;U+=2}},hs=function(B,G){for(var U in G)if(typeof G[U]===a&&G[U].length>0){for(var z=0;z<G[U].length;z++)if(xc(G[U][z],B))return U===s?e:U}else if(xc(G[U],B))return U===s?e:U;return B},Vd={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Dc={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Ac={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[p,[h,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[p,[h,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[h,p],[/opios[\/ ]+([\w\.]+)/i],[p,[h,Ce+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[p,[h,Ce+" GX"]],[/\bopr\/([\w\.]+)/i],[p,[h,Ce]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[p,[h,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[h,p],[/\bddg\/([\w\.]+)/i],[p,[h,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[p,[h,"UC"+O]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[p,[h,"WeChat"]],[/konqueror\/([\w\.]+)/i],[p,[h,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[p,[h,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[p,[h,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[p,[h,"Smart Lenovo "+O]],[/(avast|avg)\/([\w\.]+)/i],[[h,/(.+)/,"$1 Secure "+O],p],[/\bfocus\/([\w\.]+)/i],[p,[h,ne+" Focus"]],[/\bopt\/([\w\.]+)/i],[p,[h,Ce+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[p,[h,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[p,[h,"Dolphin"]],[/coast\/([\w\.]+)/i],[p,[h,Ce+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[p,[h,"MIUI "+O]],[/fxios\/([-\w\.]+)/i],[p,[h,ne]],[/\bqihu|(qi?ho?o?|360)browser/i],[[h,"360 "+O]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[h,/(.+)/,"$1 "+O],p],[/samsungbrowser\/([\w\.]+)/i],[p,[h,Bi+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[h,/_/g," "],p],[/metasr[\/ ]?([\d\.]+)/i],[p,[h,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[h,"Sogou Mobile"],p],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[h,p],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[h],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[h,Pc],p],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[h,p],[/\bgsa\/([\w\.]+) .*safari\//i],[p,[h,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[p,[h,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[p,[h,Q+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[h,Q+" WebView"],p],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[p,[h,"Android "+O]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[h,p],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[p,[h,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[p,h],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[h,[p,hs,Vd]],[/(webkit|khtml)\/([\w\.]+)/i],[h,p],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[h,"Netscape"],p],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[p,[h,ne+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[h,p],[/(cobalt)\/([\w\.]+)/i],[h,[p,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,ti]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,n,ti]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,ti]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[u,[f,Bi],[d,_]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[u,[f,Bi],[d,k]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[u,[f,fe],[d,k]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[u,[f,fe],[d,_]],[/(macintosh);/i],[u,[f,fe]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[u,[f,_c],[d,k]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[u,[f,Xe],[d,_]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[u,[f,Xe],[d,k]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[u,/_/g," "],[f,ls],[d,k]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[u,/_/g," "],[f,ls],[d,_]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[u,[f,"OPPO"],[d,k]],[/\b(opd2\d{3}a?) bui/i],[u,[f,"OPPO"],[d,_]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[u,[f,"Vivo"],[d,k]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[u,[f,"Realme"],[d,k]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[u,[f,ke],[d,k]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[u,[f,ke],[d,_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[u,[f,Ye],[d,_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[u,[f,Ye],[d,k]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[u,[f,"Lenovo"],[d,_]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[u,/_/g," "],[f,"Nokia"],[d,k]],[/(pixel c)\b/i],[u,[f,Se],[d,_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[u,[f,Se],[d,k]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[u,[f,Vi],[d,k]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[u,"Xperia Tablet"],[f,Vi],[d,_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[u,[f,"OnePlus"],[d,k]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[u,[f,Y],[d,_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[u,/(.+)/g,"Fire Phone $1"],[f,Y],[d,k]],[/(playbook);[-\w\),; ]+(rim)/i],[u,f,[d,_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[u,[f,ei],[d,k]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[u,[f,ze],[d,_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[u,[f,ze],[d,k]],[/(nexus 9)/i],[u,[f,"HTC"],[d,_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[f,[u,/_/g," "],[d,k]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[u,[f,"Acer"],[d,_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[u,[f,"Meizu"],[d,k]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[u,[f,"Ulefone"],[d,k]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[f,u,[d,k]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[f,u,[d,_]],[/(surface duo)/i],[u,[f,he],[d,_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[u,[f,"Fairphone"],[d,k]],[/(u304aa)/i],[u,[f,"AT&T"],[d,k]],[/\bsie-(\w*)/i],[u,[f,"Siemens"],[d,k]],[/\b(rct\w+) b/i],[u,[f,"RCA"],[d,_]],[/\b(venue[\d ]{2,7}) b/i],[u,[f,"Dell"],[d,_]],[/\b(q(?:mv|ta)\w+) b/i],[u,[f,"Verizon"],[d,_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[u,[f,"Barnes & Noble"],[d,_]],[/\b(tm\d{3}\w+) b/i],[u,[f,"NuVision"],[d,_]],[/\b(k88) b/i],[u,[f,"ZTE"],[d,_]],[/\b(nx\d{3}j) b/i],[u,[f,"ZTE"],[d,k]],[/\b(gen\d{3}) b.+49h/i],[u,[f,"Swiss"],[d,k]],[/\b(zur\d{3}) b/i],[u,[f,"Swiss"],[d,_]],[/\b((zeki)?tb.*\b) b/i],[u,[f,"Zeki"],[d,_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[f,"Dragon Touch"],u,[d,_]],[/\b(ns-?\w{0,9}) b/i],[u,[f,"Insignia"],[d,_]],[/\b((nxa|next)-?\w{0,9}) b/i],[u,[f,"NextBook"],[d,_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],u,[d,k]],[/\b(lvtel\-)?(v1[12]) b/i],[[f,"LvTel"],u,[d,k]],[/\b(ph-1) /i],[u,[f,"Essential"],[d,k]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[u,[f,"Envizen"],[d,_]],[/\b(trio[-\w\. ]+) b/i],[u,[f,"MachSpeed"],[d,_]],[/\btu_(1491) b/i],[u,[f,"Rotor"],[d,_]],[/(shield[\w ]+) b/i],[u,[f,"Nvidia"],[d,_]],[/(sprint) (\w+)/i],[f,u,[d,k]],[/(kin\.[onetw]{3})/i],[[u,/\./g," "],[f,he],[d,k]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[u,[f,us],[d,_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[u,[f,us],[d,k]],[/smart-tv.+(samsung)/i],[f,[d,P]],[/hbbtv.+maple;(\d+)/i],[[u,/^/,"SmartTV"],[f,Bi],[d,P]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[f,Ye],[d,P]],[/(apple) ?tv/i],[f,[u,fe+" TV"],[d,P]],[/crkey/i],[[u,Q+"cast"],[f,Se],[d,P]],[/droid.+aft(\w+)( bui|\))/i],[u,[f,Y],[d,P]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[u,[f,_c],[d,P]],[/(bravia[\w ]+)( bui|\))/i],[u,[f,Vi],[d,P]],[/(mitv-\w{5}) bui/i],[u,[f,ls],[d,P]],[/Hbbtv.*(technisat) (.*);/i],[f,u,[d,P]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[f,ds],[u,ds],[d,P]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[d,P]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,u,[d,v]],[/droid.+; (shield) bui/i],[u,[f,"Nvidia"],[d,v]],[/(playstation [345portablevi]+)/i],[u,[f,Vi],[d,v]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[u,[f,he],[d,v]],[/((pebble))app/i],[f,u,[d,A]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[u,[f,fe],[d,A]],[/droid.+; (glass) \d/i],[u,[f,Se],[d,A]],[/droid.+; (wt63?0{2,3})\)/i],[u,[f,us],[d,A]],[/(quest( \d| pro)?)/i],[u,[f,Pc],[d,A]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[f,[d,M]],[/(aeobc)\b/i],[u,[f,Y],[d,M]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[u,[d,k]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[u,[d,_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[d,_]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[d,k]],[/(android[-\w\. ]{0,9});.+buil/i],[u,[f,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[p,[h,ye+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[p,[h,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[h,p],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[p,h]],os:[[/microsoft (windows) (vista|xp)/i],[h,p],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[h,[p,hs,Dc]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[p,hs,Dc],[h,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[p,/_/g,"."],[h,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[h,Oc],[p,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[p,h],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[h,p],[/\(bb(10);/i],[p,[h,ei]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[p,[h,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[p,[h,ne+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[p,[h,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[p,[h,"watchOS"]],[/crkey\/([\d\.]+)/i],[p,[h,Q+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[h,Nc],p],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[h,p],[/(sunos) ?([\w\.\d]*)/i],[[h,"Solaris"],p],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[h,p]]},Ie=function(B,G){if(typeof B===a&&(G=B,B=e),!(this instanceof Ie))return new Ie(B,G).getResult();var U=typeof i!==o&&i.navigator?i.navigator:e,z=B||(U&&U.userAgent?U.userAgent:n),Qe=U&&U.userAgentData?U.userAgentData:e,Ve=G?Fd(Ac,G):Ac,W=U&&U.userAgent==z;return this.getBrowser=function(){var D={};return D[h]=e,D[p]=e,ii.call(D,z,Ve.browser),D[c]=Bd(D[p]),W&&U&&U.brave&&typeof U.brave.isBrave==r&&(D[h]="Brave"),D},this.getCPU=function(){var D={};return D[g]=e,ii.call(D,z,Ve.cpu),D},this.getDevice=function(){var D={};return D[f]=e,D[u]=e,D[d]=e,ii.call(D,z,Ve.device),W&&!D[d]&&Qe&&Qe.mobile&&(D[d]=k),W&&D[u]=="Macintosh"&&U&&typeof U.standalone!==o&&U.maxTouchPoints&&U.maxTouchPoints>2&&(D[u]="iPad",D[d]=_),D},this.getEngine=function(){var D={};return D[h]=e,D[p]=e,ii.call(D,z,Ve.engine),D},this.getOS=function(){var D={};return D[h]=e,D[p]=e,ii.call(D,z,Ve.os),W&&!D[h]&&Qe&&Qe.platform&&Qe.platform!="Unknown"&&(D[h]=Qe.platform.replace(/chrome os/i,Nc).replace(/macos/i,Oc)),D},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return z},this.setUA=function(D){return z=typeof D===l&&D.length>$?ds(D,$):D,this},this.setUA(z),this};Ie.VERSION=t,Ie.BROWSER=ji([h,p,c]),Ie.CPU=ji([g]),Ie.DEVICE=ji([u,f,d,v,k,P,_,A,M]),Ie.ENGINE=Ie.OS=ji([h,p]),typeof Ni!==o?(typeof Bn!==o&&Bn.exports&&(Ni=Bn.exports=Ie),Ni.UAParser=Ie):typeof define===r&&define.amd?define(function(){return Ie}):typeof i!==o&&(i.UAParser=Ie);var Pt=typeof i!==o&&(i.jQuery||i.Zepto);if(Pt&&!Pt.ua){var Mi=new Ie;Pt.ua=Mi.getResult(),Pt.ua.get=function(){return Mi.getUA()},Pt.ua.set=function(B){Mi.setUA(B);var G=Mi.getResult();for(var U in G)Pt.ua[U]=G[U]}}})(typeof window=="object"?window:Ni)});var Gu=yt(Vn=>{"use strict";Vn.byteLength=gf;Vn.toByteArray=yf;Vn.fromByteArray=Cf;var qe=[],Ne=[],mf=typeof Uint8Array<"u"?Uint8Array:Array,Ar="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(vt=0,Hu=Ar.length;vt<Hu;++vt)qe[vt]=Ar[vt],Ne[Ar.charCodeAt(vt)]=vt;var vt,Hu;Ne[45]=62;Ne[95]=63;function qu(i){var e=i.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=i.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function gf(i){var e=qu(i),t=e[0],n=e[1];return(t+n)*3/4-n}function bf(i,e,t){return(e+t)*3/4-t}function yf(i){var e,t=qu(i),n=t[0],s=t[1],r=new mf(bf(i,n,s)),o=0,a=s>0?n-4:n,l;for(l=0;l<a;l+=4)e=Ne[i.charCodeAt(l)]<<18|Ne[i.charCodeAt(l+1)]<<12|Ne[i.charCodeAt(l+2)]<<6|Ne[i.charCodeAt(l+3)],r[o++]=e>>16&255,r[o++]=e>>8&255,r[o++]=e&255;return s===2&&(e=Ne[i.charCodeAt(l)]<<2|Ne[i.charCodeAt(l+1)]>>4,r[o++]=e&255),s===1&&(e=Ne[i.charCodeAt(l)]<<10|Ne[i.charCodeAt(l+1)]<<4|Ne[i.charCodeAt(l+2)]>>2,r[o++]=e>>8&255,r[o++]=e&255),r}function Sf(i){return qe[i>>18&63]+qe[i>>12&63]+qe[i>>6&63]+qe[i&63]}function kf(i,e,t){for(var n,s=[],r=e;r<t;r+=3)n=(i[r]<<16&16711680)+(i[r+1]<<8&65280)+(i[r+2]&255),s.push(Sf(n));return s.join("")}function Cf(i){for(var e,t=i.length,n=t%3,s=[],r=16383,o=0,a=t-n;o<a;o+=r)s.push(kf(i,o,o+r>a?a:o+r));return n===1?(e=i[t-1],s.push(qe[e>>2]+qe[e<<4&63]+"==")):n===2&&(e=(i[t-2]<<8)+i[t-1],s.push(qe[e>>10]+qe[e>>4&63]+qe[e<<2&63]+"=")),s.join("")}});var ml=!0,gl=!0;function li(i,e,t){let n=i.match(e);return n&&n.length>=t&&parseInt(n[t],10)}function $e(i,e,t){if(!i.RTCPeerConnection)return;let n=i.RTCPeerConnection.prototype,s=n.addEventListener;n.addEventListener=function(o,a){if(o!==e)return s.apply(this,arguments);let l=c=>{let u=t(c);u&&(a.handleEvent?a.handleEvent(u):a(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,l),s.apply(this,[o,l])};let r=n.removeEventListener;n.removeEventListener=function(o,a){if(o!==e||!this._eventMap||!this._eventMap[e])return r.apply(this,arguments);if(!this._eventMap[e].has(a))return r.apply(this,arguments);let l=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,r.apply(this,[o,l])},Object.defineProperty(n,"on"+e,{get(){return this["_on"+e]},set(o){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),o&&this.addEventListener(e,this["_on"+e]=o)},enumerable:!0,configurable:!0})}function bl(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(ml=i,i?"adapter.js logging disabled":"adapter.js logging enabled")}function yl(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(gl=!i,"adapter.js deprecation warnings "+(i?"disabled":"enabled"))}function Ki(){if(typeof window=="object"){if(ml)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Ut(i,e){gl&&console.warn(i+" is deprecated, please use "+e+" instead.")}function Sl(i){let e={browser:null,version:null};if(typeof i>"u"||!i.navigator||!i.navigator.userAgent)return e.browser="Not a browser.",e;let{navigator:t}=i;if(t.mozGetUserMedia)e.browser="firefox",e.version=li(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||i.isSecureContext===!1&&i.webkitRTCPeerConnection)e.browser="chrome",e.version=li(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(i.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=li(t.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=i.RTCRtpTransceiver&&"currentDirection"in i.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function pl(i){return Object.prototype.toString.call(i)==="[object Object]"}function ws(i){return pl(i)?Object.keys(i).reduce(function(e,t){let n=pl(i[t]),s=n?ws(i[t]):i[t],r=n&&!Object.keys(s).length;return s===void 0||r?e:Object.assign(e,{[t]:s})},{}):i}function Cs(i,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(n=>{n.endsWith("Id")?Cs(i,i.get(e[n]),t):n.endsWith("Ids")&&e[n].forEach(s=>{Cs(i,i.get(s),t)})}))}function vs(i,e,t){let n=t?"outbound-rtp":"inbound-rtp",s=new Map;if(e===null)return s;let r=[];return i.forEach(o=>{o.type==="track"&&o.trackIdentifier===e.id&&r.push(o)}),r.forEach(o=>{i.forEach(a=>{a.type===n&&a.trackId===o.id&&Cs(i,a,s)})}),s}var Yi={};ni(Yi,{fixNegotiationNeeded:()=>Ns,shimAddTrackRemoveTrack:()=>Ps,shimAddTrackRemoveTrackWithNative:()=>wl,shimGetDisplayMedia:()=>Cl,shimGetSendersWithDtmf:()=>Es,shimGetStats:()=>Is,shimGetUserMedia:()=>zi,shimMediaStream:()=>Ts,shimOnTrack:()=>Rs,shimPeerConnection:()=>Xi,shimSenderReceiverGetStats:()=>_s});var kl=Ki;function zi(i,e){let t=i&&i.navigator;if(!t.mediaDevices)return;let n=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;let l={};return Object.keys(a).forEach(c=>{if(c==="require"||c==="advanced"||c==="mediaSource")return;let u=typeof a[c]=="object"?a[c]:{ideal:a[c]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);let h=function(d,f){return d?d+f.charAt(0).toUpperCase()+f.slice(1):f==="deviceId"?"sourceId":f};if(u.ideal!==void 0){l.optional=l.optional||[];let d={};typeof u.ideal=="number"?(d[h("min",c)]=u.ideal,l.optional.push(d),d={},d[h("max",c)]=u.ideal,l.optional.push(d)):(d[h("",c)]=u.ideal,l.optional.push(d))}u.exact!==void 0&&typeof u.exact!="number"?(l.mandatory=l.mandatory||{},l.mandatory[h("",c)]=u.exact):["min","max"].forEach(d=>{u[d]!==void 0&&(l.mandatory=l.mandatory||{},l.mandatory[h(d,c)]=u[d])})}),a.advanced&&(l.optional=(l.optional||[]).concat(a.advanced)),l},s=function(a,l){if(e.version>=61)return l(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){let c=function(u,h,d){h in u&&!(d in u)&&(u[d]=u[h],delete u[h])};a=JSON.parse(JSON.stringify(a)),c(a.audio,"autoGainControl","googAutoGainControl"),c(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=n(a.audio)}if(a&&typeof a.video=="object"){let c=a.video.facingMode;c=c&&(typeof c=="object"?c:{ideal:c});let u=e.version<66;if(c&&(c.exact==="user"||c.exact==="environment"||c.ideal==="user"||c.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete a.video.facingMode;let h;if(c.exact==="environment"||c.ideal==="environment"?h=["back","rear"]:(c.exact==="user"||c.ideal==="user")&&(h=["front"]),h)return t.mediaDevices.enumerateDevices().then(d=>{d=d.filter(p=>p.kind==="videoinput");let f=d.find(p=>h.some(g=>p.label.toLowerCase().includes(g)));return!f&&d.length&&h.includes("back")&&(f=d[d.length-1]),f&&(a.video.deviceId=c.exact?{exact:f.deviceId}:{ideal:f.deviceId}),a.video=n(a.video),kl("chrome: "+JSON.stringify(a)),l(a)})}a.video=n(a.video)}return kl("chrome: "+JSON.stringify(a)),l(a)},r=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(a,l,c){s(a,u=>{t.webkitGetUserMedia(u,l,h=>{c&&c(r(h))})})};if(t.getUserMedia=o.bind(t),t.mediaDevices.getUserMedia){let a=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(l){return s(l,c=>a(c).then(u=>{if(c.audio&&!u.getAudioTracks().length||c.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(h=>{h.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(r(u))))}}}function Cl(i,e){if(!(i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices)&&i.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}i.navigator.mediaDevices.getDisplayMedia=function(n){return e(n).then(s=>{let r=n.video&&n.video.width,o=n.video&&n.video.height,a=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s,maxFrameRate:a||3}},r&&(n.video.mandatory.maxWidth=r),o&&(n.video.mandatory.maxHeight=o),i.navigator.mediaDevices.getUserMedia(n)})}}}function Ts(i){i.MediaStream=i.MediaStream||i.webkitMediaStream}function Rs(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("ontrack"in i.RTCPeerConnection.prototype)){Object.defineProperty(i.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});let e=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",s=>{let r;i.RTCPeerConnection.prototype.getReceivers?r=this.getReceivers().find(a=>a.track&&a.track.id===s.track.id):r={track:s.track};let o=new Event("track");o.track=s.track,o.receiver=r,o.transceiver={receiver:r},o.streams=[n.stream],this.dispatchEvent(o)}),n.stream.getTracks().forEach(s=>{let r;i.RTCPeerConnection.prototype.getReceivers?r=this.getReceivers().find(a=>a.track&&a.track.id===s.id):r={track:s};let o=new Event("track");o.track=s,o.receiver=r,o.transceiver={receiver:r},o.streams=[n.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else $e(i,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Es(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("getSenders"in i.RTCPeerConnection.prototype)&&"createDTMFSender"in i.RTCPeerConnection.prototype){let e=function(s,r){return{track:r,get dtmf(){return this._dtmf===void 0&&(r.kind==="audio"?this._dtmf=s.createDTMFSender(r):this._dtmf=null),this._dtmf},_pc:s}};if(!i.RTCPeerConnection.prototype.getSenders){i.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};let s=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(a,l){let c=s.apply(this,arguments);return c||(c=e(this,a),this._senders.push(c)),c};let r=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(a){r.apply(this,arguments);let l=this._senders.indexOf(a);l!==-1&&this._senders.splice(l,1)}}let t=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(r){this._senders=this._senders||[],t.apply(this,[r]),r.getTracks().forEach(o=>{this._senders.push(e(this,o))})};let n=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(r){this._senders=this._senders||[],n.apply(this,[r]),r.getTracks().forEach(o=>{let a=this._senders.find(l=>l.track===o);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof i=="object"&&i.RTCPeerConnection&&"getSenders"in i.RTCPeerConnection.prototype&&"createDTMFSender"in i.RTCPeerConnection.prototype&&i.RTCRtpSender&&!("dtmf"in i.RTCRtpSender.prototype)){let e=i.RTCPeerConnection.prototype.getSenders;i.RTCPeerConnection.prototype.getSenders=function(){let n=e.apply(this,[]);return n.forEach(s=>s._pc=this),n},Object.defineProperty(i.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Is(i){if(!i.RTCPeerConnection)return;let e=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){let[n,s,r]=arguments;if(arguments.length>0&&typeof n=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof n!="function"))return e.apply(this,[]);let o=function(l){let c={};return l.result().forEach(h=>{let d={id:h.id,timestamp:h.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[h.type]||h.type};h.names().forEach(f=>{d[f]=h.stat(f)}),c[d.id]=d}),c},a=function(l){return new Map(Object.keys(l).map(c=>[c,l[c]]))};if(arguments.length>=2){let l=function(c){s(a(o(c)))};return e.apply(this,[l,n])}return new Promise((l,c)=>{e.apply(this,[function(u){l(a(o(u)))},c])}).then(s,r)}}function _s(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender&&i.RTCRtpReceiver))return;if(!("getStats"in i.RTCRtpSender.prototype)){let t=i.RTCPeerConnection.prototype.getSenders;t&&(i.RTCPeerConnection.prototype.getSenders=function(){let r=t.apply(this,[]);return r.forEach(o=>o._pc=this),r});let n=i.RTCPeerConnection.prototype.addTrack;n&&(i.RTCPeerConnection.prototype.addTrack=function(){let r=n.apply(this,arguments);return r._pc=this,r}),i.RTCRtpSender.prototype.getStats=function(){let r=this;return this._pc.getStats().then(o=>vs(o,r.track,!0))}}if(!("getStats"in i.RTCRtpReceiver.prototype)){let t=i.RTCPeerConnection.prototype.getReceivers;t&&(i.RTCPeerConnection.prototype.getReceivers=function(){let s=t.apply(this,[]);return s.forEach(r=>r._pc=this),s}),$e(i,"track",n=>(n.receiver._pc=n.srcElement,n)),i.RTCRtpReceiver.prototype.getStats=function(){let s=this;return this._pc.getStats().then(r=>vs(r,s.track,!1))}}if(!("getStats"in i.RTCRtpSender.prototype&&"getStats"in i.RTCRtpReceiver.prototype))return;let e=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof i.MediaStreamTrack){let n=arguments[0],s,r,o;return this.getSenders().forEach(a=>{a.track===n&&(s?o=!0:s=a)}),this.getReceivers().forEach(a=>(a.track===n&&(r?o=!0:r=a),a.track===n)),o||s&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):s?s.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function wl(i){i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};let e=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(o,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};let l=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(l)===-1&&this._shimmedLocalStreams[a.id].push(l):this._shimmedLocalStreams[a.id]=[a,l],l};let t=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(c=>{if(this.getSenders().find(h=>h.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});let a=this.getSenders();t.apply(this,arguments);let l=this.getSenders().filter(c=>a.indexOf(c)===-1);this._shimmedLocalStreams[o.id]=[o].concat(l)};let n=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],n.apply(this,arguments)};let s=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(a=>{let l=this._shimmedLocalStreams[a].indexOf(o);l!==-1&&this._shimmedLocalStreams[a].splice(l,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),s.apply(this,arguments)}}function Ps(i,e){if(!i.RTCPeerConnection)return;if(i.RTCPeerConnection.prototype.addTrack&&e.version>=65)return wl(i);let t=i.RTCPeerConnection.prototype.getLocalStreams;i.RTCPeerConnection.prototype.getLocalStreams=function(){let u=t.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(h=>this._reverseStreams[h.id])};let n=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(h=>{if(this.getSenders().find(f=>f.track===h))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){let h=new i.MediaStream(u.getTracks());this._streams[u.id]=h,this._reverseStreams[h.id]=u,u=h}n.apply(this,[u])};let s=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},i.RTCPeerConnection.prototype.addTrack=function(u,h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");let d=[].slice.call(arguments,1);if(d.length!==1||!d[0].getTracks().find(g=>g===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(g=>g.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};let p=this._streams[h.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{let g=new i.MediaStream([u]);this._streams[h.id]=g,this._reverseStreams[g.id]=h,this.addStream(g)}return this.getSenders().find(g=>g.track===u)};function r(c,u){let h=u.sdp;return Object.keys(c._reverseStreams||[]).forEach(d=>{let f=c._reverseStreams[d],p=c._streams[f.id];h=h.replace(new RegExp(p.id,"g"),f.id)}),new RTCSessionDescription({type:u.type,sdp:h})}function o(c,u){let h=u.sdp;return Object.keys(c._reverseStreams||[]).forEach(d=>{let f=c._reverseStreams[d],p=c._streams[f.id];h=h.replace(new RegExp(f.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:h})}["createOffer","createAnswer"].forEach(function(c){let u=i.RTCPeerConnection.prototype[c],h={[c](){let d=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{let g=r(this,p);d[0].apply(null,[g])},p=>{d[1]&&d[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>r(this,p))}};i.RTCPeerConnection.prototype[c]=h[c]});let a=i.RTCPeerConnection.prototype.setLocalDescription;i.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=o(this,arguments[0]),a.apply(this,arguments))};let l=Object.getOwnPropertyDescriptor(i.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(i.RTCPeerConnection.prototype,"localDescription",{get(){let c=l.get.apply(this);return c.type===""?c:r(this,c)}}),i.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let d;Object.keys(this._streams).forEach(f=>{this._streams[f].getTracks().find(g=>u.track===g)&&(d=this._streams[f])}),d&&(d.getTracks().length===1?this.removeStream(this._reverseStreams[d.id]):d.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Xi(i,e){!i.RTCPeerConnection&&i.webkitRTCPeerConnection&&(i.RTCPeerConnection=i.webkitRTCPeerConnection),i.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){let n=i.RTCPeerConnection.prototype[t],s={[t](){return arguments[0]=new(t==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};i.RTCPeerConnection.prototype[t]=s[t]})}function Ns(i,e){$e(i,"negotiationneeded",t=>{let n=t.target;if(!((e.version<72||n.getConfiguration&&n.getConfiguration().sdpSemantics==="plan-b")&&n.signalingState!=="stable"))return t})}var en={};ni(en,{shimAddTransceiver:()=>Ls,shimCreateAnswer:()=>Vs,shimCreateOffer:()=>Bs,shimGetDisplayMedia:()=>vl,shimGetParameters:()=>Fs,shimGetUserMedia:()=>Qi,shimOnTrack:()=>Os,shimPeerConnection:()=>Zi,shimRTCDataChannel:()=>Us,shimReceiverGetStats:()=>Ds,shimRemoveStream:()=>As,shimSenderGetStats:()=>xs});function Qi(i,e){let t=i&&i.navigator,n=i&&i.MediaStreamTrack;if(t.getUserMedia=function(s,r,o){Ut("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(s).then(r,o)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){let s=function(o,a,l){a in o&&!(l in o)&&(o[l]=o[a],delete o[a])},r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),s(o.audio,"autoGainControl","mozAutoGainControl"),s(o.audio,"noiseSuppression","mozNoiseSuppression")),r(o)},n&&n.prototype.getSettings){let o=n.prototype.getSettings;n.prototype.getSettings=function(){let a=o.apply(this,arguments);return s(a,"mozAutoGainControl","autoGainControl"),s(a,"mozNoiseSuppression","noiseSuppression"),a}}if(n&&n.prototype.applyConstraints){let o=n.prototype.applyConstraints;n.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),s(a,"autoGainControl","mozAutoGainControl"),s(a,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[a])}}}}function vl(i,e){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&(i.navigator.mediaDevices.getDisplayMedia=function(n){if(!(n&&n.video)){let s=new DOMException("getDisplayMedia without video constraints is undefined");return s.name="NotFoundError",s.code=8,Promise.reject(s)}return n.video===!0?n.video={mediaSource:e}:n.video.mediaSource=e,i.navigator.mediaDevices.getUserMedia(n)})}function Os(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Zi(i,e){if(typeof i!="object"||!(i.RTCPeerConnection||i.mozRTCPeerConnection))return;!i.RTCPeerConnection&&i.mozRTCPeerConnection&&(i.RTCPeerConnection=i.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(s){let r=i.RTCPeerConnection.prototype[s],o={[s](){return arguments[0]=new(s==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};i.RTCPeerConnection.prototype[s]=o[s]});let t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){let[r,o,a]=arguments;return n.apply(this,[r||null]).then(l=>{if(e.version<53&&!o)try{l.forEach(c=>{c.type=t[c.type]||c.type})}catch(c){if(c.name!=="TypeError")throw c;l.forEach((u,h)=>{l.set(h,Object.assign({},u,{type:t[u.type]||u.type}))})}return l}).then(o,a)}}function xs(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender)||i.RTCRtpSender&&"getStats"in i.RTCRtpSender.prototype)return;let e=i.RTCPeerConnection.prototype.getSenders;e&&(i.RTCPeerConnection.prototype.getSenders=function(){let s=e.apply(this,[]);return s.forEach(r=>r._pc=this),s});let t=i.RTCPeerConnection.prototype.addTrack;t&&(i.RTCPeerConnection.prototype.addTrack=function(){let s=t.apply(this,arguments);return s._pc=this,s}),i.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Ds(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender)||i.RTCRtpSender&&"getStats"in i.RTCRtpReceiver.prototype)return;let e=i.RTCPeerConnection.prototype.getReceivers;e&&(i.RTCPeerConnection.prototype.getReceivers=function(){let n=e.apply(this,[]);return n.forEach(s=>s._pc=this),n}),$e(i,"track",t=>(t.receiver._pc=t.srcElement,t)),i.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function As(i){!i.RTCPeerConnection||"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(t){Ut("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&t.getTracks().includes(n.track)&&this.removeTrack(n)})})}function Us(i){i.DataChannel&&!i.RTCDataChannel&&(i.RTCDataChannel=i.DataChannel)}function Ls(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;let e=i.RTCPeerConnection.prototype.addTransceiver;e&&(i.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let n=arguments[1]&&arguments[1].sendEncodings;n===void 0&&(n=[]),n=[...n];let s=n.length>0;s&&n.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});let r=e.apply(this,arguments);if(s){let{sender:o}=r,a=o.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=n,o.sendEncodings=n,this.setParametersPromises.push(o.setParameters(a).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return r})}function Fs(i){if(!(typeof i=="object"&&i.RTCRtpSender))return;let e=i.RTCRtpSender.prototype.getParameters;e&&(i.RTCRtpSender.prototype.getParameters=function(){let n=e.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function Bs(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;let e=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function Vs(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;let e=i.RTCPeerConnection.prototype.createAnswer;i.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var tn={};ni(tn,{shimAudioContext:()=>Js,shimCallbacksAPI:()=>$s,shimConstraints:()=>Tl,shimCreateOfferLegacy:()=>Gs,shimGetUserMedia:()=>Ws,shimLocalStreamsAPI:()=>js,shimRTCIceServerUrls:()=>Hs,shimRemoteStreamsAPI:()=>Ms,shimTrackEventTransceiver:()=>qs});function js(i){if(!(typeof i!="object"||!i.RTCPeerConnection)){if("getLocalStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in i.RTCPeerConnection.prototype)){let e=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(s=>e.call(this,s,n)),n.getVideoTracks().forEach(s=>e.call(this,s,n))},i.RTCPeerConnection.prototype.addTrack=function(n,...s){return s&&s.forEach(r=>{this._localStreams?this._localStreams.includes(r)||this._localStreams.push(r):this._localStreams=[r]}),e.apply(this,arguments)}}"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);let n=this._localStreams.indexOf(t);if(n===-1)return;this._localStreams.splice(n,1);let s=t.getTracks();this.getSenders().forEach(r=>{s.includes(r.track)&&this.removeTrack(r)})})}}function Ms(i){if(!(typeof i!="object"||!i.RTCPeerConnection)&&("getRemoteStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in i.RTCPeerConnection.prototype))){Object.defineProperty(i.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=n=>{n.streams.forEach(s=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(s))return;this._remoteStreams.push(s);let r=new Event("addstream");r.stream=s,this.dispatchEvent(r)})})}});let e=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){let n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(r=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(r)>=0)return;n._remoteStreams.push(r);let o=new Event("addstream");o.stream=r,n.dispatchEvent(o)})}),e.apply(n,arguments)}}}function $s(i){if(typeof i!="object"||!i.RTCPeerConnection)return;let e=i.RTCPeerConnection.prototype,t=e.createOffer,n=e.createAnswer,s=e.setLocalDescription,r=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(c,u){let h=arguments.length>=2?arguments[2]:arguments[0],d=t.apply(this,[h]);return u?(d.then(c,u),Promise.resolve()):d},e.createAnswer=function(c,u){let h=arguments.length>=2?arguments[2]:arguments[0],d=n.apply(this,[h]);return u?(d.then(c,u),Promise.resolve()):d};let a=function(l,c,u){let h=s.apply(this,[l]);return u?(h.then(c,u),Promise.resolve()):h};e.setLocalDescription=a,a=function(l,c,u){let h=r.apply(this,[l]);return u?(h.then(c,u),Promise.resolve()):h},e.setRemoteDescription=a,a=function(l,c,u){let h=o.apply(this,[l]);return u?(h.then(c,u),Promise.resolve()):h},e.addIceCandidate=a}function Ws(i){let e=i&&i.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){let t=e.mediaDevices,n=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=s=>n(Tl(s))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(n,s,r){e.mediaDevices.getUserMedia(n).then(s,r)}).bind(e))}function Tl(i){return i&&i.video!==void 0?Object.assign({},i,{video:ws(i.video)}):i}function Hs(i){if(!i.RTCPeerConnection)return;let e=i.RTCPeerConnection;i.RTCPeerConnection=function(n,s){if(n&&n.iceServers){let r=[];for(let o=0;o<n.iceServers.length;o++){let a=n.iceServers[o];a.urls===void 0&&a.url?(Ut("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,r.push(a)):r.push(n.iceServers[o])}n.iceServers=r}return new e(n,s)},i.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(i.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function qs(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Gs(i){let e=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(n){if(n){typeof n.offerToReceiveAudio<"u"&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);let s=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");n.offerToReceiveAudio===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):n.offerToReceiveAudio===!0&&!s&&this.addTransceiver("audio",{direction:"recvonly"}),typeof n.offerToReceiveVideo<"u"&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);let r=this.getTransceivers().find(o=>o.receiver.track.kind==="video");n.offerToReceiveVideo===!1&&r?r.direction==="sendrecv"?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":r.direction==="recvonly"&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):n.offerToReceiveVideo===!0&&!r&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function Js(i){typeof i!="object"||i.AudioContext||(i.AudioContext=i.webkitAudioContext)}var Xs={};ni(Xs,{removeExtmapAllowMixed:()=>rn,shimAddIceCandidateNullOrEmpty:()=>fi,shimConnectionState:()=>sn,shimMaxMessageSize:()=>di,shimParameterlessSetLocalDescription:()=>pi,shimRTCIceCandidate:()=>ui,shimRTCIceCandidateRelayProtocol:()=>nn,shimSendThrowTypeError:()=>hi});var Lt=si(zs());function ui(i){if(!i.RTCIceCandidate||i.RTCIceCandidate&&"foundation"in i.RTCIceCandidate.prototype)return;let e=i.RTCIceCandidate;i.RTCIceCandidate=function(n){if(typeof n=="object"&&n.candidate&&n.candidate.indexOf("a=")===0&&(n=JSON.parse(JSON.stringify(n)),n.candidate=n.candidate.substring(2)),n.candidate&&n.candidate.length){let s=new e(n),r=Lt.default.parseCandidate(n.candidate);for(let o in r)o in s||Object.defineProperty(s,o,{value:r[o]});return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new e(n)},i.RTCIceCandidate.prototype=e.prototype,$e(i,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new i.RTCIceCandidate(t.candidate),writable:"false"}),t))}function nn(i){!i.RTCIceCandidate||i.RTCIceCandidate&&"relayProtocol"in i.RTCIceCandidate.prototype||$e(i,"icecandidate",e=>{if(e.candidate){let t=Lt.default.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function di(i,e){if(!i.RTCPeerConnection)return;"sctp"in i.RTCPeerConnection.prototype||Object.defineProperty(i.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});let t=function(a){if(!a||!a.sdp)return!1;let l=Lt.default.splitSections(a.sdp);return l.shift(),l.some(c=>{let u=Lt.default.parseMLine(c);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},n=function(a){let l=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(l===null||l.length<2)return-1;let c=parseInt(l[1],10);return c!==c?-1:c},s=function(a){let l=65536;return e.browser==="firefox"&&(e.version<57?a===-1?l=16384:l=2147483637:e.version<60?l=e.version===57?65535:65536:l=2147483637),l},r=function(a,l){let c=65536;e.browser==="firefox"&&e.version===57&&(c=65535);let u=Lt.default.matchPrefix(a.sdp,"a=max-message-size:");return u.length>0?c=parseInt(u[0].substring(19),10):e.browser==="firefox"&&l!==-1&&(c=2147483637),c},o=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){let{sdpSemantics:l}=this.getConfiguration();l==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){let l=n(arguments[0]),c=s(l),u=r(arguments[0],l),h;c===0&&u===0?h=Number.POSITIVE_INFINITY:c===0||u===0?h=Math.max(c,u):h=Math.min(c,u);let d={};Object.defineProperty(d,"maxMessageSize",{get(){return h}}),this._sctp=d}return o.apply(this,arguments)}}function hi(i){if(!(i.RTCPeerConnection&&"createDataChannel"in i.RTCPeerConnection.prototype))return;function e(n,s){let r=n.send;n.send=function(){let a=arguments[0],l=a.length||a.size||a.byteLength;if(n.readyState==="open"&&s.sctp&&l>s.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+s.sctp.maxMessageSize+" bytes)");return r.apply(n,arguments)}}let t=i.RTCPeerConnection.prototype.createDataChannel;i.RTCPeerConnection.prototype.createDataChannel=function(){let s=t.apply(this,arguments);return e(s,this),s},$e(i,"datachannel",n=>(e(n.channel,n.target),n))}function sn(i){if(!i.RTCPeerConnection||"connectionState"in i.RTCPeerConnection.prototype)return;let e=i.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{let n=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=s=>{let r=s.target;if(r._lastConnectionState!==r.connectionState){r._lastConnectionState=r.connectionState;let o=new Event("connectionstatechange",s);r.dispatchEvent(o)}return s},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function rn(i,e){if(!i.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;let t=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(s){if(s&&s.sdp&&s.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){let r=s.sdp.split(`
`).filter(o=>o.trim()!=="a=extmap-allow-mixed").join(`
`);i.RTCSessionDescription&&s instanceof i.RTCSessionDescription?arguments[0]=new i.RTCSessionDescription({type:s.type,sdp:r}):s.sdp=r}return t.apply(this,arguments)}}function fi(i,e){if(!(i.RTCPeerConnection&&i.RTCPeerConnection.prototype))return;let t=i.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(i.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function pi(i,e){if(!(i.RTCPeerConnection&&i.RTCPeerConnection.prototype))return;let t=i.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(i.RTCPeerConnection.prototype.setLocalDescription=function(){let s=arguments[0]||{};if(typeof s!="object"||s.type&&s.sdp)return t.apply(this,arguments);if(s={type:s.type,sdp:s.sdp},!s.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":s.type="offer";break;default:s.type="answer";break}return s.sdp||s.type!=="offer"&&s.type!=="answer"?t.apply(this,[s]):(s.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>t.apply(this,[o]))})}var jd=si(zs());function Rl({window:i}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){let t=Ki,n=Sl(i),s={browserDetails:n,commonShim:Xs,extractVersion:li,disableLog:bl,disableWarnings:yl,sdp:jd};switch(n.browser){case"chrome":if(!Yi||!Xi||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),s;if(n.version===null)return t("Chrome shim can not determine version, not shimming."),s;t("adapter.js shimming chrome."),s.browserShim=Yi,fi(i,n),pi(i,n),zi(i,n),Ts(i,n),Xi(i,n),Rs(i,n),Ps(i,n),Es(i,n),Is(i,n),_s(i,n),Ns(i,n),ui(i,n),nn(i,n),sn(i,n),di(i,n),hi(i,n),rn(i,n);break;case"firefox":if(!en||!Zi||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),s;t("adapter.js shimming firefox."),s.browserShim=en,fi(i,n),pi(i,n),Qi(i,n),Zi(i,n),Os(i,n),As(i,n),xs(i,n),Ds(i,n),Us(i,n),Ls(i,n),Fs(i,n),Bs(i,n),Vs(i,n),ui(i,n),sn(i,n),di(i,n),hi(i,n);break;case"safari":if(!tn||!e.shimSafari)return t("Safari shim is not included in this adapter release."),s;t("adapter.js shimming safari."),s.browserShim=tn,fi(i,n),pi(i,n),Hs(i,n),Gs(i,n),$s(i,n),js(i,n),Ms(i,n),qs(i,n),Ws(i,n),Js(i,n),ui(i,n),nn(i,n),di(i,n),hi(i,n),rn(i,n);break;default:t("Unsupported browser!");break}return s}var tg=Rl({window:typeof window>"u"?void 0:window});function We(i){let e=typeof i;if(e=="object"){if(Array.isArray(i))return"array";if(i===null)return"null"}return e}function dt(i){return i!==null&&typeof i=="object"&&!Array.isArray(i)}var Ze="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),an=[];for(let i=0;i<Ze.length;i++)an[Ze[i].charCodeAt(0)]=i;an[45]=Ze.indexOf("+");an[95]=Ze.indexOf("/");function El(i){let e=i.length*3/4;i[i.length-2]=="="?e-=2:i[i.length-1]=="="&&(e-=1);let t=new Uint8Array(e),n=0,s=0,r,o=0;for(let a=0;a<i.length;a++){if(r=an[i.charCodeAt(a)],r===void 0)switch(i[a]){case"=":s=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(s){case 0:o=r,s=1;break;case 1:t[n++]=o<<2|(r&48)>>4,o=r,s=2;break;case 2:t[n++]=(o&15)<<4|(r&60)>>2,o=r,s=3;break;case 3:t[n++]=(o&3)<<6|r,s=0;break}}if(s==1)throw Error("invalid base64 string.");return t.subarray(0,n)}function Il(i){let e="",t=0,n,s=0;for(let r=0;r<i.length;r++)switch(n=i[r],t){case 0:e+=Ze[n>>2],s=(n&3)<<4,t=1;break;case 1:e+=Ze[s|n>>4],s=(n&15)<<2,t=2;break;case 2:e+=Ze[s|n>>6],e+=Ze[n&63],t=0;break}return t&&(e+=Ze[s],e+="=",t==1&&(e+="=")),e}var y;(function(i){i.symbol=Symbol.for("protobuf-ts/unknown"),i.onRead=(t,n,s,r,o)=>{(e(n)?n[i.symbol]:n[i.symbol]=[]).push({no:s,wireType:r,data:o})},i.onWrite=(t,n,s)=>{for(let{no:r,wireType:o,data:a}of i.list(n))s.tag(r,o).raw(a)},i.list=(t,n)=>{if(e(t)){let s=t[i.symbol];return n?s.filter(r=>r.no==n):s}return[]},i.last=(t,n)=>i.list(t,n).slice(-1)[0];let e=t=>t&&Array.isArray(t[i.symbol])})(y||(y={}));function Ys(i,e){return Object.assign(Object.assign({},i),e)}var m=function(i){return i[i.Varint=0]="Varint",i[i.Bit64=1]="Bit64",i[i.LengthDelimited=2]="LengthDelimited",i[i.StartGroup=3]="StartGroup",i[i.EndGroup=4]="EndGroup",i[i.Bit32=5]="Bit32",i}(m||{});function _l(){let i=0,e=0;for(let n=0;n<28;n+=7){let s=this.buf[this.pos++];if(i|=(s&127)<<n,!(s&128))return this.assertBounds(),[i,e]}let t=this.buf[this.pos++];if(i|=(t&15)<<28,e=(t&112)>>4,!(t&128))return this.assertBounds(),[i,e];for(let n=3;n<=31;n+=7){let s=this.buf[this.pos++];if(e|=(s&127)<<n,!(s&128))return this.assertBounds(),[i,e]}throw new Error("invalid varint")}function cn(i,e,t){for(let r=0;r<28;r=r+7){let o=i>>>r,a=!(!(o>>>7)&&e==0),l=(a?o|128:o)&255;if(t.push(l),!a)return}let n=i>>>28&15|(e&7)<<4,s=!!(e>>3);if(t.push((s?n|128:n)&255),!!s){for(let r=3;r<31;r=r+7){let o=e>>>r,a=!!(o>>>7),l=(a?o|128:o)&255;if(t.push(l),!a)return}t.push(e>>>31&1)}}var on=65536*65536;function Qs(i){let e=i[0]=="-";e&&(i=i.slice(1));let t=1e6,n=0,s=0;function r(o,a){let l=Number(i.slice(o,a));s*=t,n=n*t+l,n>=on&&(s=s+(n/on|0),n=n%on)}return r(-24,-18),r(-18,-12),r(-12,-6),r(-6),[e,n,s]}function ln(i,e){if(e>>>0<=2097151)return""+(on*e+(i>>>0));let t=i&16777215,n=(i>>>24|e<<8)>>>0&16777215,s=e>>16&65535,r=t+n*6777216+s*6710656,o=n+s*8147497,a=s*2,l=1e7;r>=l&&(o+=Math.floor(r/l),r%=l),o>=l&&(a+=Math.floor(o/l),o%=l);function c(u,h){let d=u?String(u):"";return h?"0000000".slice(d.length)+d:d}return c(a,0)+c(o,a)+c(r,1)}function Zs(i,e){if(i>=0){for(;i>127;)e.push(i&127|128),i=i>>>7;e.push(i)}else{for(let t=0;t<9;t++)e.push(i&127|128),i=i>>7;e.push(1)}}function Pl(){let i=this.buf[this.pos++],e=i&127;if(!(i&128))return this.assertBounds(),e;if(i=this.buf[this.pos++],e|=(i&127)<<7,!(i&128))return this.assertBounds(),e;if(i=this.buf[this.pos++],e|=(i&127)<<14,!(i&128))return this.assertBounds(),e;if(i=this.buf[this.pos++],e|=(i&127)<<21,!(i&128))return this.assertBounds(),e;i=this.buf[this.pos++],e|=(i&15)<<28;for(let t=5;i&128&&t<10;t++)i=this.buf[this.pos++];if(i&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}var K;function Md(){let i=new DataView(new ArrayBuffer(8));K=globalThis.BigInt!==void 0&&typeof i.getBigInt64=="function"&&typeof i.getBigUint64=="function"&&typeof i.setBigInt64=="function"&&typeof i.setBigUint64=="function"?{MIN:BigInt("-9223372036854775808"),MAX:BigInt("9223372036854775807"),UMIN:BigInt("0"),UMAX:BigInt("18446744073709551615"),C:BigInt,V:i}:void 0}Md();function Nl(i){if(!i)throw new Error("BigInt unavailable, see https://github.com/timostamm/protobuf-ts/blob/v1.0.8/MANUAL.md#bigint-support")}var Ol=/^-?[0-9]+$/,dn=4294967296,un=2147483648,hn=class{constructor(e,t){this.lo=e|0,this.hi=t|0}isZero(){return this.lo==0&&this.hi==0}toNumber(){let e=this.hi*dn+(this.lo>>>0);if(!Number.isSafeInteger(e))throw new Error("cannot convert to safe number");return e}},te=class i extends hn{static from(e){if(K)switch(typeof e){case"string":if(e=="0")return this.ZERO;if(e=="")throw new Error("string is no integer");e=K.C(e);case"number":if(e===0)return this.ZERO;e=K.C(e);case"bigint":if(!e)return this.ZERO;if(e<K.UMIN)throw new Error("signed value for ulong");if(e>K.UMAX)throw new Error("ulong too large");return K.V.setBigUint64(0,e,!0),new i(K.V.getInt32(0,!0),K.V.getInt32(4,!0))}else switch(typeof e){case"string":if(e=="0")return this.ZERO;if(e=e.trim(),!Ol.test(e))throw new Error("string is no integer");let[t,n,s]=Qs(e);if(t)throw new Error("signed value for ulong");return new i(n,s);case"number":if(e==0)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");if(e<0)throw new Error("signed value for ulong");return new i(e,e/dn)}throw new Error("unknown value "+typeof e)}toString(){return K?this.toBigInt().toString():ln(this.lo,this.hi)}toBigInt(){return Nl(K),K.V.setInt32(0,this.lo,!0),K.V.setInt32(4,this.hi,!0),K.V.getBigUint64(0,!0)}};te.ZERO=new te(0,0);var H=class i extends hn{static from(e){if(K)switch(typeof e){case"string":if(e=="0")return this.ZERO;if(e=="")throw new Error("string is no integer");e=K.C(e);case"number":if(e===0)return this.ZERO;e=K.C(e);case"bigint":if(!e)return this.ZERO;if(e<K.MIN)throw new Error("signed long too small");if(e>K.MAX)throw new Error("signed long too large");return K.V.setBigInt64(0,e,!0),new i(K.V.getInt32(0,!0),K.V.getInt32(4,!0))}else switch(typeof e){case"string":if(e=="0")return this.ZERO;if(e=e.trim(),!Ol.test(e))throw new Error("string is no integer");let[t,n,s]=Qs(e);if(t){if(s>un||s==un&&n!=0)throw new Error("signed long too small")}else if(s>=un)throw new Error("signed long too large");let r=new i(n,s);return t?r.negate():r;case"number":if(e==0)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");return e>0?new i(e,e/dn):new i(-e,-e/dn).negate()}throw new Error("unknown value "+typeof e)}isNegative(){return(this.hi&un)!==0}negate(){let e=~this.hi,t=this.lo;return t?t=~t+1:e+=1,new i(t,e)}toString(){if(K)return this.toBigInt().toString();if(this.isNegative()){let e=this.negate();return"-"+ln(e.lo,e.hi)}return ln(this.lo,this.hi)}toBigInt(){return Nl(K),K.V.setInt32(0,this.lo,!0),K.V.setInt32(4,this.hi,!0),K.V.getBigInt64(0,!0)}};H.ZERO=new H(0,0);var xl={readUnknownField:!0,readerFactory:i=>new er(i)};function Dl(i){return i?Object.assign(Object.assign({},xl),i):xl}var er=class{constructor(e,t){this.varint64=_l,this.uint32=Pl,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=t??new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0})}tag(){let e=this.uint32(),t=e>>>3,n=e&7;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e){let t=this.pos;switch(e){case m.Varint:for(;this.buf[this.pos++]&128;);break;case m.Bit64:this.pos+=4;case m.Bit32:this.pos+=4;break;case m.LengthDelimited:let n=this.uint32();this.pos+=n;break;case m.StartGroup:let s;for(;(s=this.tag()[1])!==m.EndGroup;)this.skip(s);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return new H(...this.varint64())}uint64(){return new te(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(e&1);return e=(e>>>1|(t&1)<<31)^n,t=t>>>1^n,new H(e,t)}bool(){let[e,t]=this.varint64();return e!==0||t!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return new te(this.sfixed32(),this.sfixed32())}sfixed64(){return new H(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}};function V(i,e){if(!i)throw new Error(e)}function tr(i,e){throw new Error(e??"Unexpected object: "+i)}var $d=34028234663852886e22,Wd=-34028234663852886e22,Hd=4294967295,qd=2147483647,Gd=-2147483648;function et(i){if(typeof i!="number")throw new Error("invalid int 32: "+typeof i);if(!Number.isInteger(i)||i>qd||i<Gd)throw new Error("invalid int 32: "+i)}function ht(i){if(typeof i!="number")throw new Error("invalid uint 32: "+typeof i);if(!Number.isInteger(i)||i>Hd||i<0)throw new Error("invalid uint 32: "+i)}function kt(i){if(typeof i!="number")throw new Error("invalid float 32: "+typeof i);if(Number.isFinite(i)&&(i>$d||i<Wd))throw new Error("invalid float 32: "+i)}var Al={writeUnknownFields:!0,writerFactory:()=>new ir};function Ul(i){return i?Object.assign(Object.assign({},Al),i):Al}var ir=class{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let s=0;s<this.chunks.length;s++)e+=this.chunks[s].length;let t=new Uint8Array(e),n=0;for(let s=0;s<this.chunks.length;s++)t.set(this.chunks[s],n),n+=this.chunks[s].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(ht(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return et(e),Zs(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){kt(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){ht(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){et(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return et(e),e=(e<<1^e>>31)>>>0,Zs(e,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),s=H.from(e);return n.setInt32(0,s.lo,!0),n.setInt32(4,s.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),s=te.from(e);return n.setInt32(0,s.lo,!0),n.setInt32(4,s.hi,!0),this.raw(t)}int64(e){let t=H.from(e);return cn(t.lo,t.hi,this.buf),this}sint64(e){let t=H.from(e),n=t.hi>>31,s=t.lo<<1^n,r=(t.hi<<1|t.lo>>>31)^n;return cn(s,r,this.buf),this}uint64(e){let t=te.from(e);return cn(t.lo,t.hi,this.buf),this}};var Ll={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0},Fl={ignoreUnknownFields:!1};function nr(i){return i?Object.assign(Object.assign({},Fl),i):Fl}function sr(i){return i?Object.assign(Object.assign({},Ll),i):Ll}function rr(i,e){var t,n;let s=Object.assign(Object.assign({},i),e);return s.typeRegistry=[...(t=i?.typeRegistry)!==null&&t!==void 0?t:[],...(n=e?.typeRegistry)!==null&&n!==void 0?n:[]],s}var fn=Symbol.for("protobuf-ts/message-type");function ft(i){let e=!1,t=[];for(let n=0;n<i.length;n++){let s=i.charAt(n);s=="_"?e=!0:/\d/.test(s)?(t.push(s),e=!0):e?(t.push(s.toUpperCase()),e=!1):n==0?t.push(s.toLowerCase()):t.push(s)}return t.join("")}var C=function(i){return i[i.DOUBLE=1]="DOUBLE",i[i.FLOAT=2]="FLOAT",i[i.INT64=3]="INT64",i[i.UINT64=4]="UINT64",i[i.INT32=5]="INT32",i[i.FIXED64=6]="FIXED64",i[i.FIXED32=7]="FIXED32",i[i.BOOL=8]="BOOL",i[i.STRING=9]="STRING",i[i.BYTES=12]="BYTES",i[i.UINT32=13]="UINT32",i[i.SFIXED32=15]="SFIXED32",i[i.SFIXED64=16]="SFIXED64",i[i.SINT32=17]="SINT32",i[i.SINT64=18]="SINT64",i}(C||{}),Te=function(i){return i[i.BIGINT=0]="BIGINT",i[i.STRING=1]="STRING",i[i.NUMBER=2]="NUMBER",i}(Te||{}),pn=function(i){return i[i.NO=0]="NO",i[i.PACKED=1]="PACKED",i[i.UNPACKED=2]="UNPACKED",i}(pn||{});function Bl(i){var e,t,n,s;return i.localName=(e=i.localName)!==null&&e!==void 0?e:ft(i.name),i.jsonName=(t=i.jsonName)!==null&&t!==void 0?t:ft(i.name),i.repeat=(n=i.repeat)!==null&&n!==void 0?n:pn.NO,i.opt=(s=i.opt)!==null&&s!==void 0?s:i.repeat||i.oneof?!1:i.kind=="message",i}function Vl(i){if(typeof i!="object"||i===null||!i.hasOwnProperty("oneofKind"))return!1;switch(typeof i.oneofKind){case"string":return i[i.oneofKind]===void 0?!1:Object.keys(i).length==2;case"undefined":return Object.keys(i).length==1;default:return!1}}var mn=class{constructor(e){var t;this.fields=(t=e.fields)!==null&&t!==void 0?t:[]}prepare(){if(this.data)return;let e=[],t=[],n=[];for(let s of this.fields)if(s.oneof)n.includes(s.oneof)||(n.push(s.oneof),e.push(s.oneof),t.push(s.oneof));else switch(t.push(s.localName),s.kind){case"scalar":case"enum":(!s.opt||s.repeat)&&e.push(s.localName);break;case"message":s.repeat&&e.push(s.localName);break;case"map":e.push(s.localName);break}this.data={req:e,known:t,oneofs:Object.values(n)}}is(e,t,n=!1){if(t<0)return!0;if(e==null||typeof e!="object")return!1;this.prepare();let s=Object.keys(e),r=this.data;if(s.length<r.req.length||r.req.some(o=>!s.includes(o))||!n&&s.some(o=>!r.known.includes(o)))return!1;if(t<1)return!0;for(let o of r.oneofs){let a=e[o];if(!Vl(a))return!1;if(a.oneofKind===void 0)continue;let l=this.fields.find(c=>c.localName===a.oneofKind);if(!l||!this.field(a[a.oneofKind],l,n,t))return!1}for(let o of this.fields)if(o.oneof===void 0&&!this.field(e[o.localName],o,n,t))return!1;return!0}field(e,t,n,s){let r=t.repeat;switch(t.kind){case"scalar":return e===void 0?t.opt:r?this.scalars(e,t.T,s,t.L):this.scalar(e,t.T,t.L);case"enum":return e===void 0?t.opt:r?this.scalars(e,C.INT32,s):this.scalar(e,C.INT32);case"message":return e===void 0?!0:r?this.messages(e,t.T(),n,s):this.message(e,t.T(),n,s);case"map":if(typeof e!="object"||e===null)return!1;if(s<2)return!0;if(!this.mapKeys(e,t.K,s))return!1;switch(t.V.kind){case"scalar":return this.scalars(Object.values(e),t.V.T,s,t.V.L);case"enum":return this.scalars(Object.values(e),C.INT32,s);case"message":return this.messages(Object.values(e),t.V.T(),n,s)}break}return!0}message(e,t,n,s){return n?t.isAssignable(e,s):t.is(e,s)}messages(e,t,n,s){if(!Array.isArray(e))return!1;if(s<2)return!0;if(n){for(let r=0;r<e.length&&r<s;r++)if(!t.isAssignable(e[r],s-1))return!1}else for(let r=0;r<e.length&&r<s;r++)if(!t.is(e[r],s-1))return!1;return!0}scalar(e,t,n){let s=typeof e;switch(t){case C.UINT64:case C.FIXED64:case C.INT64:case C.SFIXED64:case C.SINT64:switch(n){case Te.BIGINT:return s=="bigint";case Te.NUMBER:return s=="number"&&!isNaN(e);default:return s=="string"}case C.BOOL:return s=="boolean";case C.STRING:return s=="string";case C.BYTES:return e instanceof Uint8Array;case C.DOUBLE:case C.FLOAT:return s=="number"&&!isNaN(e);default:return s=="number"&&Number.isInteger(e)}}scalars(e,t,n,s){if(!Array.isArray(e))return!1;if(n<2)return!0;if(Array.isArray(e)){for(let r=0;r<e.length&&r<n;r++)if(!this.scalar(e[r],t,s))return!1}return!0}mapKeys(e,t,n){let s=Object.keys(e);switch(t){case C.INT32:case C.FIXED32:case C.SFIXED32:case C.SINT32:case C.UINT32:return this.scalars(s.slice(0,n).map(r=>parseInt(r)),t,n);case C.BOOL:return this.scalars(s.slice(0,n).map(r=>r=="true"?!0:r=="false"?!1:r),t,n);default:return this.scalars(s,t,n,Te.STRING)}}};function Re(i,e){switch(e){case Te.BIGINT:return i.toBigInt();case Te.NUMBER:return i.toNumber();default:return i.toString()}}var gn=class{constructor(e){this.info=e}prepare(){var e;if(this.fMap===void 0){this.fMap={};let t=(e=this.info.fields)!==null&&e!==void 0?e:[];for(let n of t)this.fMap[n.name]=n,this.fMap[n.jsonName]=n,this.fMap[n.localName]=n}}assert(e,t,n){if(!e){let s=We(n);throw(s=="number"||s=="boolean")&&(s=n.toString()),new Error(`Cannot parse JSON ${s} for ${this.info.typeName}#${t}`)}}read(e,t,n){this.prepare();let s=[];for(let[r,o]of Object.entries(e)){let a=this.fMap[r];if(!a){if(!n.ignoreUnknownFields)throw new Error(`Found unknown field while reading ${this.info.typeName} from JSON format. JSON key: ${r}`);continue}let l=a.localName,c;if(a.oneof){if(o===null&&(a.kind!=="enum"||a.T()[0]!=="google.protobuf.NullValue"))continue;if(s.includes(a.oneof))throw new Error(`Multiple members of the oneof group "${a.oneof}" of ${this.info.typeName} are present in JSON.`);s.push(a.oneof),c=t[a.oneof]={oneofKind:l}}else c=t;if(a.kind=="map"){if(o===null)continue;this.assert(dt(o),a.name,o);let u=c[l];for(let[h,d]of Object.entries(o)){this.assert(d!==null,a.name+" map value",null);let f;switch(a.V.kind){case"message":f=a.V.T().internalJsonRead(d,n);break;case"enum":if(f=this.enum(a.V.T(),d,a.name,n.ignoreUnknownFields),f===!1)continue;break;case"scalar":f=this.scalar(d,a.V.T,a.V.L,a.name);break}this.assert(f!==void 0,a.name+" map value",d);let p=h;a.K==C.BOOL&&(p=p=="true"?!0:p=="false"?!1:p),p=this.scalar(p,a.K,Te.STRING,a.name).toString(),u[p]=f}}else if(a.repeat){if(o===null)continue;this.assert(Array.isArray(o),a.name,o);let u=c[l];for(let h of o){this.assert(h!==null,a.name,null);let d;switch(a.kind){case"message":d=a.T().internalJsonRead(h,n);break;case"enum":if(d=this.enum(a.T(),h,a.name,n.ignoreUnknownFields),d===!1)continue;break;case"scalar":d=this.scalar(h,a.T,a.L,a.name);break}this.assert(d!==void 0,a.name,o),u.push(d)}}else switch(a.kind){case"message":if(o===null&&a.T().typeName!="google.protobuf.Value"){this.assert(a.oneof===void 0,a.name+" (oneof member)",null);continue}c[l]=a.T().internalJsonRead(o,n,c[l]);break;case"enum":let u=this.enum(a.T(),o,a.name,n.ignoreUnknownFields);if(u===!1)continue;c[l]=u;break;case"scalar":c[l]=this.scalar(o,a.T,a.L,a.name);break}}}enum(e,t,n,s){if(e[0]=="google.protobuf.NullValue"&&V(t===null||t==="NULL_VALUE",`Unable to parse field ${this.info.typeName}#${n}, enum ${e[0]} only accepts null.`),t===null)return 0;switch(typeof t){case"number":return V(Number.isInteger(t),`Unable to parse field ${this.info.typeName}#${n}, enum can only be integral number, got ${t}.`),t;case"string":let r=t;e[2]&&t.substring(0,e[2].length)===e[2]&&(r=t.substring(e[2].length));let o=e[1][r];return typeof o>"u"&&s?!1:(V(typeof o=="number",`Unable to parse field ${this.info.typeName}#${n}, enum ${e[0]} has no value for "${t}".`),o)}V(!1,`Unable to parse field ${this.info.typeName}#${n}, cannot parse enum value from ${typeof t}".`)}scalar(e,t,n,s){let r;try{switch(t){case C.DOUBLE:case C.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""){r="empty string";break}if(typeof e=="string"&&e.trim().length!==e.length){r="extra whitespace";break}if(typeof e!="string"&&typeof e!="number")break;let o=Number(e);if(Number.isNaN(o)){r="not a number";break}if(!Number.isFinite(o)){r="too large or small";break}return t==C.FLOAT&&kt(o),o;case C.INT32:case C.FIXED32:case C.SFIXED32:case C.SINT32:case C.UINT32:if(e===null)return 0;let a;if(typeof e=="number"?a=e:e===""?r="empty string":typeof e=="string"&&(e.trim().length!==e.length?r="extra whitespace":a=Number(e)),a===void 0)break;return t==C.UINT32?ht(a):et(a),a;case C.INT64:case C.SFIXED64:case C.SINT64:if(e===null)return Re(H.ZERO,n);if(typeof e!="number"&&typeof e!="string")break;return Re(H.from(e),n);case C.FIXED64:case C.UINT64:if(e===null)return Re(te.ZERO,n);if(typeof e!="number"&&typeof e!="string")break;return Re(te.from(e),n);case C.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case C.STRING:if(e===null)return"";if(typeof e!="string"){r="extra whitespace";break}try{encodeURIComponent(e)}catch(l){l="invalid UTF8";break}return e;case C.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return El(e)}}catch(o){r=o.message}this.assert(!1,s+(r?" - "+r:""),e)}};var bn=class{constructor(e){var t;this.fields=(t=e.fields)!==null&&t!==void 0?t:[]}write(e,t){let n={},s=e;for(let r of this.fields){if(!r.oneof){let c=this.field(r,s[r.localName],t);c!==void 0&&(n[t.useProtoFieldName?r.name:r.jsonName]=c);continue}let o=s[r.oneof];if(o.oneofKind!==r.localName)continue;let a=r.kind=="scalar"||r.kind=="enum"?Object.assign(Object.assign({},t),{emitDefaultValues:!0}):t,l=this.field(r,o[r.localName],a);V(l!==void 0),n[t.useProtoFieldName?r.name:r.jsonName]=l}return n}field(e,t,n){let s;if(e.kind=="map"){V(typeof t=="object"&&t!==null);let r={};switch(e.V.kind){case"scalar":for(let[l,c]of Object.entries(t)){let u=this.scalar(e.V.T,c,e.name,!1,!0);V(u!==void 0),r[l.toString()]=u}break;case"message":let o=e.V.T();for(let[l,c]of Object.entries(t)){let u=this.message(o,c,e.name,n);V(u!==void 0),r[l.toString()]=u}break;case"enum":let a=e.V.T();for(let[l,c]of Object.entries(t)){V(c===void 0||typeof c=="number");let u=this.enum(a,c,e.name,!1,!0,n.enumAsInteger);V(u!==void 0),r[l.toString()]=u}break}(n.emitDefaultValues||Object.keys(r).length>0)&&(s=r)}else if(e.repeat){V(Array.isArray(t));let r=[];switch(e.kind){case"scalar":for(let l=0;l<t.length;l++){let c=this.scalar(e.T,t[l],e.name,e.opt,!0);V(c!==void 0),r.push(c)}break;case"enum":let o=e.T();for(let l=0;l<t.length;l++){V(t[l]===void 0||typeof t[l]=="number");let c=this.enum(o,t[l],e.name,e.opt,!0,n.enumAsInteger);V(c!==void 0),r.push(c)}break;case"message":let a=e.T();for(let l=0;l<t.length;l++){let c=this.message(a,t[l],e.name,n);V(c!==void 0),r.push(c)}break}(n.emitDefaultValues||r.length>0||n.emitDefaultValues)&&(s=r)}else switch(e.kind){case"scalar":s=this.scalar(e.T,t,e.name,e.opt,n.emitDefaultValues);break;case"enum":s=this.enum(e.T(),t,e.name,e.opt,n.emitDefaultValues,n.enumAsInteger);break;case"message":s=this.message(e.T(),t,e.name,n);break}return s}enum(e,t,n,s,r,o){if(e[0]=="google.protobuf.NullValue")return!r&&!s?void 0:null;if(t===void 0){V(s);return}if(!(t===0&&!r&&!s))return V(typeof t=="number"),V(Number.isInteger(t)),o||!e[1].hasOwnProperty(t)?t:e[2]?e[2]+e[1][t]:e[1][t]}message(e,t,n,s){return t===void 0?s.emitDefaultValues?null:void 0:e.internalJsonWrite(t,s)}scalar(e,t,n,s,r){if(t===void 0){V(s);return}let o=r||s;switch(e){case C.INT32:case C.SFIXED32:case C.SINT32:return t===0?o?0:void 0:(et(t),t);case C.FIXED32:case C.UINT32:return t===0?o?0:void 0:(ht(t),t);case C.FLOAT:kt(t);case C.DOUBLE:return t===0?o?0:void 0:(V(typeof t=="number"),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t);case C.STRING:return t===""?o?"":void 0:(V(typeof t=="string"),t);case C.BOOL:return t===!1?o?!1:void 0:(V(typeof t=="boolean"),t);case C.UINT64:case C.FIXED64:V(typeof t=="number"||typeof t=="string"||typeof t=="bigint");let a=te.from(t);return a.isZero()&&!o?void 0:a.toString();case C.INT64:case C.SFIXED64:case C.SINT64:V(typeof t=="number"||typeof t=="string"||typeof t=="bigint");let l=H.from(t);return l.isZero()&&!o?void 0:l.toString();case C.BYTES:return V(t instanceof Uint8Array),t.byteLength?Il(t):o?"":void 0}}};function mi(i,e=Te.STRING){switch(i){case C.BOOL:return!1;case C.UINT64:case C.FIXED64:return Re(te.ZERO,e);case C.INT64:case C.SFIXED64:case C.SINT64:return Re(H.ZERO,e);case C.DOUBLE:case C.FLOAT:return 0;case C.BYTES:return new Uint8Array(0);case C.STRING:return"";default:return 0}}var yn=class{constructor(e){this.info=e}prepare(){var e;if(!this.fieldNoToField){let t=(e=this.info.fields)!==null&&e!==void 0?e:[];this.fieldNoToField=new Map(t.map(n=>[n.no,n]))}}read(e,t,n,s){this.prepare();let r=s===void 0?e.len:e.pos+s;for(;e.pos<r;){let[o,a]=e.tag(),l=this.fieldNoToField.get(o);if(!l){let d=n.readUnknownField;if(d=="throw")throw new Error(`Unknown field ${o} (wire type ${a}) for ${this.info.typeName}`);let f=e.skip(a);d!==!1&&(d===!0?y.onRead:d)(this.info.typeName,t,o,a,f);continue}let c=t,u=l.repeat,h=l.localName;switch(l.oneof&&(c=c[l.oneof],c.oneofKind!==h&&(c=t[l.oneof]={oneofKind:h})),l.kind){case"scalar":case"enum":let d=l.kind=="enum"?C.INT32:l.T,f=l.kind=="scalar"?l.L:void 0;if(u){let v=c[h];if(a==m.LengthDelimited&&d!=C.STRING&&d!=C.BYTES){let k=e.uint32()+e.pos;for(;e.pos<k;)v.push(this.scalar(e,d,f))}else v.push(this.scalar(e,d,f))}else c[h]=this.scalar(e,d,f);break;case"message":if(u){let v=c[h],k=l.T().internalBinaryRead(e,e.uint32(),n);v.push(k)}else c[h]=l.T().internalBinaryRead(e,e.uint32(),n,c[h]);break;case"map":let[p,g]=this.mapEntry(l,e,n);c[h][p]=g;break}}}mapEntry(e,t,n){let s=t.uint32(),r=t.pos+s,o,a;for(;t.pos<r;){let[l,c]=t.tag();switch(l){case 1:e.K==C.BOOL?o=t.bool().toString():o=this.scalar(t,e.K,Te.STRING);break;case 2:switch(e.V.kind){case"scalar":a=this.scalar(t,e.V.T,e.V.L);break;case"enum":a=t.int32();break;case"message":a=e.V.T().internalBinaryRead(t,t.uint32(),n);break}break;default:throw new Error(`Unknown field ${l} (wire type ${c}) in map entry for ${this.info.typeName}#${e.name}`)}}if(o===void 0){let l=mi(e.K);o=e.K==C.BOOL?l.toString():l}if(a===void 0)switch(e.V.kind){case"scalar":a=mi(e.V.T,e.V.L);break;case"enum":a=0;break;case"message":a=e.V.T().create();break}return[o,a]}scalar(e,t,n){switch(t){case C.INT32:return e.int32();case C.STRING:return e.string();case C.BOOL:return e.bool();case C.DOUBLE:return e.double();case C.FLOAT:return e.float();case C.INT64:return Re(e.int64(),n);case C.UINT64:return Re(e.uint64(),n);case C.FIXED64:return Re(e.fixed64(),n);case C.FIXED32:return e.fixed32();case C.BYTES:return e.bytes();case C.UINT32:return e.uint32();case C.SFIXED32:return e.sfixed32();case C.SFIXED64:return Re(e.sfixed64(),n);case C.SINT32:return e.sint32();case C.SINT64:return Re(e.sint64(),n)}}};var Sn=class{constructor(e){this.info=e}prepare(){if(!this.fields){let e=this.info.fields?this.info.fields.concat():[];this.fields=e.sort((t,n)=>t.no-n.no)}}write(e,t,n){this.prepare();for(let r of this.fields){let o,a,l=r.repeat,c=r.localName;if(r.oneof){let u=e[r.oneof];if(u.oneofKind!==c)continue;o=u[c],a=!0}else o=e[c],a=!1;switch(r.kind){case"scalar":case"enum":let u=r.kind=="enum"?C.INT32:r.T;if(l)if(V(Array.isArray(o)),l==pn.PACKED)this.packed(t,u,r.no,o);else for(let h of o)this.scalar(t,u,r.no,h,!0);else o===void 0?V(r.opt):this.scalar(t,u,r.no,o,a||r.opt);break;case"message":if(l){V(Array.isArray(o));for(let h of o)this.message(t,n,r.T(),r.no,h)}else this.message(t,n,r.T(),r.no,o);break;case"map":V(typeof o=="object"&&o!==null);for(let[h,d]of Object.entries(o))this.mapEntry(t,n,r,h,d);break}}let s=n.writeUnknownFields;s!==!1&&(s===!0?y.onWrite:s)(this.info.typeName,e,t)}mapEntry(e,t,n,s,r){e.tag(n.no,m.LengthDelimited),e.fork();let o=s;switch(n.K){case C.INT32:case C.FIXED32:case C.UINT32:case C.SFIXED32:case C.SINT32:o=Number.parseInt(s);break;case C.BOOL:V(s=="true"||s=="false"),o=s=="true";break}switch(this.scalar(e,n.K,1,o,!0),n.V.kind){case"scalar":this.scalar(e,n.V.T,2,r,!0);break;case"enum":this.scalar(e,C.INT32,2,r,!0);break;case"message":this.message(e,t,n.V.T(),2,r);break}e.join()}message(e,t,n,s,r){r!==void 0&&(n.internalBinaryWrite(r,e.tag(s,m.LengthDelimited).fork(),t),e.join())}scalar(e,t,n,s,r){let[o,a,l]=this.scalarInfo(t,s);(!l||r)&&(e.tag(n,o),e[a](s))}packed(e,t,n,s){if(!s.length)return;V(t!==C.BYTES&&t!==C.STRING),e.tag(n,m.LengthDelimited),e.fork();let[,r]=this.scalarInfo(t);for(let o=0;o<s.length;o++)e[r](s[o]);e.join()}scalarInfo(e,t){let n=m.Varint,s,r=t===void 0,o=t===0;switch(e){case C.INT32:s="int32";break;case C.STRING:o=r||!t.length,n=m.LengthDelimited,s="string";break;case C.BOOL:o=t===!1,s="bool";break;case C.UINT32:s="uint32";break;case C.DOUBLE:n=m.Bit64,s="double";break;case C.FLOAT:n=m.Bit32,s="float";break;case C.INT64:o=r||H.from(t).isZero(),s="int64";break;case C.UINT64:o=r||te.from(t).isZero(),s="uint64";break;case C.FIXED64:o=r||te.from(t).isZero(),n=m.Bit64,s="fixed64";break;case C.BYTES:o=r||!t.byteLength,n=m.LengthDelimited,s="bytes";break;case C.FIXED32:n=m.Bit32,s="fixed32";break;case C.SFIXED32:n=m.Bit32,s="sfixed32";break;case C.SFIXED64:o=r||H.from(t).isZero(),n=m.Bit64,s="sfixed64";break;case C.SINT32:s="sint32";break;case C.SINT64:o=r||H.from(t).isZero(),s="sint64";break}return[n,s,r||o]}};function jl(i){let e=i.messagePrototype?Object.create(i.messagePrototype):Object.defineProperty({},fn,{value:i});for(let t of i.fields){let n=t.localName;if(!t.opt)if(t.oneof)e[t.oneof]={oneofKind:void 0};else if(t.repeat)e[n]=[];else switch(t.kind){case"scalar":e[n]=mi(t.T,t.L);break;case"enum":e[n]=0;break;case"map":e[n]={};break}}return e}function R(i,e,t){let n,s=t,r;for(let o of i.fields){let a=o.localName;if(o.oneof){let l=s[o.oneof];if(l?.oneofKind==null)continue;if(n=l[a],r=e[o.oneof],r.oneofKind=l.oneofKind,n==null){delete r[a];continue}}else if(n=s[a],r=e,n==null)continue;switch(o.repeat&&(r[a].length=n.length),o.kind){case"scalar":case"enum":if(o.repeat)for(let c=0;c<n.length;c++)r[a][c]=n[c];else r[a]=n;break;case"message":let l=o.T();if(o.repeat)for(let c=0;c<n.length;c++)r[a][c]=l.create(n[c]);else r[a]===void 0?r[a]=l.create(n):l.mergePartial(r[a],n);break;case"map":switch(o.V.kind){case"scalar":case"enum":Object.assign(r[a],n);break;case"message":let c=o.V.T();for(let u of Object.keys(n))r[a][u]=c.create(n[u]);break}break}}}function Wl(i,e,t){if(e===t)return!0;if(!e||!t)return!1;for(let n of i.fields){let s=n.localName,r=n.oneof?e[n.oneof][s]:e[s],o=n.oneof?t[n.oneof][s]:t[s];switch(n.kind){case"enum":case"scalar":let a=n.kind=="enum"?C.INT32:n.T;if(!(n.repeat?Ml(a,r,o):Hl(a,r,o)))return!1;break;case"map":if(!(n.V.kind=="message"?$l(n.V.T(),kn(r),kn(o)):Ml(n.V.kind=="enum"?C.INT32:n.V.T,kn(r),kn(o))))return!1;break;case"message":let l=n.T();if(!(n.repeat?$l(l,r,o):l.equals(r,o)))return!1;break}}return!0}var kn=Object.values;function Hl(i,e,t){if(e===t)return!0;if(i!==C.BYTES)return!1;let n=e,s=t;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r]!=s[r])return!1;return!0}function Ml(i,e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Hl(i,e[n],t[n]))return!1;return!0}function $l(i,e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!i.equals(e[n],t[n]))return!1;return!0}var Jd=Object.getOwnPropertyDescriptors(Object.getPrototypeOf({})),I=class{constructor(e,t,n){this.defaultCheckDepth=16,this.typeName=e,this.fields=t.map(Bl),this.options=n??{},this.messagePrototype=Object.create(null,Object.assign(Object.assign({},Jd),{[fn]:{value:this}})),this.refTypeCheck=new mn(this),this.refJsonReader=new gn(this),this.refJsonWriter=new bn(this),this.refBinReader=new yn(this),this.refBinWriter=new Sn(this)}create(e){let t=jl(this);return e!==void 0&&R(this,t,e),t}clone(e){let t=this.create();return R(this,t,e),t}equals(e,t){return Wl(this,e,t)}is(e,t=this.defaultCheckDepth){return this.refTypeCheck.is(e,t,!1)}isAssignable(e,t=this.defaultCheckDepth){return this.refTypeCheck.is(e,t,!0)}mergePartial(e,t){R(this,e,t)}fromBinary(e,t){let n=Dl(t);return this.internalBinaryRead(n.readerFactory(e),e.byteLength,n)}fromJson(e,t){return this.internalJsonRead(e,nr(t))}fromJsonString(e,t){let n=JSON.parse(e);return this.fromJson(n,t)}toJson(e,t){return this.internalJsonWrite(e,sr(t))}toJsonString(e,t){var n;let s=this.toJson(e,t);return JSON.stringify(s,null,(n=t?.prettySpaces)!==null&&n!==void 0?n:0)}toBinary(e,t){let n=Ul(t);return this.internalBinaryWrite(e,n.writerFactory(),n).finish()}internalJsonRead(e,t,n){if(e!==null&&typeof e=="object"&&!Array.isArray(e)){let s=n??this.create();return this.refJsonReader.read(e,s,t),s}throw new Error(`Unable to parse message ${this.typeName} from JSON ${We(e)}.`)}internalJsonWrite(e,t){return this.refJsonWriter.write(e,t)}internalBinaryWrite(e,t,n){return this.refBinWriter.write(e,t,n),t}internalBinaryRead(e,t,n,s){let r=s??this.create();return this.refBinReader.read(e,r,n,t),r}};function ql(i,e){var t,n,s;let r=i;return r.service=e,r.localName=(t=r.localName)!==null&&t!==void 0?t:ft(r.name),r.serverStreaming=!!r.serverStreaming,r.clientStreaming=!!r.clientStreaming,r.options=(n=r.options)!==null&&n!==void 0?n:{},r.idempotency=(s=r.idempotency)!==null&&s!==void 0?s:void 0,r}var gi=class{constructor(e,t,n){this.typeName=e,this.methods=t.map(s=>ql(s,this)),this.options=n??{}}};var oe=class extends Error{constructor(e,t="UNKNOWN",n){super(e),this.name="RpcError",Object.setPrototypeOf(this,new.target.prototype),this.code=t,this.meta=n??{}}toString(){let e=[this.name+": "+this.message];this.code&&(e.push(""),e.push("Code: "+this.code)),this.serviceName&&this.methodName&&e.push("Method: "+this.serviceName+"/"+this.methodName);let t=Object.entries(this.meta);if(t.length){e.push(""),e.push("Meta:");for(let[n,s]of t)e.push(`  ${n}: ${s}`)}return e.join(`
`)}};function ar(i,e){if(!e)return i;let t={};Cn(i,t),Cn(e,t);for(let n of Object.keys(e)){let s=e[n];switch(n){case"jsonOptions":t.jsonOptions=rr(i.jsonOptions,t.jsonOptions);break;case"binaryOptions":t.binaryOptions=Ys(i.binaryOptions,t.binaryOptions);break;case"meta":t.meta={},Cn(i.meta,t.meta),Cn(e.meta,t.meta);break;case"interceptors":t.interceptors=i.interceptors?i.interceptors.concat(s):s.concat();break}}return t}function Cn(i,e){if(!i)return;let t=e;for(let[n,s]of Object.entries(i))s instanceof Date?t[n]=new Date(s.getTime()):Array.isArray(s)?t[n]=s.concat():t[n]=s}var De=function(i){return i[i.PENDING=0]="PENDING",i[i.REJECTED=1]="REJECTED",i[i.RESOLVED=2]="RESOLVED",i}(De||{}),pt=class{constructor(e=!0){this._state=De.PENDING,this._promise=new Promise((t,n)=>{this._resolve=t,this._reject=n}),e&&this._promise.catch(t=>{})}get state(){return this._state}get promise(){return this._promise}resolve(e){if(this.state!==De.PENDING)throw new Error(`cannot resolve ${De[this.state].toLowerCase()}`);this._resolve(e),this._state=De.RESOLVED}reject(e){if(this.state!==De.PENDING)throw new Error(`cannot reject ${De[this.state].toLowerCase()}`);this._reject(e),this._state=De.REJECTED}resolvePending(e){this._state===De.PENDING&&this.resolve(e)}rejectPending(e){this._state===De.PENDING&&this.reject(e)}};var Kd=function(i,e,t,n){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((n=n.apply(i,e||[])).next())})},bi=class{constructor(e,t,n,s,r,o,a){this.method=e,this.requestHeaders=t,this.request=n,this.headers=s,this.response=r,this.status=o,this.trailers=a}then(e,t){return this.promiseFinished().then(n=>e?Promise.resolve(e(n)):n,n=>t?Promise.resolve(t(n)):Promise.reject(n))}promiseFinished(){return Kd(this,void 0,void 0,function*(){let[e,t,n,s]=yield Promise.all([this.headers,this.response,this.status,this.trailers]);return{method:this.method,requestHeaders:this.requestHeaders,request:this.request,headers:e,response:t,status:n,trailers:s}})}};function Ae(i,e,t,n,s){var r,o,a,l;if(i=="unary"){let c=(u,h,d)=>e.unary(u,h,d);for(let u of((r=n.interceptors)!==null&&r!==void 0?r:[]).filter(h=>h.interceptUnary).reverse()){let h=c;c=(d,f,p)=>u.interceptUnary(h,d,f,p)}return c(t,s,n)}if(i=="serverStreaming"){let c=(u,h,d)=>e.serverStreaming(u,h,d);for(let u of((o=n.interceptors)!==null&&o!==void 0?o:[]).filter(h=>h.interceptServerStreaming).reverse()){let h=c;c=(d,f,p)=>u.interceptServerStreaming(h,d,f,p)}return c(t,s,n)}if(i=="clientStreaming"){let c=(u,h)=>e.clientStreaming(u,h);for(let u of((a=n.interceptors)!==null&&a!==void 0?a:[]).filter(h=>h.interceptClientStreaming).reverse()){let h=c;c=(d,f)=>u.interceptClientStreaming(h,d,f)}return c(t,n)}if(i=="duplex"){let c=(u,h)=>e.duplex(u,h);for(let u of((l=n.interceptors)!==null&&l!==void 0?l:[]).filter(h=>h.interceptDuplex).reverse()){let h=c;c=(d,f)=>u.interceptDuplex(h,d,f)}return c(t,n)}tr(i)}function yi(i,e){return function(){return i.apply(e,arguments)}}var{toString:zd}=Object.prototype,{getPrototypeOf:lr}=Object,vn=(i=>e=>{let t=zd.call(e);return i[t]||(i[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Ue=i=>(i=i.toLowerCase(),e=>vn(e)===i),Tn=i=>e=>typeof e===i,{isArray:Ft}=Array,Si=Tn("undefined");function Xd(i){return i!==null&&!Si(i)&&i.constructor!==null&&!Si(i.constructor)&&Pe(i.constructor.isBuffer)&&i.constructor.isBuffer(i)}var Kl=Ue("ArrayBuffer");function Yd(i){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(i):e=i&&i.buffer&&Kl(i.buffer),e}var Qd=Tn("string"),Pe=Tn("function"),zl=Tn("number"),Rn=i=>i!==null&&typeof i=="object",Zd=i=>i===!0||i===!1,wn=i=>{if(vn(i)!=="object")return!1;let e=lr(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},eh=Ue("Date"),th=Ue("File"),ih=Ue("Blob"),nh=Ue("FileList"),sh=i=>Rn(i)&&Pe(i.pipe),rh=i=>{let e;return i&&(typeof FormData=="function"&&i instanceof FormData||Pe(i.append)&&((e=vn(i))==="formdata"||e==="object"&&Pe(i.toString)&&i.toString()==="[object FormData]"))},ah=Ue("URLSearchParams"),[oh,ch,lh,uh]=["ReadableStream","Request","Response","Headers"].map(Ue),dh=i=>i.trim?i.trim():i.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ki(i,e,{allOwnKeys:t=!1}={}){if(i===null||typeof i>"u")return;let n,s;if(typeof i!="object"&&(i=[i]),Ft(i))for(n=0,s=i.length;n<s;n++)e.call(null,i[n],n,i);else{let r=t?Object.getOwnPropertyNames(i):Object.keys(i),o=r.length,a;for(n=0;n<o;n++)a=r[n],e.call(null,i[a],a,i)}}function Xl(i,e){e=e.toLowerCase();let t=Object.keys(i),n=t.length,s;for(;n-- >0;)if(s=t[n],e===s.toLowerCase())return s;return null}var Yl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ql=i=>!Si(i)&&i!==Yl;function cr(){let{caseless:i}=Ql(this)&&this||{},e={},t=(n,s)=>{let r=i&&Xl(e,s)||s;wn(e[r])&&wn(n)?e[r]=cr(e[r],n):wn(n)?e[r]=cr({},n):Ft(n)?e[r]=n.slice():e[r]=n};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&ki(arguments[n],t);return e}var hh=(i,e,t,{allOwnKeys:n}={})=>(ki(e,(s,r)=>{t&&Pe(s)?i[r]=yi(s,t):i[r]=s},{allOwnKeys:n}),i),fh=i=>(i.charCodeAt(0)===65279&&(i=i.slice(1)),i),ph=(i,e,t,n)=>{i.prototype=Object.create(e.prototype,n),i.prototype.constructor=i,Object.defineProperty(i,"super",{value:e.prototype}),t&&Object.assign(i.prototype,t)},mh=(i,e,t,n)=>{let s,r,o,a={};if(e=e||{},i==null)return e;do{for(s=Object.getOwnPropertyNames(i),r=s.length;r-- >0;)o=s[r],(!n||n(o,i,e))&&!a[o]&&(e[o]=i[o],a[o]=!0);i=t!==!1&&lr(i)}while(i&&(!t||t(i,e))&&i!==Object.prototype);return e},gh=(i,e,t)=>{i=String(i),(t===void 0||t>i.length)&&(t=i.length),t-=e.length;let n=i.indexOf(e,t);return n!==-1&&n===t},bh=i=>{if(!i)return null;if(Ft(i))return i;let e=i.length;if(!zl(e))return null;let t=new Array(e);for(;e-- >0;)t[e]=i[e];return t},yh=(i=>e=>i&&e instanceof i)(typeof Uint8Array<"u"&&lr(Uint8Array)),Sh=(i,e)=>{let n=(i&&i[Symbol.iterator]).call(i),s;for(;(s=n.next())&&!s.done;){let r=s.value;e.call(i,r[0],r[1])}},kh=(i,e)=>{let t,n=[];for(;(t=i.exec(e))!==null;)n.push(t);return n},Ch=Ue("HTMLFormElement"),wh=i=>i.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,s){return n.toUpperCase()+s}),Gl=(({hasOwnProperty:i})=>(e,t)=>i.call(e,t))(Object.prototype),vh=Ue("RegExp"),Zl=(i,e)=>{let t=Object.getOwnPropertyDescriptors(i),n={};ki(t,(s,r)=>{let o;(o=e(s,r,i))!==!1&&(n[r]=o||s)}),Object.defineProperties(i,n)},Th=i=>{Zl(i,(e,t)=>{if(Pe(i)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;let n=i[t];if(Pe(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},Rh=(i,e)=>{let t={},n=s=>{s.forEach(r=>{t[r]=!0})};return Ft(i)?n(i):n(String(i).split(e)),t},Eh=()=>{},Ih=(i,e)=>i!=null&&Number.isFinite(i=+i)?i:e,or="abcdefghijklmnopqrstuvwxyz",Jl="0123456789",eu={DIGIT:Jl,ALPHA:or,ALPHA_DIGIT:or+or.toUpperCase()+Jl},_h=(i=16,e=eu.ALPHA_DIGIT)=>{let t="",{length:n}=e;for(;i--;)t+=e[Math.random()*n|0];return t};function Ph(i){return!!(i&&Pe(i.append)&&i[Symbol.toStringTag]==="FormData"&&i[Symbol.iterator])}var Nh=i=>{let e=new Array(10),t=(n,s)=>{if(Rn(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[s]=n;let r=Ft(n)?[]:{};return ki(n,(o,a)=>{let l=t(o,s+1);!Si(l)&&(r[a]=l)}),e[s]=void 0,r}}return n};return t(i,0)},Oh=Ue("AsyncFunction"),xh=i=>i&&(Rn(i)||Pe(i))&&Pe(i.then)&&Pe(i.catch),S={isArray:Ft,isArrayBuffer:Kl,isBuffer:Xd,isFormData:rh,isArrayBufferView:Yd,isString:Qd,isNumber:zl,isBoolean:Zd,isObject:Rn,isPlainObject:wn,isReadableStream:oh,isRequest:ch,isResponse:lh,isHeaders:uh,isUndefined:Si,isDate:eh,isFile:th,isBlob:ih,isRegExp:vh,isFunction:Pe,isStream:sh,isURLSearchParams:ah,isTypedArray:yh,isFileList:nh,forEach:ki,merge:cr,extend:hh,trim:dh,stripBOM:fh,inherits:ph,toFlatObject:mh,kindOf:vn,kindOfTest:Ue,endsWith:gh,toArray:bh,forEachEntry:Sh,matchAll:kh,isHTMLForm:Ch,hasOwnProperty:Gl,hasOwnProp:Gl,reduceDescriptors:Zl,freezeMethods:Th,toObjectSet:Rh,toCamelCase:wh,noop:Eh,toFiniteNumber:Ih,findKey:Xl,global:Yl,isContextDefined:Ql,ALPHABET:eu,generateString:_h,isSpecCompliantForm:Ph,toJSONObject:Nh,isAsyncFn:Oh,isThenable:xh};function Bt(i,e,t,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=i,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),n&&(this.request=n),s&&(this.response=s)}S.inherits(Bt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:S.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var tu=Bt.prototype,iu={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(i=>{iu[i]={value:i}});Object.defineProperties(Bt,iu);Object.defineProperty(tu,"isAxiosError",{value:!0});Bt.from=(i,e,t,n,s,r)=>{let o=Object.create(tu);return S.toFlatObject(i,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),Bt.call(o,i.message,e,t,n,s),o.cause=i,o.name=i.name,r&&Object.assign(o,r),o};var x=Bt;var En=null;function ur(i){return S.isPlainObject(i)||S.isArray(i)}function su(i){return S.endsWith(i,"[]")?i.slice(0,-2):i}function nu(i,e,t){return i?i.concat(e).map(function(s,r){return s=su(s),!t&&r?"["+s+"]":s}).join(t?".":""):e}function Dh(i){return S.isArray(i)&&!i.some(ur)}var Ah=S.toFlatObject(S,{},null,function(e){return/^is[A-Z]/.test(e)});function Uh(i,e,t){if(!S.isObject(i))throw new TypeError("target must be an object");e=e||new(En||FormData),t=S.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,v){return!S.isUndefined(v[g])});let n=t.metaTokens,s=t.visitor||u,r=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&S.isSpecCompliantForm(e);if(!S.isFunction(s))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(S.isDate(p))return p.toISOString();if(!l&&S.isBlob(p))throw new x("Blob is not supported. Use a Buffer instead.");return S.isArrayBuffer(p)||S.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,g,v){let k=p;if(p&&!v&&typeof p=="object"){if(S.endsWith(g,"{}"))g=n?g:g.slice(0,-2),p=JSON.stringify(p);else if(S.isArray(p)&&Dh(p)||(S.isFileList(p)||S.endsWith(g,"[]"))&&(k=S.toArray(p)))return g=su(g),k.forEach(function(P,A){!(S.isUndefined(P)||P===null)&&e.append(o===!0?nu([g],A,r):o===null?g:g+"[]",c(P))}),!1}return ur(p)?!0:(e.append(nu(v,g,r),c(p)),!1)}let h=[],d=Object.assign(Ah,{defaultVisitor:u,convertValue:c,isVisitable:ur});function f(p,g){if(!S.isUndefined(p)){if(h.indexOf(p)!==-1)throw Error("Circular reference detected in "+g.join("."));h.push(p),S.forEach(p,function(k,_){(!(S.isUndefined(k)||k===null)&&s.call(e,k,S.isString(_)?_.trim():_,g,d))===!0&&f(k,g?g.concat(_):[_])}),h.pop()}}if(!S.isObject(i))throw new TypeError("data must be an object");return f(i),e}var mt=Uh;function ru(i){let e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(i).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function au(i,e){this._pairs=[],i&&mt(i,this,e)}var ou=au.prototype;ou.append=function(e,t){this._pairs.push([e,t])};ou.toString=function(e){let t=e?function(n){return e.call(this,n,ru)}:ru;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};var In=au;function Lh(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ci(i,e,t){if(!e)return i;let n=t&&t.encode||Lh,s=t&&t.serialize,r;if(s?r=s(e,t):r=S.isURLSearchParams(e)?e.toString():new In(e,t).toString(n),r){let o=i.indexOf("#");o!==-1&&(i=i.slice(0,o)),i+=(i.indexOf("?")===-1?"?":"&")+r}return i}var dr=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){S.forEach(this.handlers,function(n){n!==null&&e(n)})}},hr=dr;var _n={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};var cu=typeof URLSearchParams<"u"?URLSearchParams:In;var lu=typeof FormData<"u"?FormData:null;var uu=typeof Blob<"u"?Blob:null;var du={isBrowser:!0,classes:{URLSearchParams:cu,FormData:lu,Blob:uu},protocols:["http","https","file","blob","url","data"]};var pr={};ni(pr,{hasBrowserEnv:()=>fr,hasStandardBrowserEnv:()=>Fh,hasStandardBrowserWebWorkerEnv:()=>Bh,origin:()=>Vh});var fr=typeof window<"u"&&typeof document<"u",Fh=(i=>fr&&["ReactNative","NativeScript","NS"].indexOf(i)<0)(typeof navigator<"u"&&navigator.product),Bh=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Vh=fr&&window.location.href||"http://localhost";var ce=E(E({},pr),du);function mr(i,e){return mt(i,new ce.classes.URLSearchParams,Object.assign({visitor:function(t,n,s,r){return ce.isNode&&S.isBuffer(t)?(this.append(n,t.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},e))}function jh(i){return S.matchAll(/\w+|\[(\w*)]/g,i).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Mh(i){let e={},t=Object.keys(i),n,s=t.length,r;for(n=0;n<s;n++)r=t[n],e[r]=i[r];return e}function $h(i){function e(t,n,s,r){let o=t[r++];if(o==="__proto__")return!0;let a=Number.isFinite(+o),l=r>=t.length;return o=!o&&S.isArray(s)?s.length:o,l?(S.hasOwnProp(s,o)?s[o]=[s[o],n]:s[o]=n,!a):((!s[o]||!S.isObject(s[o]))&&(s[o]=[]),e(t,n,s[o],r)&&S.isArray(s[o])&&(s[o]=Mh(s[o])),!a)}if(S.isFormData(i)&&S.isFunction(i.entries)){let t={};return S.forEachEntry(i,(n,s)=>{e(jh(n),s,t,0)}),t}return null}var Pn=$h;function Wh(i,e,t){if(S.isString(i))try{return(e||JSON.parse)(i),S.trim(i)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(i)}var gr={transitional:_n,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){let n=t.getContentType()||"",s=n.indexOf("application/json")>-1,r=S.isObject(e);if(r&&S.isHTMLForm(e)&&(e=new FormData(e)),S.isFormData(e))return s?JSON.stringify(Pn(e)):e;if(S.isArrayBuffer(e)||S.isBuffer(e)||S.isStream(e)||S.isFile(e)||S.isBlob(e)||S.isReadableStream(e))return e;if(S.isArrayBufferView(e))return e.buffer;if(S.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return mr(e,this.formSerializer).toString();if((a=S.isFileList(e))||n.indexOf("multipart/form-data")>-1){let l=this.env&&this.env.FormData;return mt(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return r||s?(t.setContentType("application/json",!1),Wh(e)):e}],transformResponse:[function(e){let t=this.transitional||gr.transitional,n=t&&t.forcedJSONParsing,s=this.responseType==="json";if(S.isResponse(e)||S.isReadableStream(e))return e;if(e&&S.isString(e)&&(n&&!this.responseType||s)){let o=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?x.from(a,x.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ce.classes.FormData,Blob:ce.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};S.forEach(["delete","get","head","post","put","patch"],i=>{gr.headers[i]={}});var Vt=gr;var Hh=S.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),hu=i=>{let e={},t,n,s;return i&&i.split(`
`).forEach(function(o){s=o.indexOf(":"),t=o.substring(0,s).trim().toLowerCase(),n=o.substring(s+1).trim(),!(!t||e[t]&&Hh[t])&&(t==="set-cookie"?e[t]?e[t].push(n):e[t]=[n]:e[t]=e[t]?e[t]+", "+n:n)}),e};var fu=Symbol("internals");function wi(i){return i&&String(i).trim().toLowerCase()}function Nn(i){return i===!1||i==null?i:S.isArray(i)?i.map(Nn):String(i)}function qh(i){let e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g,n;for(;n=t.exec(i);)e[n[1]]=n[2];return e}var Gh=i=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(i.trim());function br(i,e,t,n,s){if(S.isFunction(n))return n.call(this,e,t);if(s&&(e=t),!!S.isString(e)){if(S.isString(n))return e.indexOf(n)!==-1;if(S.isRegExp(n))return n.test(e)}}function Jh(i){return i.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}function Kh(i,e){let t=S.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(i,n+t,{value:function(s,r,o){return this[n].call(this,e,s,r,o)},configurable:!0})})}var jt=class{constructor(e){e&&this.set(e)}set(e,t,n){let s=this;function r(a,l,c){let u=wi(l);if(!u)throw new Error("header name must be a non-empty string");let h=S.findKey(s,u);(!h||s[h]===void 0||c===!0||c===void 0&&s[h]!==!1)&&(s[h||l]=Nn(a))}let o=(a,l)=>S.forEach(a,(c,u)=>r(c,u,l));if(S.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(S.isString(e)&&(e=e.trim())&&!Gh(e))o(hu(e),t);else if(S.isHeaders(e))for(let[a,l]of e.entries())r(l,a,n);else e!=null&&r(t,e,n);return this}get(e,t){if(e=wi(e),e){let n=S.findKey(this,e);if(n){let s=this[n];if(!t)return s;if(t===!0)return qh(s);if(S.isFunction(t))return t.call(this,s,n);if(S.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=wi(e),e){let n=S.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||br(this,this[n],n,t)))}return!1}delete(e,t){let n=this,s=!1;function r(o){if(o=wi(o),o){let a=S.findKey(n,o);a&&(!t||br(n,n[a],a,t))&&(delete n[a],s=!0)}}return S.isArray(e)?e.forEach(r):r(e),s}clear(e){let t=Object.keys(this),n=t.length,s=!1;for(;n--;){let r=t[n];(!e||br(this,this[r],r,e,!0))&&(delete this[r],s=!0)}return s}normalize(e){let t=this,n={};return S.forEach(this,(s,r)=>{let o=S.findKey(n,r);if(o){t[o]=Nn(s),delete t[r];return}let a=e?Jh(r):String(r).trim();a!==r&&delete t[r],t[a]=Nn(s),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){let t=Object.create(null);return S.forEach(this,(n,s)=>{n!=null&&n!==!1&&(t[s]=e&&S.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){let n=new this(e);return t.forEach(s=>n.set(s)),n}static accessor(e){let n=(this[fu]=this[fu]={accessors:{}}).accessors,s=this.prototype;function r(o){let a=wi(o);n[a]||(Kh(s,o),n[a]=!0)}return S.isArray(e)?e.forEach(r):r(e),this}};jt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);S.reduceDescriptors(jt.prototype,({value:i},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>i,set(n){this[t]=n}}});S.freezeMethods(jt);var ae=jt;function vi(i,e){let t=this||Vt,n=e||t,s=ae.from(n.headers),r=n.data;return S.forEach(i,function(a){r=a.call(t,r,s.normalize(),e?e.status:void 0)}),s.normalize(),r}function Ti(i){return!!(i&&i.__CANCEL__)}function pu(i,e,t){x.call(this,i??"canceled",x.ERR_CANCELED,e,t),this.name="CanceledError"}S.inherits(pu,x,{__CANCEL__:!0});var He=pu;function Ri(i,e,t){let n=t.config.validateStatus;!t.status||!n||n(t.status)?i(t):e(new x("Request failed with status code "+t.status,[x.ERR_BAD_REQUEST,x.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function yr(i){let e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(i);return e&&e[1]||""}function zh(i,e){i=i||10;let t=new Array(i),n=new Array(i),s=0,r=0,o;return e=e!==void 0?e:1e3,function(l){let c=Date.now(),u=n[r];o||(o=c),t[s]=l,n[s]=c;let h=r,d=0;for(;h!==s;)d+=t[h++],h=h%i;if(s=(s+1)%i,s===r&&(r=(r+1)%i),c-o<e)return;let f=u&&c-u;return f?Math.round(d*1e3/f):void 0}}var mu=zh;function Xh(i,e){let t=0,n=1e3/e,s=null;return function(){let o=this===!0,a=Date.now();if(o||a-t>n)return s&&(clearTimeout(s),s=null),t=a,i.apply(null,arguments);s||(s=setTimeout(()=>(s=null,t=Date.now(),i.apply(null,arguments)),n-(a-t)))}}var gu=Xh;var Mt=(i,e,t=3)=>{let n=0,s=mu(50,250);return gu(r=>{let o=r.loaded,a=r.lengthComputable?r.total:void 0,l=o-n,c=s(l),u=o<=a;n=o;let h={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-o)/c:void 0,event:r,lengthComputable:a!=null};h[e?"download":"upload"]=!0,i(h)},t)};var bu=ce.hasStandardBrowserEnv?function(){let e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a"),n;function s(r){let o=r;return e&&(t.setAttribute("href",o),o=t.href),t.setAttribute("href",o),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return n=s(window.location.href),function(o){let a=S.isString(o)?s(o):o;return a.protocol===n.protocol&&a.host===n.host}}():function(){return function(){return!0}}();var yu=ce.hasStandardBrowserEnv?{write(i,e,t,n,s,r){let o=[i+"="+encodeURIComponent(e)];S.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),S.isString(n)&&o.push("path="+n),S.isString(s)&&o.push("domain="+s),r===!0&&o.push("secure"),document.cookie=o.join("; ")},read(i){let e=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(i){this.write(i,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Sr(i){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)}function kr(i,e){return e?i.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):i}function Ei(i,e){return i&&!Sr(e)?kr(i,e):e}var Su=i=>i instanceof ae?E({},i):i;function Le(i,e){e=e||{};let t={};function n(c,u,h){return S.isPlainObject(c)&&S.isPlainObject(u)?S.merge.call({caseless:h},c,u):S.isPlainObject(u)?S.merge({},u):S.isArray(u)?u.slice():u}function s(c,u,h){if(S.isUndefined(u)){if(!S.isUndefined(c))return n(void 0,c,h)}else return n(c,u,h)}function r(c,u){if(!S.isUndefined(u))return n(void 0,u)}function o(c,u){if(S.isUndefined(u)){if(!S.isUndefined(c))return n(void 0,c)}else return n(void 0,u)}function a(c,u,h){if(h in e)return n(c,u);if(h in i)return n(void 0,c)}let l={url:r,method:r,data:r,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u)=>s(Su(c),Su(u),!0)};return S.forEach(Object.keys(Object.assign({},i,e)),function(u){let h=l[u]||s,d=h(i[u],e[u],u);S.isUndefined(d)&&h!==a||(t[u]=d)}),t}var On=i=>{let e=Le({},i),{data:t,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:r,headers:o,auth:a}=e;e.headers=o=ae.from(o),e.url=Ci(Ei(e.baseURL,e.url),i.params,i.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(S.isFormData(t)){if(ce.hasStandardBrowserEnv||ce.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){let[c,...u]=l?l.split(";").map(h=>h.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...u].join("; "))}}if(ce.hasStandardBrowserEnv&&(n&&S.isFunction(n)&&(n=n(e)),n||n!==!1&&bu(e.url))){let c=s&&r&&yu.read(r);c&&o.set(s,c)}return e};var Yh=typeof XMLHttpRequest<"u",ku=Yh&&function(i){return new Promise(function(t,n){let s=On(i),r=s.data,o=ae.from(s.headers).normalize(),{responseType:a}=s,l;function c(){s.cancelToken&&s.cancelToken.unsubscribe(l),s.signal&&s.signal.removeEventListener("abort",l)}let u=new XMLHttpRequest;u.open(s.method.toUpperCase(),s.url,!0),u.timeout=s.timeout;function h(){if(!u)return;let f=ae.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders()),g={data:!a||a==="text"||a==="json"?u.responseText:u.response,status:u.status,statusText:u.statusText,headers:f,config:i,request:u};Ri(function(k){t(k),c()},function(k){n(k),c()},g),u=null}"onloadend"in u?u.onloadend=h:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(h)},u.onabort=function(){u&&(n(new x("Request aborted",x.ECONNABORTED,s,u)),u=null)},u.onerror=function(){n(new x("Network Error",x.ERR_NETWORK,s,u)),u=null},u.ontimeout=function(){let p=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded",g=s.transitional||_n;s.timeoutErrorMessage&&(p=s.timeoutErrorMessage),n(new x(p,g.clarifyTimeoutError?x.ETIMEDOUT:x.ECONNABORTED,s,u)),u=null},r===void 0&&o.setContentType(null),"setRequestHeader"in u&&S.forEach(o.toJSON(),function(p,g){u.setRequestHeader(g,p)}),S.isUndefined(s.withCredentials)||(u.withCredentials=!!s.withCredentials),a&&a!=="json"&&(u.responseType=s.responseType),typeof s.onDownloadProgress=="function"&&u.addEventListener("progress",Mt(s.onDownloadProgress,!0)),typeof s.onUploadProgress=="function"&&u.upload&&u.upload.addEventListener("progress",Mt(s.onUploadProgress)),(s.cancelToken||s.signal)&&(l=f=>{u&&(n(!f||f.type?new He(null,i,u):f),u.abort(),u=null)},s.cancelToken&&s.cancelToken.subscribe(l),s.signal&&(s.signal.aborted?l():s.signal.addEventListener("abort",l)));let d=yr(s.url);if(d&&ce.protocols.indexOf(d)===-1){n(new x("Unsupported protocol "+d+":",x.ERR_BAD_REQUEST,i));return}u.send(r||null)})};var Qh=(i,e)=>{let t=new AbortController,n,s=function(l){if(!n){n=!0,o();let c=l instanceof Error?l:this.reason;t.abort(c instanceof x?c:new He(c instanceof Error?c.message:c))}},r=e&&setTimeout(()=>{s(new x(`timeout ${e} of ms exceeded`,x.ETIMEDOUT))},e),o=()=>{i&&(r&&clearTimeout(r),r=null,i.forEach(l=>{l&&(l.removeEventListener?l.removeEventListener("abort",s):l.unsubscribe(s))}),i=null)};i.forEach(l=>l&&l.addEventListener&&l.addEventListener("abort",s));let{signal:a}=t;return a.unsubscribe=o,[a,()=>{r&&clearTimeout(r),r=null}]},Cu=Qh;var Zh=function*(i,e){let t=i.byteLength;if(!e||t<e){yield i;return}let n=0,s;for(;n<t;)s=n+e,yield i.slice(n,s),n=s},ef=function(i,e,t){return Lc(this,null,function*(){try{for(var n=Bc(i),s,r,o;s=!(r=yield new $i(n.next())).done;s=!1){let a=r.value;yield*Fc(Zh(ArrayBuffer.isView(a)?a:yield new $i(t(String(a))),e))}}catch{o=[r]}finally{try{s&&(r=n.return)&&(yield new $i(r.call(n)))}finally{if(o)throw o[0]}}})},Cr=(i,e,t,n,s)=>{let r=ef(i,e,s),o=0;return new ReadableStream({type:"bytes",pull(l){return b(this,null,function*(){let{done:c,value:u}=yield r.next();if(c){l.close(),n();return}let h=u.byteLength;t&&t(o+=h),l.enqueue(new Uint8Array(u))})},cancel(l){return n(l),r.return()}},{highWaterMark:2})};var wu=(i,e)=>{let t=i!=null;return n=>setTimeout(()=>e({lengthComputable:t,total:i,loaded:n}))},Dn=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Tu=Dn&&typeof ReadableStream=="function",wr=Dn&&(typeof TextEncoder=="function"?(i=>e=>i.encode(e))(new TextEncoder):i=>b(void 0,null,function*(){return new Uint8Array(yield new Response(i).arrayBuffer())})),tf=Tu&&(()=>{let i=!1,e=new Request(ce.origin,{body:new ReadableStream,method:"POST",get duplex(){return i=!0,"half"}}).headers.has("Content-Type");return i&&!e})(),vu=64*1024,vr=Tu&&!!(()=>{try{return S.isReadableStream(new Response("").body)}catch{}})(),xn={stream:vr&&(i=>i.body)};Dn&&(i=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!xn[e]&&(xn[e]=S.isFunction(i[e])?t=>t[e]():(t,n)=>{throw new x(`Response type '${e}' is not supported`,x.ERR_NOT_SUPPORT,n)})})})(new Response);var nf=i=>b(void 0,null,function*(){if(i==null)return 0;if(S.isBlob(i))return i.size;if(S.isSpecCompliantForm(i))return(yield new Request(i).arrayBuffer()).byteLength;if(S.isArrayBufferView(i))return i.byteLength;if(S.isURLSearchParams(i)&&(i=i+""),S.isString(i))return(yield wr(i)).byteLength}),sf=(i,e)=>b(void 0,null,function*(){let t=S.toFiniteNumber(i.getContentLength());return t??nf(e)}),Ru=Dn&&(i=>b(void 0,null,function*(){let{url:e,method:t,data:n,signal:s,cancelToken:r,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:c,headers:u,withCredentials:h="same-origin",fetchOptions:d}=On(i);c=c?(c+"").toLowerCase():"text";let[f,p]=s||r||o?Cu([s,r],o):[],g,v,k=()=>{!g&&setTimeout(()=>{f&&f.unsubscribe()}),g=!0},_;try{if(l&&tf&&t!=="get"&&t!=="head"&&(_=yield sf(u,n))!==0){let $=new Request(e,{method:"POST",body:n,duplex:"half"}),Y;S.isFormData(n)&&(Y=$.headers.get("content-type"))&&u.setContentType(Y),$.body&&(n=Cr($.body,vu,wu(_,Mt(l)),null,wr))}S.isString(h)||(h=h?"cors":"omit"),v=new Request(e,L(E({},d),{signal:f,method:t.toUpperCase(),headers:u.normalize().toJSON(),body:n,duplex:"half",withCredentials:h}));let P=yield fetch(v),A=vr&&(c==="stream"||c==="response");if(vr&&(a||A)){let $={};["status","statusText","headers"].forEach(fe=>{$[fe]=P[fe]});let Y=S.toFiniteNumber(P.headers.get("content-length"));P=new Response(Cr(P.body,vu,a&&wu(Y,Mt(a,!0)),A&&k,wr),$)}c=c||"text";let M=yield xn[S.findKey(xn,c)||"text"](P,i);return!A&&k(),p&&p(),yield new Promise(($,Y)=>{Ri($,Y,{data:M,headers:ae.from(P.headers),status:P.status,statusText:P.statusText,config:i,request:v})})}catch(P){throw k(),P&&P.name==="TypeError"&&/fetch/i.test(P.message)?Object.assign(new x("Network Error",x.ERR_NETWORK,i,v),{cause:P.cause||P}):x.from(P,P&&P.code,i,v)}}));var Tr={http:En,xhr:ku,fetch:Ru};S.forEach(Tr,(i,e)=>{if(i){try{Object.defineProperty(i,"name",{value:e})}catch{}Object.defineProperty(i,"adapterName",{value:e})}});var Eu=i=>`- ${i}`,rf=i=>S.isFunction(i)||i===null||i===!1,An={getAdapter:i=>{i=S.isArray(i)?i:[i];let{length:e}=i,t,n,s={};for(let r=0;r<e;r++){t=i[r];let o;if(n=t,!rf(t)&&(n=Tr[(o=String(t)).toLowerCase()],n===void 0))throw new x(`Unknown adapter '${o}'`);if(n)break;s[o||"#"+r]=n}if(!n){let r=Object.entries(s).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build")),o=e?r.length>1?`since :
`+r.map(Eu).join(`
`):" "+Eu(r[0]):"as no adapter specified";throw new x("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:Tr};function Rr(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new He(null,i)}function Un(i){return Rr(i),i.headers=ae.from(i.headers),i.data=vi.call(i,i.transformRequest),["post","put","patch"].indexOf(i.method)!==-1&&i.headers.setContentType("application/x-www-form-urlencoded",!1),An.getAdapter(i.adapter||Vt.adapter)(i).then(function(n){return Rr(i),n.data=vi.call(i,i.transformResponse,n),n.headers=ae.from(n.headers),n},function(n){return Ti(n)||(Rr(i),n&&n.response&&(n.response.data=vi.call(i,i.transformResponse,n.response),n.response.headers=ae.from(n.response.headers))),Promise.reject(n)})}var Ln="1.7.2";var Er={};["object","boolean","number","function","string","symbol"].forEach((i,e)=>{Er[i]=function(n){return typeof n===i||"a"+(e<1?"n ":" ")+i}});var Iu={};Er.transitional=function(e,t,n){function s(r,o){return"[Axios v"+Ln+"] Transitional option '"+r+"'"+o+(n?". "+n:"")}return(r,o,a)=>{if(e===!1)throw new x(s(o," has been removed"+(t?" in "+t:"")),x.ERR_DEPRECATED);return t&&!Iu[o]&&(Iu[o]=!0,console.warn(s(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(r,o,a):!0}};function af(i,e,t){if(typeof i!="object")throw new x("options must be an object",x.ERR_BAD_OPTION_VALUE);let n=Object.keys(i),s=n.length;for(;s-- >0;){let r=n[s],o=e[r];if(o){let a=i[r],l=a===void 0||o(a,r,i);if(l!==!0)throw new x("option "+r+" must be "+l,x.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new x("Unknown option "+r,x.ERR_BAD_OPTION)}}var Fn={assertOptions:af,validators:Er};var gt=Fn.validators,$t=class{constructor(e){this.defaults=e,this.interceptors={request:new hr,response:new hr}}request(e,t){return b(this,null,function*(){try{return yield this._request(e,t)}catch(n){if(n instanceof Error){let s;Error.captureStackTrace?Error.captureStackTrace(s={}):s=new Error;let r=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?r&&!String(n.stack).endsWith(r.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+r):n.stack=r}catch{}}throw n}})}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Le(this.defaults,t);let{transitional:n,paramsSerializer:s,headers:r}=t;n!==void 0&&Fn.assertOptions(n,{silentJSONParsing:gt.transitional(gt.boolean),forcedJSONParsing:gt.transitional(gt.boolean),clarifyTimeoutError:gt.transitional(gt.boolean)},!1),s!=null&&(S.isFunction(s)?t.paramsSerializer={serialize:s}:Fn.assertOptions(s,{encode:gt.function,serialize:gt.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=r&&S.merge(r.common,r[t.method]);r&&S.forEach(["delete","get","head","post","put","patch","common"],p=>{delete r[p]}),t.headers=ae.concat(o,r);let a=[],l=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(t)===!1||(l=l&&g.synchronous,a.unshift(g.fulfilled,g.rejected))});let c=[];this.interceptors.response.forEach(function(g){c.push(g.fulfilled,g.rejected)});let u,h=0,d;if(!l){let p=[Un.bind(this),void 0];for(p.unshift.apply(p,a),p.push.apply(p,c),d=p.length,u=Promise.resolve(t);h<d;)u=u.then(p[h++],p[h++]);return u}d=a.length;let f=t;for(h=0;h<d;){let p=a[h++],g=a[h++];try{f=p(f)}catch(v){g.call(this,v);break}}try{u=Un.call(this,f)}catch(p){return Promise.reject(p)}for(h=0,d=c.length;h<d;)u=u.then(c[h++],c[h++]);return u}getUri(e){e=Le(this.defaults,e);let t=Ei(e.baseURL,e.url);return Ci(t,e.params,e.paramsSerializer)}};S.forEach(["delete","get","head","options"],function(e){$t.prototype[e]=function(t,n){return this.request(Le(n||{},{method:e,url:t,data:(n||{}).data}))}});S.forEach(["post","put","patch"],function(e){function t(n){return function(r,o,a){return this.request(Le(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:r,data:o}))}}$t.prototype[e]=t(),$t.prototype[e+"Form"]=t(!0)});var Ii=$t;var Ir=class i{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(r){t=r});let n=this;this.promise.then(s=>{if(!n._listeners)return;let r=n._listeners.length;for(;r-- >0;)n._listeners[r](s);n._listeners=null}),this.promise.then=s=>{let r,o=new Promise(a=>{n.subscribe(a),r=a}).then(s);return o.cancel=function(){n.unsubscribe(r)},o},e(function(r,o,a){n.reason||(n.reason=new He(r,o,a),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;let t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}static source(){let e;return{token:new i(function(s){e=s}),cancel:e}}},_u=Ir;function _r(i){return function(t){return i.apply(null,t)}}function Pr(i){return S.isObject(i)&&i.isAxiosError===!0}var Nr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Nr).forEach(([i,e])=>{Nr[e]=i});var Pu=Nr;function Nu(i){let e=new Ii(i),t=yi(Ii.prototype.request,e);return S.extend(t,Ii.prototype,e,{allOwnKeys:!0}),S.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return Nu(Le(i,s))},t}var se=Nu(Vt);se.Axios=Ii;se.CanceledError=He;se.CancelToken=_u;se.isCancel=Ti;se.VERSION=Ln;se.toFormData=mt;se.AxiosError=x;se.Cancel=se.CanceledError;se.all=function(e){return Promise.all(e)};se.spread=_r;se.isAxiosError=Pr;se.mergeConfig=Le;se.AxiosHeaders=ae;se.formToJSON=i=>Pn(S.isHTMLForm(i)?new FormData(i):i);se.getAdapter=An.getAdapter;se.HttpStatusCode=Pu;se.default=se;var Ct=se;var{Axios:sC,AxiosError:rC,CanceledError:aC,isCancel:oC,CancelToken:cC,VERSION:lC,all:uC,Cancel:dC,isAxiosError:hC,spread:fC,toFormData:pC,AxiosHeaders:Ou,HttpStatusCode:mC,formToJSON:gC,getAdapter:bC,mergeConfig:yC}=Ct;var ee=function(i){return i[i.cancelled=0]="cancelled",i[i.unknown=1]="unknown",i[i.invalid_argument=2]="invalid_argument",i[i.malformed=3]="malformed",i[i.deadline_exceeded=4]="deadline_exceeded",i[i.not_found=5]="not_found",i[i.bad_route=6]="bad_route",i[i.already_exists=7]="already_exists",i[i.permission_denied=8]="permission_denied",i[i.unauthenticated=9]="unauthenticated",i[i.resource_exhausted=10]="resource_exhausted",i[i.failed_precondition=11]="failed_precondition",i[i.aborted=12]="aborted",i[i.out_of_range=13]="out_of_range",i[i.unimplemented=14]="unimplemented",i[i.internal=15]="internal",i[i.unavailable=16]="unavailable",i[i.dataloss=17]="dataloss",i}(ee||{});function xu(i,e,t){if(t)for(let[n,s]of Object.entries(t))if(typeof s=="string")i.append(n,s);else for(let r of s)i.append(n,r);return i.set("Content-Type",e?"application/json":"application/protobuf"),i.set("Accept",e?"application/json":"application/protobuf, application/json"),i}function Du(i){if(!dt(i)||typeof i.code!="string"||typeof i.msg!="string")return new oe("cannot read twirp error response",ee[ee.internal]);let e={};if(dt(i.meta))for(let[t,n]of Object.entries(i.meta))typeof n=="string"&&(e[t]=n);return new oe(i.msg,i.code,e)}function Au(i){let e={};return i.forEach((t,n)=>{n.toLowerCase()!=="content-type"&&n.toLowerCase()!=="content-length"&&(e.hasOwnProperty(n)?e[n].push(t):e[n]=t)}),e}var _i=class{constructor(e){this.defaultOptions=e}mergeOptions(e){return ar(this.defaultOptions,e)}unary(e,t,n){var s,r,o;let a=n,l=this.makeUrl(e,a),c=(s=a.fetchInit)!==null&&s!==void 0?s:{},u=a.sendJson?e.I.toJsonString(t,a.jsonOptions):e.I.toBinary(t,a.binaryOptions),h=new pt,d=new pt,f=new pt,p=new pt;return globalThis.fetch(l,Object.assign(Object.assign({},c),{method:"POST",headers:xu(new globalThis.Headers,!!a.sendJson,a.meta),body:u,signal:(r=n.abort)!==null&&r!==void 0?r:null})).then(g=>{h.resolve(Au(g.headers));let v;try{v=g.type}catch{}switch(v){case"error":case"opaque":case"opaqueredirect":throw new oe(`fetch response type ${g.type}`,ee[ee.unknown])}return g.ok?a.sendJson?g.json().then(k=>e.O.fromJson(k,a.jsonOptions),()=>{throw new oe("unable to read response body as json",ee[ee.dataloss])}):g.arrayBuffer().then(k=>e.O.fromBinary(new Uint8Array(k),a.binaryOptions),()=>{throw new oe("unable to read response body",ee[ee.dataloss])}):g.json().then(k=>{throw Du(k)},()=>{throw new oe("received HTTP "+g.status+", unable to read response body as json",ee[ee.internal])})},g=>{throw g instanceof Error&&g.name==="AbortError"?new oe(g.message,ee[ee.cancelled]):new oe(g instanceof Error?g.message:g)}).then(g=>{d.resolve(g),f.resolve({code:"OK",detail:""}),p.resolve({})}).catch(g=>{let v=g instanceof oe?g:new oe(g instanceof Error?g.message:g,ee[ee.internal]);v.methodName=e.name,v.serviceName=e.service.typeName,h.rejectPending(v),d.rejectPending(v),f.rejectPending(v),p.rejectPending(v)}),new bi(e,(o=a.meta)!==null&&o!==void 0?o:{},t,h.promise,d.promise,f.promise,p.promise)}makeUrl(e,t){let n=t.baseUrl;n.endsWith("/")&&(n=n.substring(0,n.length-1));let s=e.name;return t.useProtoMethodName!==!0&&(s=ft(s),s=s.substring(0,1).toUpperCase()+s.substring(1)),`${n}/${e.service.typeName}/${s}`}clientStreaming(e){let t=new oe("Client streaming is not supported by Twirp",ee[ee.unimplemented]);throw t.methodName=e.name,t.serviceName=e.service.typeName,t}duplex(e){let t=new oe("Duplex streaming is not supported by Twirp",ee[ee.unimplemented]);throw t.methodName=e.name,t.serviceName=e.service.typeName,t}serverStreaming(e){let t=new oe("Server streaming is not supported by Twirp",ee[ee.unimplemented]);throw t.methodName=e.name,t.serviceName=e.service.typeName,t}};var Fi=si($u()),ld=si(Wu());var Ht=null;typeof WebSocket<"u"?Ht=WebSocket:typeof MozWebSocket<"u"?Ht=MozWebSocket:typeof global<"u"?Ht=global.WebSocket||global.MozWebSocket:typeof window<"u"?Ht=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(Ht=self.WebSocket||self.MozWebSocket);var Dr=Ht;var ud=si(Gu());var Ur={AVAILABLE:"available",DISABLED:"disabled",AUTO_ON:"auto-on"},xe={BLOCK_USERS:"block-users",CHANGE_MAX_DURATION:"change-max-duration",CREATE_CALL:"create-call",CREATE_REACTION:"create-reaction",ENABLE_NOISE_CANCELLATION:"enable-noise-cancellation",END_CALL:"end-call",JOIN_BACKSTAGE:"join-backstage",JOIN_CALL:"join-call",JOIN_ENDED_CALL:"join-ended-call",MUTE_USERS:"mute-users",PIN_FOR_EVERYONE:"pin-for-everyone",READ_CALL:"read-call",REMOVE_CALL_MEMBER:"remove-call-member",SCREENSHARE:"screenshare",SEND_AUDIO:"send-audio",SEND_VIDEO:"send-video",START_BROADCAST_CALL:"start-broadcast-call",START_RECORD_CALL:"start-record-call",START_TRANSCRIPTION_CALL:"start-transcription-call",STOP_BROADCAST_CALL:"stop-broadcast-call",STOP_RECORD_CALL:"stop-record-call",STOP_TRANSCRIPTION_CALL:"stop-transcription-call",UPDATE_CALL:"update-call",UPDATE_CALL_MEMBER:"update-call-member",UPDATE_CALL_PERMISSIONS:"update-call-permissions",UPDATE_CALL_SETTINGS:"update-call-settings"};var wa=class extends Error{},va=function(i){return i[i.NULL_VALUE=0]="NULL_VALUE",i}(va||{}),Ta=class extends I{constructor(){super("google.protobuf.Struct",[{no:1,name:"fields",kind:"map",K:9,V:{kind:"message",T:()=>Fe}}])}internalJsonWrite(e,t){let n={};for(let[s,r]of Object.entries(e.fields))n[s]=Fe.toJson(r);return n}internalJsonRead(e,t,n){if(!dt(e))throw new globalThis.Error("Unable to parse message "+this.typeName+" from JSON "+We(e)+".");n||(n=this.create());for(let[s,r]of globalThis.Object.entries(e))n.fields[s]=Fe.fromJson(r);return n}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.fields={},e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:this.binaryReadMap1(r.fields,e,n);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}binaryReadMap1(e,t,n){let s=t.uint32(),r=t.pos+s,o,a;for(;t.pos<r;){let[l,c]=t.tag();switch(l){case 1:o=t.string();break;case 2:a=Fe.internalBinaryRead(t,t.uint32(),n);break;default:throw new globalThis.Error("unknown map entry field for field google.protobuf.Struct.fields")}}e[o??""]=a??Fe.create()}internalBinaryWrite(e,t,n){for(let r of globalThis.Object.keys(e.fields))t.tag(1,m.LengthDelimited).fork().tag(1,m.LengthDelimited).string(r),t.tag(2,m.LengthDelimited).fork(),Fe.internalBinaryWrite(e.fields[r],t,n),t.join().join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Ge=new Ta,Ra=class extends I{constructor(){super("google.protobuf.Value",[{no:1,name:"null_value",kind:"enum",oneof:"kind",T:()=>["google.protobuf.NullValue",va]},{no:2,name:"number_value",kind:"scalar",oneof:"kind",T:1},{no:3,name:"string_value",kind:"scalar",oneof:"kind",T:9},{no:4,name:"bool_value",kind:"scalar",oneof:"kind",T:8},{no:5,name:"struct_value",kind:"message",oneof:"kind",T:()=>Ge},{no:6,name:"list_value",kind:"message",oneof:"kind",T:()=>jn}])}internalJsonWrite(e,t){if(e.kind.oneofKind===void 0)throw new globalThis.Error;switch(e.kind.oneofKind){case void 0:throw new globalThis.Error;case"boolValue":return e.kind.boolValue;case"nullValue":return null;case"numberValue":let n=e.kind.numberValue;if(typeof n=="number"&&!Number.isFinite(n))throw new globalThis.Error;return n;case"stringValue":return e.kind.stringValue;case"listValue":let s=this.fields.find(o=>o.no===6);if(s?.kind!=="message")throw new globalThis.Error;return s.T().toJson(e.kind.listValue);case"structValue":let r=this.fields.find(o=>o.no===5);if(r?.kind!=="message")throw new globalThis.Error;return r.T().toJson(e.kind.structValue)}}internalJsonRead(e,t,n){switch(n||(n=this.create()),typeof e){case"number":n.kind={oneofKind:"numberValue",numberValue:e};break;case"string":n.kind={oneofKind:"stringValue",stringValue:e};break;case"boolean":n.kind={oneofKind:"boolValue",boolValue:e};break;case"object":e===null?n.kind={oneofKind:"nullValue",nullValue:va.NULL_VALUE}:globalThis.Array.isArray(e)?n.kind={oneofKind:"listValue",listValue:jn.fromJson(e)}:n.kind={oneofKind:"structValue",structValue:Ge.fromJson(e)};break;default:throw new globalThis.Error("Unable to parse "+this.typeName+" from JSON "+We(e))}return n}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.kind={oneofKind:void 0},e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.kind={oneofKind:"nullValue",nullValue:e.int32()};break;case 2:r.kind={oneofKind:"numberValue",numberValue:e.double()};break;case 3:r.kind={oneofKind:"stringValue",stringValue:e.string()};break;case 4:r.kind={oneofKind:"boolValue",boolValue:e.bool()};break;case 5:r.kind={oneofKind:"structValue",structValue:Ge.internalBinaryRead(e,e.uint32(),n,r.kind.structValue)};break;case 6:r.kind={oneofKind:"listValue",listValue:jn.internalBinaryRead(e,e.uint32(),n,r.kind.listValue)};break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.kind.oneofKind==="nullValue"&&t.tag(1,m.Varint).int32(e.kind.nullValue),e.kind.oneofKind==="numberValue"&&t.tag(2,m.Bit64).double(e.kind.numberValue),e.kind.oneofKind==="stringValue"&&t.tag(3,m.LengthDelimited).string(e.kind.stringValue),e.kind.oneofKind==="boolValue"&&t.tag(4,m.Varint).bool(e.kind.boolValue),e.kind.oneofKind==="structValue"&&Ge.internalBinaryWrite(e.kind.structValue,t.tag(5,m.LengthDelimited).fork(),n).join(),e.kind.oneofKind==="listValue"&&jn.internalBinaryWrite(e.kind.listValue,t.tag(6,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Fe=new Ra,Ea=class extends I{constructor(){super("google.protobuf.ListValue",[{no:1,name:"values",kind:"message",repeat:1,T:()=>Fe}])}internalJsonWrite(e,t){return e.values.map(n=>Fe.toJson(n))}internalJsonRead(e,t,n){if(!globalThis.Array.isArray(e))throw new globalThis.Error("Unable to parse "+this.typeName+" from JSON "+We(e));n||(n=this.create());let s=e.map(r=>Fe.fromJson(r));return n.values.push(...s),n}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.values=[],e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.values.push(Fe.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){for(let r=0;r<e.values.length;r++)Fe.internalBinaryWrite(e.values[r],t.tag(1,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},jn=new Ea,Ia=class extends I{constructor(){super("google.protobuf.Timestamp",[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}])}now(){let e=this.create(),t=Date.now();return e.seconds=H.from(Math.floor(t/1e3)).toString(),e.nanos=t%1e3*1e6,e}toDate(e){return new Date(H.from(e.seconds).toNumber()*1e3+Math.ceil(e.nanos/1e6))}fromDate(e){let t=this.create(),n=e.getTime();return t.seconds=H.from(Math.floor(n/1e3)).toString(),t.nanos=n%1e3*1e6,t}internalJsonWrite(e,t){let n=H.from(e.seconds).toNumber()*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("Unable to encode Timestamp to JSON. Must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive.");if(e.nanos<0)throw new Error("Unable to encode invalid Timestamp to JSON. Nanos must not be negative.");let s="Z";if(e.nanos>0){let r=(e.nanos+1e9).toString().substring(1);r.substring(3)==="000000"?s="."+r.substring(0,3)+"Z":r.substring(6)==="000"?s="."+r.substring(0,6)+"Z":s="."+r+"Z"}return new Date(n).toISOString().replace(".000Z",s)}internalJsonRead(e,t,n){if(typeof e!="string")throw new Error("Unable to parse Timestamp from JSON "+We(e)+".");let s=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!s)throw new Error("Unable to parse Timestamp from JSON. Invalid format.");let r=Date.parse(s[1]+"-"+s[2]+"-"+s[3]+"T"+s[4]+":"+s[5]+":"+s[6]+(s[8]?s[8]:"Z"));if(Number.isNaN(r))throw new Error("Unable to parse Timestamp from JSON. Invalid value.");if(r<Date.parse("0001-01-01T00:00:00Z")||r>Date.parse("9999-12-31T23:59:59Z"))throw new globalThis.Error("Unable to parse Timestamp from JSON. Must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive.");return n||(n=this.create()),n.seconds=H.from(r/1e3).toString(),n.nanos=0,s[7]&&(n.nanos=parseInt("1"+s[7]+"0".repeat(9-s[7].length))-1e9),n}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.seconds="0",t.nanos=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.seconds=e.int64().toString();break;case 2:r.nanos=e.int32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.seconds!=="0"&&t.tag(1,m.Varint).int64(e.seconds),e.nanos!==0&&t.tag(2,m.Varint).int32(e.nanos);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},_e=new Ia,Ee=function(i){return i[i.PUBLISHER_UNSPECIFIED=0]="PUBLISHER_UNSPECIFIED",i[i.SUBSCRIBER=1]="SUBSCRIBER",i}(Ee||{}),Cc=function(i){return i[i.UNSPECIFIED=0]="UNSPECIFIED",i[i.POOR=1]="POOR",i[i.GOOD=2]="GOOD",i[i.EXCELLENT=3]="EXCELLENT",i}(Cc||{}),Gt=function(i){return i[i.LOW_UNSPECIFIED=0]="LOW_UNSPECIFIED",i[i.MID=1]="MID",i[i.HIGH=2]="HIGH",i[i.OFF=3]="OFF",i}(Gt||{}),T=function(i){return i[i.UNSPECIFIED=0]="UNSPECIFIED",i[i.AUDIO=1]="AUDIO",i[i.VIDEO=2]="VIDEO",i[i.SCREEN_SHARE=3]="SCREEN_SHARE",i[i.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO",i}(T||{}),es=function(i){return i[i.UNSPECIFIED=0]="UNSPECIFIED",i[i.PUBLISH_TRACK_NOT_FOUND=100]="PUBLISH_TRACK_NOT_FOUND",i[i.PUBLISH_TRACKS_MISMATCH=101]="PUBLISH_TRACKS_MISMATCH",i[i.PUBLISH_TRACK_OUT_OF_ORDER=102]="PUBLISH_TRACK_OUT_OF_ORDER",i[i.PUBLISH_TRACK_VIDEO_LAYER_NOT_FOUND=103]="PUBLISH_TRACK_VIDEO_LAYER_NOT_FOUND",i[i.LIVE_ENDED=104]="LIVE_ENDED",i[i.PARTICIPANT_NOT_FOUND=200]="PARTICIPANT_NOT_FOUND",i[i.PARTICIPANT_MIGRATING_OUT=201]="PARTICIPANT_MIGRATING_OUT",i[i.PARTICIPANT_MIGRATION_FAILED=202]="PARTICIPANT_MIGRATION_FAILED",i[i.PARTICIPANT_MIGRATING=203]="PARTICIPANT_MIGRATING",i[i.PARTICIPANT_RECONNECT_FAILED=204]="PARTICIPANT_RECONNECT_FAILED",i[i.PARTICIPANT_MEDIA_TRANSPORT_FAILURE=205]="PARTICIPANT_MEDIA_TRANSPORT_FAILURE",i[i.CALL_NOT_FOUND=300]="CALL_NOT_FOUND",i[i.REQUEST_VALIDATION_FAILED=400]="REQUEST_VALIDATION_FAILED",i[i.UNAUTHENTICATED=401]="UNAUTHENTICATED",i[i.PERMISSION_DENIED=403]="PERMISSION_DENIED",i[i.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",i[i.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",i[i.SFU_SHUTTING_DOWN=600]="SFU_SHUTTING_DOWN",i[i.SFU_FULL=700]="SFU_FULL",i}(es||{}),Di=function(i){return i[i.UNSPECIFIED=0]="UNSPECIFIED",i[i.REACT=1]="REACT",i[i.ANGULAR=2]="ANGULAR",i[i.ANDROID=3]="ANDROID",i[i.IOS=4]="IOS",i[i.FLUTTER=5]="FLUTTER",i[i.REACT_NATIVE=6]="REACT_NATIVE",i[i.UNITY=7]="UNITY",i}(Di||{}),wc=function(i){return i[i.UNSPECIFIED=0]="UNSPECIFIED",i[i.USER_MUTED=1]="USER_MUTED",i[i.PERMISSION_REVOKED=2]="PERMISSION_REVOKED",i[i.MODERATION=3]="MODERATION",i}(wc||{}),Gn=function(i){return i[i.UNSPECIFIED=0]="UNSPECIFIED",i[i.SHUTTING_DOWN=1]="SHUTTING_DOWN",i[i.REBALANCE=2]="REBALANCE",i}(Gn||{}),dd=function(i){return i[i.UNSPECIFIED=0]="UNSPECIFIED",i[i.ENDED=1]="ENDED",i[i.LIVE_ENDED=2]="LIVE_ENDED",i[i.KICKED=3]="KICKED",i}(dd||{}),hd=function(i){return i[i.UNSPECIFIED=0]="UNSPECIFIED",i[i.DISCONNECT=1]="DISCONNECT",i[i.FAST=2]="FAST",i[i.CLEAN=3]="CLEAN",i[i.FULL=4]="FULL",i[i.MIGRATE=5]="MIGRATE",i}(hd||{}),_a=class extends I{constructor(){super("stream.video.sfu.models.CallState",[{no:1,name:"participants",kind:"message",repeat:1,T:()=>de},{no:2,name:"started_at",kind:"message",T:()=>_e},{no:3,name:"participant_count",kind:"message",T:()=>Jt},{no:4,name:"pins",kind:"message",repeat:1,T:()=>Kt}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.participants=[],t.pins=[],e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.participants.push(de.internalBinaryRead(e,e.uint32(),n));break;case 2:r.startedAt=_e.internalBinaryRead(e,e.uint32(),n,r.startedAt);break;case 3:r.participantCount=Jt.internalBinaryRead(e,e.uint32(),n,r.participantCount);break;case 4:r.pins.push(Kt.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){for(let r=0;r<e.participants.length;r++)de.internalBinaryWrite(e.participants[r],t.tag(1,m.LengthDelimited).fork(),n).join();e.startedAt&&_e.internalBinaryWrite(e.startedAt,t.tag(2,m.LengthDelimited).fork(),n).join(),e.participantCount&&Jt.internalBinaryWrite(e.participantCount,t.tag(3,m.LengthDelimited).fork(),n).join();for(let r=0;r<e.pins.length;r++)Kt.internalBinaryWrite(e.pins[r],t.tag(4,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Lr=new _a,Pa=class extends I{constructor(){super("stream.video.sfu.models.ParticipantCount",[{no:1,name:"total",kind:"scalar",T:13},{no:2,name:"anonymous",kind:"scalar",T:13}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.total=0,t.anonymous=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.total=e.uint32();break;case 2:r.anonymous=e.uint32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.total!==0&&t.tag(1,m.Varint).uint32(e.total),e.anonymous!==0&&t.tag(2,m.Varint).uint32(e.anonymous);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Jt=new Pa,Na=class extends I{constructor(){super("stream.video.sfu.models.Pin",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.userId="",t.sessionId="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.userId=e.string();break;case 2:r.sessionId=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.userId!==""&&t.tag(1,m.LengthDelimited).string(e.userId),e.sessionId!==""&&t.tag(2,m.LengthDelimited).string(e.sessionId);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Kt=new Na,Oa=class extends I{constructor(){super("stream.video.sfu.models.Participant",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"published_tracks",kind:"enum",repeat:1,T:()=>["stream.video.sfu.models.TrackType",T,"TRACK_TYPE_"]},{no:4,name:"joined_at",kind:"message",T:()=>_e},{no:5,name:"track_lookup_prefix",kind:"scalar",T:9},{no:6,name:"connection_quality",kind:"enum",T:()=>["stream.video.sfu.models.ConnectionQuality",Cc,"CONNECTION_QUALITY_"]},{no:7,name:"is_speaking",kind:"scalar",T:8},{no:8,name:"is_dominant_speaker",kind:"scalar",T:8},{no:9,name:"audio_level",kind:"scalar",T:2},{no:10,name:"name",kind:"scalar",T:9},{no:11,name:"image",kind:"scalar",T:9},{no:12,name:"custom",kind:"message",T:()=>Ge},{no:13,name:"roles",kind:"scalar",repeat:2,T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.userId="",t.sessionId="",t.publishedTracks=[],t.trackLookupPrefix="",t.connectionQuality=0,t.isSpeaking=!1,t.isDominantSpeaker=!1,t.audioLevel=0,t.name="",t.image="",t.roles=[],e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.userId=e.string();break;case 2:r.sessionId=e.string();break;case 3:if(l===m.LengthDelimited)for(let h=e.int32()+e.pos;e.pos<h;)r.publishedTracks.push(e.int32());else r.publishedTracks.push(e.int32());break;case 4:r.joinedAt=_e.internalBinaryRead(e,e.uint32(),n,r.joinedAt);break;case 5:r.trackLookupPrefix=e.string();break;case 6:r.connectionQuality=e.int32();break;case 7:r.isSpeaking=e.bool();break;case 8:r.isDominantSpeaker=e.bool();break;case 9:r.audioLevel=e.float();break;case 10:r.name=e.string();break;case 11:r.image=e.string();break;case 12:r.custom=Ge.internalBinaryRead(e,e.uint32(),n,r.custom);break;case 13:r.roles.push(e.string());break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){if(e.userId!==""&&t.tag(1,m.LengthDelimited).string(e.userId),e.sessionId!==""&&t.tag(2,m.LengthDelimited).string(e.sessionId),e.publishedTracks.length){t.tag(3,m.LengthDelimited).fork();for(let r=0;r<e.publishedTracks.length;r++)t.int32(e.publishedTracks[r]);t.join()}e.joinedAt&&_e.internalBinaryWrite(e.joinedAt,t.tag(4,m.LengthDelimited).fork(),n).join(),e.trackLookupPrefix!==""&&t.tag(5,m.LengthDelimited).string(e.trackLookupPrefix),e.connectionQuality!==0&&t.tag(6,m.Varint).int32(e.connectionQuality),e.isSpeaking!==!1&&t.tag(7,m.Varint).bool(e.isSpeaking),e.isDominantSpeaker!==!1&&t.tag(8,m.Varint).bool(e.isDominantSpeaker),e.audioLevel!==0&&t.tag(9,m.Bit32).float(e.audioLevel),e.name!==""&&t.tag(10,m.LengthDelimited).string(e.name),e.image!==""&&t.tag(11,m.LengthDelimited).string(e.image),e.custom&&Ge.internalBinaryWrite(e.custom,t.tag(12,m.LengthDelimited).fork(),n).join();for(let r=0;r<e.roles.length;r++)t.tag(13,m.LengthDelimited).string(e.roles[r]);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},de=new Oa,xa=class extends I{constructor(){super("stream.video.sfu.models.StreamQuality",[{no:1,name:"video_quality",kind:"enum",T:()=>["stream.video.sfu.models.VideoQuality",Gt,"VIDEO_QUALITY_"]},{no:2,name:"user_id",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.videoQuality=0,t.userId="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.videoQuality=e.int32();break;case 2:r.userId=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.videoQuality!==0&&t.tag(1,m.Varint).int32(e.videoQuality),e.userId!==""&&t.tag(2,m.LengthDelimited).string(e.userId);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},qC=new xa,Da=class extends I{constructor(){super("stream.video.sfu.models.VideoDimension",[{no:1,name:"width",kind:"scalar",T:13},{no:2,name:"height",kind:"scalar",T:13}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.width=0,t.height=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.width=e.uint32();break;case 2:r.height=e.uint32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.width!==0&&t.tag(1,m.Varint).uint32(e.width),e.height!==0&&t.tag(2,m.Varint).uint32(e.height);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},zt=new Da,Aa=class extends I{constructor(){super("stream.video.sfu.models.VideoLayer",[{no:1,name:"rid",kind:"scalar",T:9},{no:2,name:"video_dimension",kind:"message",T:()=>zt},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"fps",kind:"scalar",T:13},{no:6,name:"quality",kind:"enum",T:()=>["stream.video.sfu.models.VideoQuality",Gt,"VIDEO_QUALITY_"]}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.rid="",t.bitrate=0,t.fps=0,t.quality=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.rid=e.string();break;case 2:r.videoDimension=zt.internalBinaryRead(e,e.uint32(),n,r.videoDimension);break;case 4:r.bitrate=e.uint32();break;case 5:r.fps=e.uint32();break;case 6:r.quality=e.int32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.rid!==""&&t.tag(1,m.LengthDelimited).string(e.rid),e.videoDimension&&zt.internalBinaryWrite(e.videoDimension,t.tag(2,m.LengthDelimited).fork(),n).join(),e.bitrate!==0&&t.tag(4,m.Varint).uint32(e.bitrate),e.fps!==0&&t.tag(5,m.Varint).uint32(e.fps),e.quality!==0&&t.tag(6,m.Varint).int32(e.quality);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Fr=new Aa,Ua=class extends I{constructor(){super("stream.video.sfu.models.Codec",[{no:1,name:"payload_type",kind:"scalar",T:13},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"fmtp_line",kind:"scalar",T:9},{no:4,name:"clock_rate",kind:"scalar",T:13},{no:5,name:"encoding_parameters",kind:"scalar",T:9},{no:6,name:"feedbacks",kind:"scalar",repeat:2,T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.payloadType=0,t.name="",t.fmtpLine="",t.clockRate=0,t.encodingParameters="",t.feedbacks=[],e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.payloadType=e.uint32();break;case 2:r.name=e.string();break;case 3:r.fmtpLine=e.string();break;case 4:r.clockRate=e.uint32();break;case 5:r.encodingParameters=e.string();break;case 6:r.feedbacks.push(e.string());break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.payloadType!==0&&t.tag(1,m.Varint).uint32(e.payloadType),e.name!==""&&t.tag(2,m.LengthDelimited).string(e.name),e.fmtpLine!==""&&t.tag(3,m.LengthDelimited).string(e.fmtpLine),e.clockRate!==0&&t.tag(4,m.Varint).uint32(e.clockRate),e.encodingParameters!==""&&t.tag(5,m.LengthDelimited).string(e.encodingParameters);for(let r=0;r<e.feedbacks.length;r++)t.tag(6,m.LengthDelimited).string(e.feedbacks[r]);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},rt=new Ua,wf=class extends I{constructor(){super("stream.video.sfu.models.ICETrickle",[{no:1,name:"peer_type",kind:"enum",T:()=>["stream.video.sfu.models.PeerType",Ee,"PEER_TYPE_"]},{no:2,name:"ice_candidate",kind:"scalar",T:9},{no:3,name:"session_id",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.peerType=0,t.iceCandidate="",t.sessionId="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.peerType=e.int32();break;case 2:r.iceCandidate=e.string();break;case 3:r.sessionId=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.peerType!==0&&t.tag(1,m.Varint).int32(e.peerType),e.iceCandidate!==""&&t.tag(2,m.LengthDelimited).string(e.iceCandidate),e.sessionId!==""&&t.tag(3,m.LengthDelimited).string(e.sessionId);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Hn=new wf,La=class extends I{constructor(){super("stream.video.sfu.models.TrackInfo",[{no:1,name:"track_id",kind:"scalar",T:9},{no:2,name:"track_type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",T,"TRACK_TYPE_"]},{no:5,name:"layers",kind:"message",repeat:1,T:()=>Fr},{no:6,name:"mid",kind:"scalar",T:9},{no:7,name:"dtx",kind:"scalar",T:8},{no:8,name:"stereo",kind:"scalar",T:8},{no:9,name:"red",kind:"scalar",T:8}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.trackId="",t.trackType=0,t.layers=[],t.mid="",t.dtx=!1,t.stereo=!1,t.red=!1,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.trackId=e.string();break;case 2:r.trackType=e.int32();break;case 5:r.layers.push(Fr.internalBinaryRead(e,e.uint32(),n));break;case 6:r.mid=e.string();break;case 7:r.dtx=e.bool();break;case 8:r.stereo=e.bool();break;case 9:r.red=e.bool();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.trackId!==""&&t.tag(1,m.LengthDelimited).string(e.trackId),e.trackType!==0&&t.tag(2,m.Varint).int32(e.trackType);for(let r=0;r<e.layers.length;r++)Fr.internalBinaryWrite(e.layers[r],t.tag(5,m.LengthDelimited).fork(),n).join();e.mid!==""&&t.tag(6,m.LengthDelimited).string(e.mid),e.dtx!==!1&&t.tag(7,m.Varint).bool(e.dtx),e.stereo!==!1&&t.tag(8,m.Varint).bool(e.stereo),e.red!==!1&&t.tag(9,m.Varint).bool(e.red);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Xt=new La,Fa=class extends I{constructor(){super("stream.video.sfu.models.Call",[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:9},{no:3,name:"created_by_user_id",kind:"scalar",T:9},{no:4,name:"host_user_id",kind:"scalar",T:9},{no:5,name:"custom",kind:"message",T:()=>Ge},{no:6,name:"created_at",kind:"message",T:()=>_e},{no:7,name:"updated_at",kind:"message",T:()=>_e}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.type="",t.id="",t.createdByUserId="",t.hostUserId="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.type=e.string();break;case 2:r.id=e.string();break;case 3:r.createdByUserId=e.string();break;case 4:r.hostUserId=e.string();break;case 5:r.custom=Ge.internalBinaryRead(e,e.uint32(),n,r.custom);break;case 6:r.createdAt=_e.internalBinaryRead(e,e.uint32(),n,r.createdAt);break;case 7:r.updatedAt=_e.internalBinaryRead(e,e.uint32(),n,r.updatedAt);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.type!==""&&t.tag(1,m.LengthDelimited).string(e.type),e.id!==""&&t.tag(2,m.LengthDelimited).string(e.id),e.createdByUserId!==""&&t.tag(3,m.LengthDelimited).string(e.createdByUserId),e.hostUserId!==""&&t.tag(4,m.LengthDelimited).string(e.hostUserId),e.custom&&Ge.internalBinaryWrite(e.custom,t.tag(5,m.LengthDelimited).fork(),n).join(),e.createdAt&&_e.internalBinaryWrite(e.createdAt,t.tag(6,m.LengthDelimited).fork(),n).join(),e.updatedAt&&_e.internalBinaryWrite(e.updatedAt,t.tag(7,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},JC=new Fa,vf=class extends I{constructor(){super("stream.video.sfu.models.Error",[{no:1,name:"code",kind:"enum",T:()=>["stream.video.sfu.models.ErrorCode",es,"ERROR_CODE_"]},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"should_retry",kind:"scalar",T:8}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.code=0,t.message="",t.shouldRetry=!1,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.code=e.int32();break;case 2:r.message=e.string();break;case 3:r.shouldRetry=e.bool();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.code!==0&&t.tag(1,m.Varint).int32(e.code),e.message!==""&&t.tag(2,m.LengthDelimited).string(e.message),e.shouldRetry!==!1&&t.tag(3,m.Varint).bool(e.shouldRetry);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},q=new vf,Ba=class extends I{constructor(){super("stream.video.sfu.models.ClientDetails",[{no:1,name:"sdk",kind:"message",T:()=>Vr},{no:2,name:"os",kind:"message",T:()=>jr},{no:3,name:"browser",kind:"message",T:()=>Mr},{no:4,name:"device",kind:"message",T:()=>$r}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.sdk=Vr.internalBinaryRead(e,e.uint32(),n,r.sdk);break;case 2:r.os=jr.internalBinaryRead(e,e.uint32(),n,r.os);break;case 3:r.browser=Mr.internalBinaryRead(e,e.uint32(),n,r.browser);break;case 4:r.device=$r.internalBinaryRead(e,e.uint32(),n,r.device);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.sdk&&Vr.internalBinaryWrite(e.sdk,t.tag(1,m.LengthDelimited).fork(),n).join(),e.os&&jr.internalBinaryWrite(e.os,t.tag(2,m.LengthDelimited).fork(),n).join(),e.browser&&Mr.internalBinaryWrite(e.browser,t.tag(3,m.LengthDelimited).fork(),n).join(),e.device&&$r.internalBinaryWrite(e.device,t.tag(4,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Br=new Ba,Va=class extends I{constructor(){super("stream.video.sfu.models.Sdk",[{no:1,name:"type",kind:"enum",T:()=>["stream.video.sfu.models.SdkType",Di,"SDK_TYPE_"]},{no:2,name:"major",kind:"scalar",T:9},{no:3,name:"minor",kind:"scalar",T:9},{no:4,name:"patch",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.type=0,t.major="",t.minor="",t.patch="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.type=e.int32();break;case 2:r.major=e.string();break;case 3:r.minor=e.string();break;case 4:r.patch=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.type!==0&&t.tag(1,m.Varint).int32(e.type),e.major!==""&&t.tag(2,m.LengthDelimited).string(e.major),e.minor!==""&&t.tag(3,m.LengthDelimited).string(e.minor),e.patch!==""&&t.tag(4,m.LengthDelimited).string(e.patch);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Vr=new Va,ja=class extends I{constructor(){super("stream.video.sfu.models.OS",[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"architecture",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.name="",t.version="",t.architecture="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.name=e.string();break;case 2:r.version=e.string();break;case 3:r.architecture=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.name!==""&&t.tag(1,m.LengthDelimited).string(e.name),e.version!==""&&t.tag(2,m.LengthDelimited).string(e.version),e.architecture!==""&&t.tag(3,m.LengthDelimited).string(e.architecture);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},jr=new ja,Ma=class extends I{constructor(){super("stream.video.sfu.models.Browser",[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"version",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.name="",t.version="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.name=e.string();break;case 2:r.version=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.name!==""&&t.tag(1,m.LengthDelimited).string(e.name),e.version!==""&&t.tag(2,m.LengthDelimited).string(e.version);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Mr=new Ma,$a=class extends I{constructor(){super("stream.video.sfu.models.Device",[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"version",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.name="",t.version="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.name=e.string();break;case 2:r.version=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.name!==""&&t.tag(1,m.LengthDelimited).string(e.name),e.version!==""&&t.tag(2,m.LengthDelimited).string(e.version);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},$r=new $a,Wa=class extends I{constructor(){super("stream.video.sfu.models.CallGrants",[{no:1,name:"can_publish_audio",kind:"scalar",T:8},{no:2,name:"can_publish_video",kind:"scalar",T:8},{no:3,name:"can_screenshare",kind:"scalar",T:8}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.canPublishAudio=!1,t.canPublishVideo=!1,t.canScreenshare=!1,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.canPublishAudio=e.bool();break;case 2:r.canPublishVideo=e.bool();break;case 3:r.canScreenshare=e.bool();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.canPublishAudio!==!1&&t.tag(1,m.Varint).bool(e.canPublishAudio),e.canPublishVideo!==!1&&t.tag(2,m.Varint).bool(e.canPublishVideo),e.canScreenshare!==!1&&t.tag(3,m.Varint).bool(e.canScreenshare);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Wr=new Wa;var Ha=class extends I{constructor(){super("stream.video.sfu.signal.StartNoiseCancellationRequest",[{no:1,name:"session_id",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.sessionId="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.sessionId=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.sessionId!==""&&t.tag(1,m.LengthDelimited).string(e.sessionId);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Tf=new Ha,qa=class extends I{constructor(){super("stream.video.sfu.signal.StartNoiseCancellationResponse",[{no:1,name:"error",kind:"message",T:()=>q}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.error=q.internalBinaryRead(e,e.uint32(),n,r.error);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.error&&q.internalBinaryWrite(e.error,t.tag(1,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Rf=new qa,Ga=class extends I{constructor(){super("stream.video.sfu.signal.StopNoiseCancellationRequest",[{no:1,name:"session_id",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.sessionId="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.sessionId=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.sessionId!==""&&t.tag(1,m.LengthDelimited).string(e.sessionId);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Ef=new Ga,Ja=class extends I{constructor(){super("stream.video.sfu.signal.StopNoiseCancellationResponse",[{no:1,name:"error",kind:"message",T:()=>q}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.error=q.internalBinaryRead(e,e.uint32(),n,r.error);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.error&&q.internalBinaryWrite(e.error,t.tag(1,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},If=new Ja,Ka=class extends I{constructor(){super("stream.video.sfu.signal.SendStatsRequest",[{no:1,name:"session_id",kind:"scalar",T:9},{no:2,name:"subscriber_stats",kind:"scalar",T:9},{no:3,name:"publisher_stats",kind:"scalar",T:9},{no:4,name:"webrtc_version",kind:"scalar",T:9},{no:5,name:"sdk",kind:"scalar",T:9},{no:6,name:"sdk_version",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.sessionId="",t.subscriberStats="",t.publisherStats="",t.webrtcVersion="",t.sdk="",t.sdkVersion="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.sessionId=e.string();break;case 2:r.subscriberStats=e.string();break;case 3:r.publisherStats=e.string();break;case 4:r.webrtcVersion=e.string();break;case 5:r.sdk=e.string();break;case 6:r.sdkVersion=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.sessionId!==""&&t.tag(1,m.LengthDelimited).string(e.sessionId),e.subscriberStats!==""&&t.tag(2,m.LengthDelimited).string(e.subscriberStats),e.publisherStats!==""&&t.tag(3,m.LengthDelimited).string(e.publisherStats),e.webrtcVersion!==""&&t.tag(4,m.LengthDelimited).string(e.webrtcVersion),e.sdk!==""&&t.tag(5,m.LengthDelimited).string(e.sdk),e.sdkVersion!==""&&t.tag(6,m.LengthDelimited).string(e.sdkVersion);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},_f=new Ka,za=class extends I{constructor(){super("stream.video.sfu.signal.SendStatsResponse",[{no:1,name:"error",kind:"message",T:()=>q}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.error=q.internalBinaryRead(e,e.uint32(),n,r.error);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.error&&q.internalBinaryWrite(e.error,t.tag(1,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Pf=new za,Xa=class extends I{constructor(){super("stream.video.sfu.signal.ICERestartRequest",[{no:1,name:"session_id",kind:"scalar",T:9},{no:2,name:"peer_type",kind:"enum",T:()=>["stream.video.sfu.models.PeerType",Ee,"PEER_TYPE_"]}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.sessionId="",t.peerType=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.sessionId=e.string();break;case 2:r.peerType=e.int32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.sessionId!==""&&t.tag(1,m.LengthDelimited).string(e.sessionId),e.peerType!==0&&t.tag(2,m.Varint).int32(e.peerType);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Nf=new Xa,Ya=class extends I{constructor(){super("stream.video.sfu.signal.ICERestartResponse",[{no:1,name:"error",kind:"message",T:()=>q}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.error=q.internalBinaryRead(e,e.uint32(),n,r.error);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.error&&q.internalBinaryWrite(e.error,t.tag(1,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Of=new Ya,Qa=class extends I{constructor(){super("stream.video.sfu.signal.UpdateMuteStatesRequest",[{no:1,name:"session_id",kind:"scalar",T:9},{no:3,name:"mute_states",kind:"message",repeat:1,T:()=>Hr}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.sessionId="",t.muteStates=[],e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.sessionId=e.string();break;case 3:r.muteStates.push(Hr.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.sessionId!==""&&t.tag(1,m.LengthDelimited).string(e.sessionId);for(let r=0;r<e.muteStates.length;r++)Hr.internalBinaryWrite(e.muteStates[r],t.tag(3,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},xf=new Qa,Za=class extends I{constructor(){super("stream.video.sfu.signal.UpdateMuteStatesResponse",[{no:4,name:"error",kind:"message",T:()=>q}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 4:r.error=q.internalBinaryRead(e,e.uint32(),n,r.error);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.error&&q.internalBinaryWrite(e.error,t.tag(4,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Df=new Za,eo=class extends I{constructor(){super("stream.video.sfu.signal.TrackMuteState",[{no:1,name:"track_type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",T,"TRACK_TYPE_"]},{no:2,name:"muted",kind:"scalar",T:8}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.trackType=0,t.muted=!1,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.trackType=e.int32();break;case 2:r.muted=e.bool();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.trackType!==0&&t.tag(1,m.Varint).int32(e.trackType),e.muted!==!1&&t.tag(2,m.Varint).bool(e.muted);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Hr=new eo,to=class extends I{constructor(){super("stream.video.sfu.signal.AudioMuteChanged",[{no:1,name:"muted",kind:"scalar",T:8}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.muted=!1,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.muted=e.bool();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.muted!==!1&&t.tag(1,m.Varint).bool(e.muted);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}};new to;var io=class extends I{constructor(){super("stream.video.sfu.signal.VideoMuteChanged",[{no:2,name:"muted",kind:"scalar",T:8}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.muted=!1,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 2:r.muted=e.bool();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.muted!==!1&&t.tag(2,m.Varint).bool(e.muted);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}};new io;var no=class extends I{constructor(){super("stream.video.sfu.signal.UpdateSubscriptionsRequest",[{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"tracks",kind:"message",repeat:1,T:()=>Yt}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.sessionId="",t.tracks=[],e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 2:r.sessionId=e.string();break;case 3:r.tracks.push(Yt.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.sessionId!==""&&t.tag(2,m.LengthDelimited).string(e.sessionId);for(let r=0;r<e.tracks.length;r++)Yt.internalBinaryWrite(e.tracks[r],t.tag(3,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Af=new no,so=class extends I{constructor(){super("stream.video.sfu.signal.UpdateSubscriptionsResponse",[{no:4,name:"error",kind:"message",T:()=>q}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 4:r.error=q.internalBinaryRead(e,e.uint32(),n,r.error);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.error&&q.internalBinaryWrite(e.error,t.tag(4,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Uf=new so,ro=class extends I{constructor(){super("stream.video.sfu.signal.TrackSubscriptionDetails",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"track_type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",T,"TRACK_TYPE_"]},{no:4,name:"dimension",kind:"message",T:()=>zt}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.userId="",t.sessionId="",t.trackType=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.userId=e.string();break;case 2:r.sessionId=e.string();break;case 3:r.trackType=e.int32();break;case 4:r.dimension=zt.internalBinaryRead(e,e.uint32(),n,r.dimension);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.userId!==""&&t.tag(1,m.LengthDelimited).string(e.userId),e.sessionId!==""&&t.tag(2,m.LengthDelimited).string(e.sessionId),e.trackType!==0&&t.tag(3,m.Varint).int32(e.trackType),e.dimension&&zt.internalBinaryWrite(e.dimension,t.tag(4,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Yt=new ro,ao=class extends I{constructor(){super("stream.video.sfu.signal.SendAnswerRequest",[{no:1,name:"peer_type",kind:"enum",T:()=>["stream.video.sfu.models.PeerType",Ee,"PEER_TYPE_"]},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"session_id",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.peerType=0,t.sdp="",t.sessionId="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.peerType=e.int32();break;case 2:r.sdp=e.string();break;case 3:r.sessionId=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.peerType!==0&&t.tag(1,m.Varint).int32(e.peerType),e.sdp!==""&&t.tag(2,m.LengthDelimited).string(e.sdp),e.sessionId!==""&&t.tag(3,m.LengthDelimited).string(e.sessionId);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Lf=new ao,oo=class extends I{constructor(){super("stream.video.sfu.signal.SendAnswerResponse",[{no:4,name:"error",kind:"message",T:()=>q}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 4:r.error=q.internalBinaryRead(e,e.uint32(),n,r.error);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.error&&q.internalBinaryWrite(e.error,t.tag(4,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Ff=new oo,co=class extends I{constructor(){super("stream.video.sfu.signal.ICETrickleResponse",[{no:4,name:"error",kind:"message",T:()=>q}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 4:r.error=q.internalBinaryRead(e,e.uint32(),n,r.error);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.error&&q.internalBinaryWrite(e.error,t.tag(4,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Bf=new co,lo=class extends I{constructor(){super("stream.video.sfu.signal.SetPublisherRequest",[{no:1,name:"sdp",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"tracks",kind:"message",repeat:1,T:()=>Xt}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.sdp="",t.sessionId="",t.tracks=[],e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.sdp=e.string();break;case 2:r.sessionId=e.string();break;case 3:r.tracks.push(Xt.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.sdp!==""&&t.tag(1,m.LengthDelimited).string(e.sdp),e.sessionId!==""&&t.tag(2,m.LengthDelimited).string(e.sessionId);for(let r=0;r<e.tracks.length;r++)Xt.internalBinaryWrite(e.tracks[r],t.tag(3,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Vf=new lo,uo=class extends I{constructor(){super("stream.video.sfu.signal.SetPublisherResponse",[{no:1,name:"sdp",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"ice_restart",kind:"scalar",T:8},{no:4,name:"error",kind:"message",T:()=>q}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.sdp="",t.sessionId="",t.iceRestart=!1,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.sdp=e.string();break;case 2:r.sessionId=e.string();break;case 3:r.iceRestart=e.bool();break;case 4:r.error=q.internalBinaryRead(e,e.uint32(),n,r.error);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.sdp!==""&&t.tag(1,m.LengthDelimited).string(e.sdp),e.sessionId!==""&&t.tag(2,m.LengthDelimited).string(e.sessionId),e.iceRestart!==!1&&t.tag(3,m.Varint).bool(e.iceRestart),e.error&&q.internalBinaryWrite(e.error,t.tag(4,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},jf=new uo,qr=new gi("stream.video.sfu.signal.SignalServer",[{name:"SetPublisher",options:{},I:Vf,O:jf},{name:"SendAnswer",options:{},I:Lf,O:Ff},{name:"IceTrickle",options:{},I:Hn,O:Bf},{name:"UpdateSubscriptions",options:{},I:Af,O:Uf},{name:"UpdateMuteStates",options:{},I:xf,O:Df},{name:"IceRestart",options:{},I:Nf,O:Of},{name:"SendStats",options:{},I:_f,O:Pf},{name:"StartNoiseCancellation",options:{},I:Tf,O:Rf},{name:"StopNoiseCancellation",options:{},I:Ef,O:If}]),fd=function(i){return i[i.HIGH_UNSPECIFIED=0]="HIGH_UNSPECIFIED",i[i.LOW=1]="LOW",i[i.MEDIUM=2]="MEDIUM",i[i.VERY_LOW=3]="VERY_LOW",i}(fd||{}),ho=class extends I{constructor(){super("stream.video.sfu.event.SfuEvent",[{no:1,name:"subscriber_offer",kind:"message",oneof:"eventPayload",T:()=>sa},{no:2,name:"publisher_answer",kind:"message",oneof:"eventPayload",T:()=>ra},{no:3,name:"connection_quality_changed",kind:"message",oneof:"eventPayload",T:()=>aa},{no:4,name:"audio_level_changed",kind:"message",oneof:"eventPayload",T:()=>ua},{no:5,name:"ice_trickle",kind:"message",oneof:"eventPayload",T:()=>Hn},{no:6,name:"change_publish_quality",kind:"message",oneof:"eventPayload",T:()=>ga},{no:10,name:"participant_joined",kind:"message",oneof:"eventPayload",T:()=>ta},{no:11,name:"participant_left",kind:"message",oneof:"eventPayload",T:()=>ia},{no:12,name:"dominant_speaker_changed",kind:"message",oneof:"eventPayload",T:()=>ca},{no:13,name:"join_response",kind:"message",oneof:"eventPayload",T:()=>ea},{no:14,name:"health_check_response",kind:"message",oneof:"eventPayload",T:()=>Xr},{no:16,name:"track_published",kind:"message",oneof:"eventPayload",T:()=>Yr},{no:17,name:"track_unpublished",kind:"message",oneof:"eventPayload",T:()=>Qr},{no:18,name:"error",kind:"message",oneof:"eventPayload",T:()=>Jr},{no:19,name:"call_grants_updated",kind:"message",oneof:"eventPayload",T:()=>ba},{no:20,name:"go_away",kind:"message",oneof:"eventPayload",T:()=>ya},{no:21,name:"ice_restart",kind:"message",oneof:"eventPayload",T:()=>Kr},{no:22,name:"pins_updated",kind:"message",oneof:"eventPayload",T:()=>Gr},{no:23,name:"call_ended",kind:"message",oneof:"eventPayload",T:()=>Sa},{no:24,name:"participant_updated",kind:"message",oneof:"eventPayload",T:()=>na}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.eventPayload={oneofKind:void 0},e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.eventPayload={oneofKind:"subscriberOffer",subscriberOffer:sa.internalBinaryRead(e,e.uint32(),n,r.eventPayload.subscriberOffer)};break;case 2:r.eventPayload={oneofKind:"publisherAnswer",publisherAnswer:ra.internalBinaryRead(e,e.uint32(),n,r.eventPayload.publisherAnswer)};break;case 3:r.eventPayload={oneofKind:"connectionQualityChanged",connectionQualityChanged:aa.internalBinaryRead(e,e.uint32(),n,r.eventPayload.connectionQualityChanged)};break;case 4:r.eventPayload={oneofKind:"audioLevelChanged",audioLevelChanged:ua.internalBinaryRead(e,e.uint32(),n,r.eventPayload.audioLevelChanged)};break;case 5:r.eventPayload={oneofKind:"iceTrickle",iceTrickle:Hn.internalBinaryRead(e,e.uint32(),n,r.eventPayload.iceTrickle)};break;case 6:r.eventPayload={oneofKind:"changePublishQuality",changePublishQuality:ga.internalBinaryRead(e,e.uint32(),n,r.eventPayload.changePublishQuality)};break;case 10:r.eventPayload={oneofKind:"participantJoined",participantJoined:ta.internalBinaryRead(e,e.uint32(),n,r.eventPayload.participantJoined)};break;case 11:r.eventPayload={oneofKind:"participantLeft",participantLeft:ia.internalBinaryRead(e,e.uint32(),n,r.eventPayload.participantLeft)};break;case 12:r.eventPayload={oneofKind:"dominantSpeakerChanged",dominantSpeakerChanged:ca.internalBinaryRead(e,e.uint32(),n,r.eventPayload.dominantSpeakerChanged)};break;case 13:r.eventPayload={oneofKind:"joinResponse",joinResponse:ea.internalBinaryRead(e,e.uint32(),n,r.eventPayload.joinResponse)};break;case 14:r.eventPayload={oneofKind:"healthCheckResponse",healthCheckResponse:Xr.internalBinaryRead(e,e.uint32(),n,r.eventPayload.healthCheckResponse)};break;case 16:r.eventPayload={oneofKind:"trackPublished",trackPublished:Yr.internalBinaryRead(e,e.uint32(),n,r.eventPayload.trackPublished)};break;case 17:r.eventPayload={oneofKind:"trackUnpublished",trackUnpublished:Qr.internalBinaryRead(e,e.uint32(),n,r.eventPayload.trackUnpublished)};break;case 18:r.eventPayload={oneofKind:"error",error:Jr.internalBinaryRead(e,e.uint32(),n,r.eventPayload.error)};break;case 19:r.eventPayload={oneofKind:"callGrantsUpdated",callGrantsUpdated:ba.internalBinaryRead(e,e.uint32(),n,r.eventPayload.callGrantsUpdated)};break;case 20:r.eventPayload={oneofKind:"goAway",goAway:ya.internalBinaryRead(e,e.uint32(),n,r.eventPayload.goAway)};break;case 21:r.eventPayload={oneofKind:"iceRestart",iceRestart:Kr.internalBinaryRead(e,e.uint32(),n,r.eventPayload.iceRestart)};break;case 22:r.eventPayload={oneofKind:"pinsUpdated",pinsUpdated:Gr.internalBinaryRead(e,e.uint32(),n,r.eventPayload.pinsUpdated)};break;case 23:r.eventPayload={oneofKind:"callEnded",callEnded:Sa.internalBinaryRead(e,e.uint32(),n,r.eventPayload.callEnded)};break;case 24:r.eventPayload={oneofKind:"participantUpdated",participantUpdated:na.internalBinaryRead(e,e.uint32(),n,r.eventPayload.participantUpdated)};break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.eventPayload.oneofKind==="subscriberOffer"&&sa.internalBinaryWrite(e.eventPayload.subscriberOffer,t.tag(1,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="publisherAnswer"&&ra.internalBinaryWrite(e.eventPayload.publisherAnswer,t.tag(2,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="connectionQualityChanged"&&aa.internalBinaryWrite(e.eventPayload.connectionQualityChanged,t.tag(3,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="audioLevelChanged"&&ua.internalBinaryWrite(e.eventPayload.audioLevelChanged,t.tag(4,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="iceTrickle"&&Hn.internalBinaryWrite(e.eventPayload.iceTrickle,t.tag(5,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="changePublishQuality"&&ga.internalBinaryWrite(e.eventPayload.changePublishQuality,t.tag(6,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="participantJoined"&&ta.internalBinaryWrite(e.eventPayload.participantJoined,t.tag(10,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="participantLeft"&&ia.internalBinaryWrite(e.eventPayload.participantLeft,t.tag(11,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="dominantSpeakerChanged"&&ca.internalBinaryWrite(e.eventPayload.dominantSpeakerChanged,t.tag(12,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="joinResponse"&&ea.internalBinaryWrite(e.eventPayload.joinResponse,t.tag(13,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="healthCheckResponse"&&Xr.internalBinaryWrite(e.eventPayload.healthCheckResponse,t.tag(14,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="trackPublished"&&Yr.internalBinaryWrite(e.eventPayload.trackPublished,t.tag(16,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="trackUnpublished"&&Qr.internalBinaryWrite(e.eventPayload.trackUnpublished,t.tag(17,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="error"&&Jr.internalBinaryWrite(e.eventPayload.error,t.tag(18,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="callGrantsUpdated"&&ba.internalBinaryWrite(e.eventPayload.callGrantsUpdated,t.tag(19,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="goAway"&&ya.internalBinaryWrite(e.eventPayload.goAway,t.tag(20,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="iceRestart"&&Kr.internalBinaryWrite(e.eventPayload.iceRestart,t.tag(21,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="pinsUpdated"&&Gr.internalBinaryWrite(e.eventPayload.pinsUpdated,t.tag(22,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="callEnded"&&Sa.internalBinaryWrite(e.eventPayload.callEnded,t.tag(23,m.LengthDelimited).fork(),n).join(),e.eventPayload.oneofKind==="participantUpdated"&&na.internalBinaryWrite(e.eventPayload.participantUpdated,t.tag(24,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Ju=new ho,fo=class extends I{constructor(){super("stream.video.sfu.event.PinsChanged",[{no:1,name:"pins",kind:"message",repeat:1,T:()=>Kt}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.pins=[],e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.pins.push(Kt.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){for(let r=0;r<e.pins.length;r++)Kt.internalBinaryWrite(e.pins[r],t.tag(1,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Gr=new fo,po=class extends I{constructor(){super("stream.video.sfu.event.Error",[{no:4,name:"error",kind:"message",T:()=>q},{no:5,name:"reconnect_strategy",kind:"enum",T:()=>["stream.video.sfu.models.WebsocketReconnectStrategy",hd,"WEBSOCKET_RECONNECT_STRATEGY_"]}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.reconnectStrategy=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 4:r.error=q.internalBinaryRead(e,e.uint32(),n,r.error);break;case 5:r.reconnectStrategy=e.int32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.error&&q.internalBinaryWrite(e.error,t.tag(4,m.LengthDelimited).fork(),n).join(),e.reconnectStrategy!==0&&t.tag(5,m.Varint).int32(e.reconnectStrategy);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Jr=new po,mo=class extends I{constructor(){super("stream.video.sfu.event.ICETrickle",[{no:1,name:"peer_type",kind:"enum",T:()=>["stream.video.sfu.models.PeerType",Ee,"PEER_TYPE_"]},{no:2,name:"ice_candidate",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.peerType=0,t.iceCandidate="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.peerType=e.int32();break;case 2:r.iceCandidate=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.peerType!==0&&t.tag(1,m.Varint).int32(e.peerType),e.iceCandidate!==""&&t.tag(2,m.LengthDelimited).string(e.iceCandidate);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},zC=new mo,go=class extends I{constructor(){super("stream.video.sfu.event.ICERestart",[{no:1,name:"peer_type",kind:"enum",T:()=>["stream.video.sfu.models.PeerType",Ee,"PEER_TYPE_"]}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.peerType=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.peerType=e.int32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.peerType!==0&&t.tag(1,m.Varint).int32(e.peerType);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Kr=new go,bo=class extends I{constructor(){super("stream.video.sfu.event.SfuRequest",[{no:1,name:"join_request",kind:"message",oneof:"requestPayload",T:()=>qn},{no:2,name:"health_check_request",kind:"message",oneof:"requestPayload",T:()=>zr}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.requestPayload={oneofKind:void 0},e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.requestPayload={oneofKind:"joinRequest",joinRequest:qn.internalBinaryRead(e,e.uint32(),n,r.requestPayload.joinRequest)};break;case 2:r.requestPayload={oneofKind:"healthCheckRequest",healthCheckRequest:zr.internalBinaryRead(e,e.uint32(),n,r.requestPayload.healthCheckRequest)};break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.requestPayload.oneofKind==="joinRequest"&&qn.internalBinaryWrite(e.requestPayload.joinRequest,t.tag(1,m.LengthDelimited).fork(),n).join(),e.requestPayload.oneofKind==="healthCheckRequest"&&zr.internalBinaryWrite(e.requestPayload.healthCheckRequest,t.tag(2,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Mn=new bo,yo=class extends I{constructor(){super("stream.video.sfu.event.HealthCheckRequest",[])}create(e){let t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){return s??this.create()}internalBinaryWrite(e,t,n){let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},zr=new yo,So=class extends I{constructor(){super("stream.video.sfu.event.HealthCheckResponse",[{no:1,name:"participant_count",kind:"message",T:()=>Jt}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.participantCount=Jt.internalBinaryRead(e,e.uint32(),n,r.participantCount);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.participantCount&&Jt.internalBinaryWrite(e.participantCount,t.tag(1,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Xr=new So,ko=class extends I{constructor(){super("stream.video.sfu.event.TrackPublished",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",T,"TRACK_TYPE_"]},{no:4,name:"participant",kind:"message",T:()=>de}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.userId="",t.sessionId="",t.type=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.userId=e.string();break;case 2:r.sessionId=e.string();break;case 3:r.type=e.int32();break;case 4:r.participant=de.internalBinaryRead(e,e.uint32(),n,r.participant);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.userId!==""&&t.tag(1,m.LengthDelimited).string(e.userId),e.sessionId!==""&&t.tag(2,m.LengthDelimited).string(e.sessionId),e.type!==0&&t.tag(3,m.Varint).int32(e.type),e.participant&&de.internalBinaryWrite(e.participant,t.tag(4,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Yr=new ko,Co=class extends I{constructor(){super("stream.video.sfu.event.TrackUnpublished",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",T,"TRACK_TYPE_"]},{no:4,name:"cause",kind:"enum",T:()=>["stream.video.sfu.models.TrackUnpublishReason",wc,"TRACK_UNPUBLISH_REASON_"]},{no:5,name:"participant",kind:"message",T:()=>de}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.userId="",t.sessionId="",t.type=0,t.cause=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.userId=e.string();break;case 2:r.sessionId=e.string();break;case 3:r.type=e.int32();break;case 4:r.cause=e.int32();break;case 5:r.participant=de.internalBinaryRead(e,e.uint32(),n,r.participant);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.userId!==""&&t.tag(1,m.LengthDelimited).string(e.userId),e.sessionId!==""&&t.tag(2,m.LengthDelimited).string(e.sessionId),e.type!==0&&t.tag(3,m.Varint).int32(e.type),e.cause!==0&&t.tag(4,m.Varint).int32(e.cause),e.participant&&de.internalBinaryWrite(e.participant,t.tag(5,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Qr=new Co,wo=class extends I{constructor(){super("stream.video.sfu.event.JoinRequest",[{no:1,name:"token",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"subscriber_sdp",kind:"scalar",T:9},{no:4,name:"client_details",kind:"message",T:()=>Br},{no:5,name:"migration",kind:"message",T:()=>Zr},{no:6,name:"fast_reconnect",kind:"scalar",T:8}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.token="",t.sessionId="",t.subscriberSdp="",t.fastReconnect=!1,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.token=e.string();break;case 2:r.sessionId=e.string();break;case 3:r.subscriberSdp=e.string();break;case 4:r.clientDetails=Br.internalBinaryRead(e,e.uint32(),n,r.clientDetails);break;case 5:r.migration=Zr.internalBinaryRead(e,e.uint32(),n,r.migration);break;case 6:r.fastReconnect=e.bool();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.token!==""&&t.tag(1,m.LengthDelimited).string(e.token),e.sessionId!==""&&t.tag(2,m.LengthDelimited).string(e.sessionId),e.subscriberSdp!==""&&t.tag(3,m.LengthDelimited).string(e.subscriberSdp),e.clientDetails&&Br.internalBinaryWrite(e.clientDetails,t.tag(4,m.LengthDelimited).fork(),n).join(),e.migration&&Zr.internalBinaryWrite(e.migration,t.tag(5,m.LengthDelimited).fork(),n).join(),e.fastReconnect!==!1&&t.tag(6,m.Varint).bool(e.fastReconnect);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},qn=new wo,vo=class extends I{constructor(){super("stream.video.sfu.event.Migration",[{no:1,name:"from_sfu_id",kind:"scalar",T:9},{no:2,name:"announced_tracks",kind:"message",repeat:1,T:()=>Xt},{no:3,name:"subscriptions",kind:"message",repeat:1,T:()=>Yt}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.fromSfuId="",t.announcedTracks=[],t.subscriptions=[],e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.fromSfuId=e.string();break;case 2:r.announcedTracks.push(Xt.internalBinaryRead(e,e.uint32(),n));break;case 3:r.subscriptions.push(Yt.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.fromSfuId!==""&&t.tag(1,m.LengthDelimited).string(e.fromSfuId);for(let r=0;r<e.announcedTracks.length;r++)Xt.internalBinaryWrite(e.announcedTracks[r],t.tag(2,m.LengthDelimited).fork(),n).join();for(let r=0;r<e.subscriptions.length;r++)Yt.internalBinaryWrite(e.subscriptions[r],t.tag(3,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Zr=new vo,To=class extends I{constructor(){super("stream.video.sfu.event.JoinResponse",[{no:1,name:"call_state",kind:"message",T:()=>Lr},{no:2,name:"reconnected",kind:"scalar",T:8}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.reconnected=!1,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.callState=Lr.internalBinaryRead(e,e.uint32(),n,r.callState);break;case 2:r.reconnected=e.bool();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.callState&&Lr.internalBinaryWrite(e.callState,t.tag(1,m.LengthDelimited).fork(),n).join(),e.reconnected!==!1&&t.tag(2,m.Varint).bool(e.reconnected);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},ea=new To,Ro=class extends I{constructor(){super("stream.video.sfu.event.ParticipantJoined",[{no:1,name:"call_cid",kind:"scalar",T:9},{no:2,name:"participant",kind:"message",T:()=>de}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.callCid="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.callCid=e.string();break;case 2:r.participant=de.internalBinaryRead(e,e.uint32(),n,r.participant);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.callCid!==""&&t.tag(1,m.LengthDelimited).string(e.callCid),e.participant&&de.internalBinaryWrite(e.participant,t.tag(2,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},ta=new Ro,Eo=class extends I{constructor(){super("stream.video.sfu.event.ParticipantLeft",[{no:1,name:"call_cid",kind:"scalar",T:9},{no:2,name:"participant",kind:"message",T:()=>de}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.callCid="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.callCid=e.string();break;case 2:r.participant=de.internalBinaryRead(e,e.uint32(),n,r.participant);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.callCid!==""&&t.tag(1,m.LengthDelimited).string(e.callCid),e.participant&&de.internalBinaryWrite(e.participant,t.tag(2,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},ia=new Eo,Io=class extends I{constructor(){super("stream.video.sfu.event.ParticipantUpdated",[{no:1,name:"call_cid",kind:"scalar",T:9},{no:2,name:"participant",kind:"message",T:()=>de}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.callCid="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.callCid=e.string();break;case 2:r.participant=de.internalBinaryRead(e,e.uint32(),n,r.participant);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.callCid!==""&&t.tag(1,m.LengthDelimited).string(e.callCid),e.participant&&de.internalBinaryWrite(e.participant,t.tag(2,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},na=new Io,_o=class extends I{constructor(){super("stream.video.sfu.event.SubscriberOffer",[{no:1,name:"ice_restart",kind:"scalar",T:8},{no:2,name:"sdp",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.iceRestart=!1,t.sdp="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.iceRestart=e.bool();break;case 2:r.sdp=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.iceRestart!==!1&&t.tag(1,m.Varint).bool(e.iceRestart),e.sdp!==""&&t.tag(2,m.LengthDelimited).string(e.sdp);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},sa=new _o,Po=class extends I{constructor(){super("stream.video.sfu.event.PublisherAnswer",[{no:1,name:"sdp",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.sdp="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.sdp=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.sdp!==""&&t.tag(1,m.LengthDelimited).string(e.sdp);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},ra=new Po,No=class extends I{constructor(){super("stream.video.sfu.event.ConnectionQualityChanged",[{no:1,name:"connection_quality_updates",kind:"message",repeat:1,T:()=>oa}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.connectionQualityUpdates=[],e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.connectionQualityUpdates.push(oa.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){for(let r=0;r<e.connectionQualityUpdates.length;r++)oa.internalBinaryWrite(e.connectionQualityUpdates[r],t.tag(1,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},aa=new No,Oo=class extends I{constructor(){super("stream.video.sfu.event.ConnectionQualityInfo",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"connection_quality",kind:"enum",T:()=>["stream.video.sfu.models.ConnectionQuality",Cc,"CONNECTION_QUALITY_"]}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.userId="",t.sessionId="",t.connectionQuality=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.userId=e.string();break;case 2:r.sessionId=e.string();break;case 3:r.connectionQuality=e.int32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.userId!==""&&t.tag(1,m.LengthDelimited).string(e.userId),e.sessionId!==""&&t.tag(2,m.LengthDelimited).string(e.sessionId),e.connectionQuality!==0&&t.tag(3,m.Varint).int32(e.connectionQuality);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},oa=new Oo,xo=class extends I{constructor(){super("stream.video.sfu.event.DominantSpeakerChanged",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.userId="",t.sessionId="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.userId=e.string();break;case 2:r.sessionId=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.userId!==""&&t.tag(1,m.LengthDelimited).string(e.userId),e.sessionId!==""&&t.tag(2,m.LengthDelimited).string(e.sessionId);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},ca=new xo,Do=class extends I{constructor(){super("stream.video.sfu.event.AudioLevel",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"level",kind:"scalar",T:2},{no:4,name:"is_speaking",kind:"scalar",T:8}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.userId="",t.sessionId="",t.level=0,t.isSpeaking=!1,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.userId=e.string();break;case 2:r.sessionId=e.string();break;case 3:r.level=e.float();break;case 4:r.isSpeaking=e.bool();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.userId!==""&&t.tag(1,m.LengthDelimited).string(e.userId),e.sessionId!==""&&t.tag(2,m.LengthDelimited).string(e.sessionId),e.level!==0&&t.tag(3,m.Bit32).float(e.level),e.isSpeaking!==!1&&t.tag(4,m.Varint).bool(e.isSpeaking);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},la=new Do,Ao=class extends I{constructor(){super("stream.video.sfu.event.AudioLevelChanged",[{no:1,name:"audio_levels",kind:"message",repeat:1,T:()=>la}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.audioLevels=[],e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.audioLevels.push(la.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){for(let r=0;r<e.audioLevels.length;r++)la.internalBinaryWrite(e.audioLevels[r],t.tag(1,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},ua=new Ao,Uo=class extends I{constructor(){super("stream.video.sfu.event.AudioMediaRequest",[{no:1,name:"channel_count",kind:"scalar",T:5}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.channelCount=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.channelCount=e.int32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.channelCount!==0&&t.tag(1,m.Varint).int32(e.channelCount);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},da=new Uo,Lo=class extends I{constructor(){super("stream.video.sfu.event.AudioSender",[{no:1,name:"media_request",kind:"message",T:()=>da},{no:2,name:"codec",kind:"message",T:()=>rt}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.mediaRequest=da.internalBinaryRead(e,e.uint32(),n,r.mediaRequest);break;case 2:r.codec=rt.internalBinaryRead(e,e.uint32(),n,r.codec);break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.mediaRequest&&da.internalBinaryWrite(e.mediaRequest,t.tag(1,m.LengthDelimited).fork(),n).join(),e.codec&&rt.internalBinaryWrite(e.codec,t.tag(2,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},ha=new Lo,Fo=class extends I{constructor(){super("stream.video.sfu.event.VideoMediaRequest",[{no:1,name:"ideal_height",kind:"scalar",T:5},{no:2,name:"ideal_width",kind:"scalar",T:5},{no:3,name:"ideal_frame_rate",kind:"scalar",T:5}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.idealHeight=0,t.idealWidth=0,t.idealFrameRate=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.idealHeight=e.int32();break;case 2:r.idealWidth=e.int32();break;case 3:r.idealFrameRate=e.int32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.idealHeight!==0&&t.tag(1,m.Varint).int32(e.idealHeight),e.idealWidth!==0&&t.tag(2,m.Varint).int32(e.idealWidth),e.idealFrameRate!==0&&t.tag(3,m.Varint).int32(e.idealFrameRate);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},fa=new Fo,Bo=class extends I{constructor(){super("stream.video.sfu.event.VideoLayerSetting",[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"active",kind:"scalar",T:8},{no:3,name:"max_bitrate",kind:"scalar",T:5},{no:4,name:"scale_resolution_down_by",kind:"scalar",T:2},{no:5,name:"priority",kind:"enum",T:()=>["stream.video.sfu.event.VideoLayerSetting.Priority",fd,"PRIORITY_"]},{no:6,name:"codec",kind:"message",T:()=>rt},{no:7,name:"max_framerate",kind:"scalar",T:13}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.name="",t.active=!1,t.maxBitrate=0,t.scaleResolutionDownBy=0,t.priority=0,t.maxFramerate=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.name=e.string();break;case 2:r.active=e.bool();break;case 3:r.maxBitrate=e.int32();break;case 4:r.scaleResolutionDownBy=e.float();break;case 5:r.priority=e.int32();break;case 6:r.codec=rt.internalBinaryRead(e,e.uint32(),n,r.codec);break;case 7:r.maxFramerate=e.uint32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.name!==""&&t.tag(1,m.LengthDelimited).string(e.name),e.active!==!1&&t.tag(2,m.Varint).bool(e.active),e.maxBitrate!==0&&t.tag(3,m.Varint).int32(e.maxBitrate),e.scaleResolutionDownBy!==0&&t.tag(4,m.Bit32).float(e.scaleResolutionDownBy),e.priority!==0&&t.tag(5,m.Varint).int32(e.priority),e.codec&&rt.internalBinaryWrite(e.codec,t.tag(6,m.LengthDelimited).fork(),n).join(),e.maxFramerate!==0&&t.tag(7,m.Varint).uint32(e.maxFramerate);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},pa=new Bo,Vo=class extends I{constructor(){super("stream.video.sfu.event.VideoSender",[{no:1,name:"media_request",kind:"message",T:()=>fa},{no:2,name:"codec",kind:"message",T:()=>rt},{no:3,name:"layers",kind:"message",repeat:1,T:()=>pa}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.layers=[],e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.mediaRequest=fa.internalBinaryRead(e,e.uint32(),n,r.mediaRequest);break;case 2:r.codec=rt.internalBinaryRead(e,e.uint32(),n,r.codec);break;case 3:r.layers.push(pa.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.mediaRequest&&fa.internalBinaryWrite(e.mediaRequest,t.tag(1,m.LengthDelimited).fork(),n).join(),e.codec&&rt.internalBinaryWrite(e.codec,t.tag(2,m.LengthDelimited).fork(),n).join();for(let r=0;r<e.layers.length;r++)pa.internalBinaryWrite(e.layers[r],t.tag(3,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},ma=new Vo,jo=class extends I{constructor(){super("stream.video.sfu.event.ChangePublishQuality",[{no:1,name:"audio_senders",kind:"message",repeat:1,T:()=>ha},{no:2,name:"video_senders",kind:"message",repeat:1,T:()=>ma}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.audioSenders=[],t.videoSenders=[],e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.audioSenders.push(ha.internalBinaryRead(e,e.uint32(),n));break;case 2:r.videoSenders.push(ma.internalBinaryRead(e,e.uint32(),n));break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){for(let r=0;r<e.audioSenders.length;r++)ha.internalBinaryWrite(e.audioSenders[r],t.tag(1,m.LengthDelimited).fork(),n).join();for(let r=0;r<e.videoSenders.length;r++)ma.internalBinaryWrite(e.videoSenders[r],t.tag(2,m.LengthDelimited).fork(),n).join();let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},ga=new jo,Mo=class extends I{constructor(){super("stream.video.sfu.event.CallGrantsUpdated",[{no:1,name:"current_grants",kind:"message",T:()=>Wr},{no:2,name:"message",kind:"scalar",T:9}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.message="",e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.currentGrants=Wr.internalBinaryRead(e,e.uint32(),n,r.currentGrants);break;case 2:r.message=e.string();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.currentGrants&&Wr.internalBinaryWrite(e.currentGrants,t.tag(1,m.LengthDelimited).fork(),n).join(),e.message!==""&&t.tag(2,m.LengthDelimited).string(e.message);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},ba=new Mo,$o=class extends I{constructor(){super("stream.video.sfu.event.GoAway",[{no:1,name:"reason",kind:"enum",T:()=>["stream.video.sfu.models.GoAwayReason",Gn,"GO_AWAY_REASON_"]}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.reason=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.reason=e.int32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.reason!==0&&t.tag(1,m.Varint).int32(e.reason);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},ya=new $o,Wo=class extends I{constructor(){super("stream.video.sfu.event.CallEnded",[{no:1,name:"reason",kind:"enum",T:()=>["stream.video.sfu.models.CallEndedReason",dd,"CALL_ENDED_REASON_"]}])}create(e){let t=globalThis.Object.create(this.messagePrototype);return t.reason=0,e!==void 0&&R(this,t,e),t}internalBinaryRead(e,t,n,s){let r=s??this.create(),o=e.pos+t;for(;e.pos<o;){let[a,l]=e.tag();switch(a){case 1:r.reason=e.int32();break;default:let c=n.readUnknownField;if(c==="throw")throw new globalThis.Error(`Unknown field ${a} (wire type ${l}) for ${this.typeName}`);let u=e.skip(l);c!==!1&&(c===!0?y.onRead:c)(this.typeName,r,a,l,u)}}return r}internalBinaryWrite(e,t,n){e.reason!==0&&t.tag(1,m.Varint).int32(e.reason);let s=n.writeUnknownFields;return s!==!1&&(s==!0?y.onWrite:s)(this.typeName,e,t),t}},Sa=new Wo;var re=function(i){return i.UNKNOWN="UNKNOWN",i.VISIBLE="VISIBLE",i.INVISIBLE="INVISIBLE",i}(re||{}),Be=function(i){return i[i.IMMEDIATE=20]="IMMEDIATE",i[i.FAST=100]="FAST",i[i.MEDIUM=600]="MEDIUM",i[i.SLOW=1200]="SLOW",i}(Be||{}),Ho=class{constructor(e){this._transport=e,this.typeName=qr.typeName,this.methods=qr.methods,this.options=qr.options}setPublisher(e,t){let n=this.methods[0],s=this._transport.mergeOptions(t);return Ae("unary",this._transport,n,s,e)}sendAnswer(e,t){let n=this.methods[1],s=this._transport.mergeOptions(t);return Ae("unary",this._transport,n,s,e)}iceTrickle(e,t){let n=this.methods[2],s=this._transport.mergeOptions(t);return Ae("unary",this._transport,n,s,e)}updateSubscriptions(e,t){let n=this.methods[3],s=this._transport.mergeOptions(t);return Ae("unary",this._transport,n,s,e)}updateMuteStates(e,t){let n=this.methods[4],s=this._transport.mergeOptions(t);return Ae("unary",this._transport,n,s,e)}iceRestart(e,t){let n=this.methods[5],s=this._transport.mergeOptions(t);return Ae("unary",this._transport,n,s,e)}sendStats(e,t){let n=this.methods[6],s=this._transport.mergeOptions(t);return Ae("unary",this._transport,n,s,e)}startNoiseCancellation(e,t){let n=this.methods[7],s=this._transport.mergeOptions(t);return Ae("unary",this._transport,n,s,e)}stopNoiseCancellation(e,t){let n=this.methods[8],s=this._transport.mergeOptions(t);return Ae("unary",this._transport,n,s,e)}},Mf={baseUrl:"",sendJson:!0,timeout:5*1e3,jsonOptions:{ignoreUnknownFields:!0}},$f=i=>({interceptUnary(e,t,n,s){return s.meta=E(E({},s.meta),i),e(t,n,s)}}),Wf=i=>{let e=new _i(E(E({},Mf),i));return new Ho(e)},ue=()=>typeof navigator>"u"?!1:navigator.product?.toLowerCase()==="reactnative",Ku=Object.freeze({trace:0,debug:1,info:2,warn:3,error:4}),pd,md="info",gd=(i,e,...t)=>{let n;switch(i){case"error":if(ue()){e=`ERROR: ${e}`,n=console.info;break}n=console.error;break;case"warn":if(ue()){e=`WARN: ${e}`,n=console.info;break}n=console.warn;break;case"info":n=console.info;break;case"trace":n=console.trace;break;default:n=console.log;break}n(e,...t)},Hf=(i,e)=>{pd=i,e&&qf(e)},qf=i=>{md=i},ie=i=>{let e=pd||gd,t=(i||[]).join(":");return(s,r,...o)=>{Ku[s]>=Ku[md]&&e(s,`[${t}]: ${r}`,...o)}},zu=(i,e,t)=>{let n=ie(["codecs"]);if(!("getCapabilities"in RTCRtpReceiver)){n("warn","RTCRtpReceiver.getCapabilities is not supported");return}let s=RTCRtpReceiver.getCapabilities(i);if(!s)return;let r=[],o=[],a=[];return s.codecs.forEach(l=>{let c=l.mimeType.toLowerCase();if(n("debug",`Found supported codec: ${c}`),t&&c===`${i}/${t.toLowerCase()}`)return;if(!(c===`${i}/${e.toLowerCase()}`)){a.push(l);return}if(c==="h264"){l.sdpFmtpLine&&l.sdpFmtpLine.includes("profile-level-id=42e01f")?r.push(l):o.push(l);return}r.push(l)}),[...r,...o,...a]},Gf=i=>b(void 0,null,function*(){let e=new RTCPeerConnection;e.addTransceiver("video",{direction:i}),e.addTransceiver("audio",{direction:i});let n=(yield e.createOffer()).sdp??"";return e.getTransceivers().forEach(s=>{s.stop?.()}),e.close(),n}),Jf={subscriberOffer:void 0,publisherAnswer:void 0,connectionQualityChanged:void 0,audioLevelChanged:void 0,iceTrickle:void 0,changePublishQuality:void 0,participantJoined:void 0,participantLeft:void 0,dominantSpeakerChanged:void 0,joinResponse:void 0,healthCheckResponse:void 0,trackPublished:void 0,trackUnpublished:void 0,error:void 0,callGrantsUpdated:void 0,goAway:void 0,iceRestart:void 0,pinsUpdated:void 0,callEnded:void 0,participantUpdated:void 0},Xu=i=>Object.prototype.hasOwnProperty.call(Jf,i),qo=class{constructor(){this.logger=ie(["Dispatcher"]),this.subscribers={},this.dispatch=e=>{let t=e.eventPayload.oneofKind;if(!t)return;let n=e.eventPayload[t];this.logger("debug",`Dispatching ${t}`,n);let s=this.subscribers[t];if(s)for(let r of s)try{r(n)}catch(o){this.logger("warn","Listener failed with error",o)}},this.on=(e,t)=>{var n;return((n=this.subscribers)[e]??(n[e]=[])).push(t),()=>{this.off(e,t)}},this.off=(e,t)=>{this.subscribers[e]=(this.subscribers[e]||[]).filter(n=>n!==t)},this.offAll=e=>{e?this.subscribers[e]=[]:this.subscribers={}}}},Go=class{constructor(){this.subscriberCandidates=new ms,this.publisherCandidates=new ms,this.logger=ie(["sfu-client"]),this.push=e=>{e.peerType===Ee.SUBSCRIBER?this.subscriberCandidates.next(e):e.peerType===Ee.PUBLISHER_UNSPECIFIED?this.publisherCandidates.next(e):this.logger("warn","ICETrickle, Unknown peer type",e)}}};function bd(i){if(i.usernameFragment)return JSON.stringify(i.toJSON());{let e=i.candidate.split(" "),t=e.findIndex(s=>s==="ufrag")+1,n=e[t];return JSON.stringify(L(E({},i),{usernameFragment:n}))}}var Kf,zf,Xf,Yf;var Jo=()=>Kf;var vc=()=>zf;var Qf=()=>Xf,Zf=()=>Yf;var Yu=()=>{if(ue())return{sdk:Jo(),os:vc(),device:Qf()};let i=new ld.UAParser(navigator.userAgent),{browser:e,os:t,device:n,cpu:s}=i.getResult();return{sdk:Jo(),browser:{name:e.name||navigator.userAgent,version:e.version||""},os:{name:t.name||"",version:t.version||"",architecture:s.architecture||""},device:{name:[n.vendor,n.model,n.type].filter(Boolean).join(" "),version:""}}},yd=125e4,ep={bitrate:yd,width:1280,height:720},tp={q:3e5,h:75e4,f:yd},Qu=(i,e=ep)=>{let t=[],n=i.getSettings(),{width:s=0,height:r=0}=n,o=ue()&&vc()?.name.toLowerCase()==="ios",a=ip(e,s,r),l=1;return["f","h","q"].forEach(c=>{t.unshift({active:!0,rid:c,width:Math.round(s/l),height:Math.round(r/l),maxBitrate:Math.round(a/l)||tp[c],scaleResolutionDownBy:l,maxFramerate:{f:30,h:o?30:25,q:o?30:20}[c]}),l*=2}),np(n,t)},ip=(i,e,t)=>{let{width:n,height:s}=i;if(e<n||t<s){let r=e*t,o=n*s,a=r/o;return Math.round(i.bitrate*a)}return i.bitrate},np=(i,e)=>{let t,n=Math.max(i.width||0,i.height||0);n<=320?t=e.filter(r=>r.rid==="f"):n<=640?t=e.filter(r=>r.rid!=="h"):t=e;let s=["q","h","f"];return t.map((r,o)=>L(E({},r),{rid:s[o]}))},Zu=(i,e,t=3e6)=>{let n=i.getSettings();return[{active:!0,rid:"q",width:n.width||0,height:n.height||0,scaleResolutionDownBy:1,maxBitrate:e?.maxBitrate??t,maxFramerate:e?.maxFramerate??30}]},sp=i=>{switch(i){case T.SCREEN_SHARE:return"screenShareStream";case T.SCREEN_SHARE_AUDIO:return"screenShareAudioStream";case T.VIDEO:return"videoStream";case T.AUDIO:return"audioStream";case T.UNSPECIFIED:throw new Error("Track type is unspecified");default:let e=i;throw new Error(`Unknown track type: ${e}`)}},rp=i=>{switch(i){case"audio":return T.AUDIO;case"video":return T.VIDEO;case"screenshare":return T.SCREEN_SHARE;case"screenshare_audio":return T.SCREEN_SHARE_AUDIO;default:let e=i;throw new Error(`Unknown mute type: ${e}`)}},Ko=Sd(op),ed=Sd(cp),Ai=new Map;function ap(i){return b(this,null,function*(){yield Ai.get(i)?.promise})}function Sd(i){return function(t,n){let{cb:s,onContinued:r}=i(t,n),o=Ai.get(t);o?.onContinued();let a=o?o.promise.then(s,s):s();return Ai.set(t,{promise:a,onContinued:r}),a}}function op(i,e){let t=!1;return{cb:()=>e().finally(()=>{t||Ai.delete(i)}),onContinued:()=>t=!0}}function cp(i,e){let t=new AbortController;return{cb:()=>t.signal.aborted?Promise.resolve("canceled"):e(t.signal).finally(()=>{t.signal.aborted||Ai.delete(i)}),onContinued:()=>t.abort()}}var lp=i=>typeof i=="function",Je=i=>{let e,t;if(Nt([i]).subscribe({next:([n])=>{e=n},error:n=>{t=n}}).unsubscribe(),t)throw t;return e},ts=(i,e)=>{let t=lp(e)?e(Je(i)):e;return i.next(t),t},Oe=(i,e)=>{let t=i.subscribe(e);return()=>{t.unsubscribe()}};var bt=(...i)=>(e,t)=>{for(let n of i){let s=n(e,t);if(s!==0)return s}return 0};var kd=i=>e=>(t,n)=>i(t,n)?e(t,n):0;var qt=i=>i.publishedTracks.includes(T.VIDEO),$n=i=>i.publishedTracks.includes(T.AUDIO),Et=i=>i.publishedTracks.includes(T.SCREEN_SHARE),up=i=>i.publishedTracks.includes(T.SCREEN_SHARE_AUDIO);var is=(i,e)=>i.isDominantSpeaker&&!e.isDominantSpeaker?-1:!i.isDominantSpeaker&&e.isDominantSpeaker?1:0,ns=(i,e)=>i.isSpeaking&&!e.isSpeaking?-1:!i.isSpeaking&&e.isSpeaking?1:0,Cd=(i,e)=>Et(i)&&!Et(e)?-1:!Et(i)&&Et(e)?1:0,ss=(i,e)=>qt(i)&&!qt(e)?-1:!qt(i)&&qt(e)?1:0,rs=(i,e)=>$n(i)&&!$n(e)?-1:!$n(i)&&$n(e)?1:0,Tc=(i,e)=>{if(i.pin&&e.pin){if(!i.pin.isLocalPin&&e.pin.isLocalPin)return-1;if(i.pin.isLocalPin&&!e.pin.isLocalPin)return 1;if(i.pin.pinnedAt>e.pin.pinnedAt)return-1;if(i.pin.pinnedAt<e.pin.pinnedAt)return 1}return i.pin&&!e.pin?-1:!i.pin&&e.pin?1:0},as=i=>(e,t)=>e.reaction?.type===i&&t.reaction?.type!==i?-1:e.reaction?.type!==i&&t.reaction?.type===i?1:0,dp=(...i)=>(e,t)=>Wn(e,i)&&!Wn(t,i)?-1:!Wn(e,i)&&Wn(t,i)?1:0;var Wn=(i,e)=>(i.roles||[]).some(t=>e.includes(t)),Rc=kd((i,e)=>i.viewportVisibilityState?.videoTrack===re.INVISIBLE||e.viewportVisibilityState?.videoTrack===re.INVISIBLE),hp=kd((i,e)=>i.viewportVisibilityState?.videoTrack===re.INVISIBLE||i.viewportVisibilityState?.videoTrack===re.UNKNOWN||e.viewportVisibilityState?.videoTrack===re.INVISIBLE||e.viewportVisibilityState?.videoTrack===re.UNKNOWN),Jn=bt(Tc,Cd,Rc(bt(is,ns,as("raised-hand"),ss,rs))),XC=bt(Tc,Cd,is,Rc(bt(ns,as("raised-hand"),ss,rs))),YC=bt(Tc,hp(bt(is,ns,as("raised-hand"),ss,rs))),td=bt(Rc(bt(is,ns,as("raised-hand"),ss,rs)),dp("admin","host","speaker")),N=function(i){return i.UNKNOWN="unknown",i.IDLE="idle",i.RINGING="ringing",i.JOINING="joining",i.JOINED="joined",i.LEFT="left",i.RECONNECTING="reconnecting",i.MIGRATING="migrating",i.RECONNECTING_FAILED="reconnecting-failed",i.OFFLINE="offline",i}(N||{}),ka={broadcasting:!1,hls:{playlist_url:""},rtmps:[]},zo=class{constructor(){this.backstageSubject=new F(!0),this.blockedUserIdsSubject=new F([]),this.createdAtSubject=new F(new Date),this.endedAtSubject=new F(void 0),this.startsAtSubject=new F(void 0),this.updatedAtSubject=new F(new Date),this.createdBySubject=new F(void 0),this.customSubject=new F({}),this.egressSubject=new F(void 0),this.ingressSubject=new F(void 0),this.recordingSubject=new F(!1),this.sessionSubject=new F(void 0),this.settingsSubject=new F(void 0),this.transcribingSubject=new F(!1),this.endedBySubject=new F(void 0),this.thumbnailsSubject=new F(void 0),this.membersSubject=new F([]),this.ownCapabilitiesSubject=new F([]),this.callingStateSubject=new F(N.UNKNOWN),this.startedAtSubject=new F(void 0),this.participantCountSubject=new F(0),this.anonymousParticipantCountSubject=new F(0),this.participantsSubject=new F([]),this.callStatsReportSubject=new F(void 0),this.logger=ie(["CallState"]),this.sortParticipantsBy=Jn,this.setSortParticipantsBy=n=>{this.sortParticipantsBy=n,this.setCurrentValue(this.participantsSubject,s=>s)},this.getCurrentValue=Je,this.setCurrentValue=ts,this.setParticipantCount=n=>this.setCurrentValue(this.participantCountSubject,n),this.setStartedAt=n=>this.setCurrentValue(this.startedAtSubject,n),this.setAnonymousParticipantCount=n=>this.setCurrentValue(this.anonymousParticipantCountSubject,n),this.setParticipants=n=>this.setCurrentValue(this.participantsSubject,n),this.setCallingState=n=>this.setCurrentValue(this.callingStateSubject,n),this.setCallStatsReport=n=>this.setCurrentValue(this.callStatsReportSubject,n),this.setMembers=n=>{this.setCurrentValue(this.membersSubject,n)},this.setOwnCapabilities=n=>this.setCurrentValue(this.ownCapabilitiesSubject,n),this.findParticipantBySessionId=n=>this.participants.find(s=>s.sessionId===n),this.getParticipantLookupBySessionId=()=>this.participants.reduce((n,s)=>(n[s.sessionId]=s,n),{}),this.updateParticipant=(n,s)=>{let r=this.findParticipantBySessionId(n);if(!r){this.logger("warn",`Participant with sessionId ${n} not found`);return}let o=typeof s=="function"?s(r):s,a=E(E({},r),o);return this.setParticipants(l=>l.map(c=>c.sessionId===n?a:c))},this.updateOrAddParticipant=(n,s)=>this.setParticipants(r=>{let o=!0,a=r.map(l=>l.sessionId===n?(o=!1,E(E({},l),s)):l);return o&&a.push(s),a}),this.updateParticipants=n=>{if(Object.keys(n).length!==0)return this.setParticipants(s=>s.map(r=>{let o=n[r.sessionId];return o?E(E({},r),o):r}))},this.updateFromEvent=n=>{let s=this.eventHandlers[n.type];s&&s(n)},this.setServerSidePins=n=>{let s=n.reduce((r,o)=>(r[o.sessionId]=Date.now(),r),{});return this.setParticipants(r=>r.map(o=>{let a=s[o.sessionId];return a?L(E({},o),{pin:{isLocalPin:!1,pinnedAt:a}}):o.pin&&!o.pin.isLocalPin?L(E({},o),{pin:void 0}):o}))},this.updateFromCallResponse=n=>{this.setCurrentValue(this.backstageSubject,n.backstage),this.setCurrentValue(this.blockedUserIdsSubject,n.blocked_user_ids),this.setCurrentValue(this.createdAtSubject,new Date(n.created_at)),this.setCurrentValue(this.updatedAtSubject,new Date(n.updated_at)),this.setCurrentValue(this.startsAtSubject,n.starts_at?new Date(n.starts_at):void 0),this.setCurrentValue(this.endedAtSubject,n.ended_at?new Date(n.ended_at):void 0),this.setCurrentValue(this.createdBySubject,n.created_by),this.setCurrentValue(this.customSubject,n.custom),this.setCurrentValue(this.egressSubject,n.egress),this.setCurrentValue(this.ingressSubject,n.ingress),this.setCurrentValue(this.recordingSubject,n.recording),this.setCurrentValue(this.sessionSubject,n.session),this.setCurrentValue(this.settingsSubject,n.settings),this.setCurrentValue(this.transcribingSubject,n.transcribing),this.setCurrentValue(this.thumbnailsSubject,n.thumbnails)},this.updateFromMemberRemoved=n=>{this.updateFromCallResponse(n.call),this.setCurrentValue(this.membersSubject,s=>s.filter(r=>n.members.indexOf(r.user_id)===-1))},this.updateFromMemberAdded=n=>{this.updateFromCallResponse(n.call),this.setCurrentValue(this.membersSubject,s=>[...s,...n.members])},this.updateFromHLSBroadcastStopped=()=>{this.setCurrentValue(this.egressSubject,(n=ka)=>L(E({},n),{broadcasting:!1}))},this.updateFromHLSBroadcastingFailed=()=>{this.setCurrentValue(this.egressSubject,(n=ka)=>L(E({},n),{broadcasting:!1}))},this.updateFromHLSBroadcastStarted=n=>{this.setCurrentValue(this.egressSubject,(s=ka)=>L(E({},s),{broadcasting:!0,hls:L(E({},s.hls),{playlist_url:n.hls_playlist_url})}))},this.updateFromSessionParticipantLeft=n=>{this.setCurrentValue(this.sessionSubject,s=>{if(!s)return this.logger("warn","Received call.session_participant_left event but no session is available.",n),s;let{participants:r,participants_count_by_role:o}=s,{user:a,user_session_id:l}=n.participant;return L(E({},s),{participants:r.filter(c=>c.user_session_id!==l),participants_count_by_role:L(E({},o),{[a.role]:Math.max(0,(o[a.role]||0)-1)})})})},this.updateFromSessionParticipantJoined=n=>{this.setCurrentValue(this.sessionSubject,s=>{if(!s)return this.logger("warn","Received call.session_participant_joined event but no session is available.",n),s;let{participants:r,participants_count_by_role:o}=s,{user:a,user_session_id:l}=n.participant,c=!0,u=r.map(d=>d.user_session_id===l?(c=!1,n.participant):d);c&&u.push(n.participant);let h=c?1:0;return L(E({},s),{participants:u,participants_count_by_role:L(E({},o),{[a.role]:(o[a.role]||0)+h})})})},this.updateMembers=n=>{this.updateFromCallResponse(n.call),this.setCurrentValue(this.membersSubject,s=>s.map(r=>{let o=n.members.find(a=>a.user_id===r.user_id);return o||r}))},this.updateParticipantReaction=n=>{let{user:s,custom:r,type:o,emoji_code:a}=n.reaction;this.setParticipants(l=>l.map(c=>c.userId!==s.id?c:L(E({},c),{reaction:{type:o,emoji_code:a,custom:r}})))},this.unblockUser=n=>{this.setCurrentValue(this.blockedUserIdsSubject,s=>s&&s.filter(r=>r!==n.user.id))},this.blockUser=n=>{this.setCurrentValue(this.blockedUserIdsSubject,s=>[...s||[],n.user.id])},this.updateOwnCapabilities=n=>{n.user.id===this.localParticipant?.userId&&this.setCurrentValue(this.ownCapabilitiesSubject,n.own_capabilities)},this.participants$=this.participantsSubject.asObservable().pipe(we(n=>n.sort(this.sortParticipantsBy)),ve({bufferSize:1,refCount:!0})),this.localParticipant$=this.participants$.pipe(we(n=>n.find(s=>s.isLocalParticipant)),ve({bufferSize:1,refCount:!0})),this.remoteParticipants$=this.participants$.pipe(we(n=>n.filter(s=>!s.isLocalParticipant)),ve({bufferSize:1,refCount:!0})),this.pinnedParticipants$=this.participants$.pipe(we(n=>n.filter(s=>!!s.pin)),ve({bufferSize:1,refCount:!0})),this.dominantSpeaker$=this.participants$.pipe(we(n=>n.find(s=>s.isDominantSpeaker)),ve({bufferSize:1,refCount:!0})),this.hasOngoingScreenShare$=this.participants$.pipe(we(n=>n.some(s=>Et(s))),pe(),ve({bufferSize:1,refCount:!0})),this.createdAt$=this.createdAtSubject.asObservable(),this.endedAt$=this.endedAtSubject.asObservable(),this.startsAt$=this.startsAtSubject.asObservable(),this.startedAt$=this.startedAtSubject.asObservable(),this.updatedAt$=this.updatedAtSubject.asObservable(),this.callStatsReport$=this.callStatsReportSubject.asObservable(),this.members$=this.membersSubject.asObservable(),this.createdBy$=this.createdBySubject.asObservable(),this.custom$=this.customSubject.asObservable(),this.egress$=this.egressSubject.asObservable(),this.ingress$=this.ingressSubject.asObservable(),this.session$=this.sessionSubject.asObservable(),this.settings$=this.settingsSubject.asObservable(),this.endedBy$=this.endedBySubject.asObservable(),this.thumbnails$=this.thumbnailsSubject.asObservable();let e=(n,s)=>{if(n.length!==s.length)return!1;for(let r of n)if(!s.includes(r))return!1;for(let r of s)if(!n.includes(r))return!1;return!0},t=(n,s)=>n.asObservable().pipe(pe(s));this.anonymousParticipantCount$=t(this.anonymousParticipantCountSubject),this.blockedUserIds$=t(this.blockedUserIdsSubject,e),this.backstage$=t(this.backstageSubject),this.callingState$=t(this.callingStateSubject),this.ownCapabilities$=t(this.ownCapabilitiesSubject,e),this.participantCount$=t(this.participantCountSubject),this.recording$=t(this.recordingSubject),this.transcribing$=t(this.transcribingSubject),this.eventHandlers={"call.closed_caption":void 0,"call.deleted":void 0,"call.permission_request":void 0,"call.recording_failed":void 0,"call.recording_ready":void 0,"call.transcription_ready":void 0,"call.user_muted":void 0,"connection.error":void 0,"connection.ok":void 0,"health.check":void 0,"user.banned":void 0,"user.deactivated":void 0,"user.deleted":void 0,"user.muted":void 0,"user.presence.changed":void 0,"user.reactivated":void 0,"user.unbanned":void 0,"user.updated":void 0,custom:void 0,"call.accepted":n=>this.updateFromCallResponse(n.call),"call.blocked_user":this.blockUser,"call.created":n=>this.updateFromCallResponse(n.call),"call.ended":n=>{this.updateFromCallResponse(n.call),this.setCurrentValue(this.endedBySubject,n.user)},"call.hls_broadcasting_failed":this.updateFromHLSBroadcastingFailed,"call.hls_broadcasting_started":this.updateFromHLSBroadcastStarted,"call.hls_broadcasting_stopped":this.updateFromHLSBroadcastStopped,"call.live_started":n=>this.updateFromCallResponse(n.call),"call.member_added":this.updateFromMemberAdded,"call.member_removed":this.updateFromMemberRemoved,"call.member_updated_permission":this.updateMembers,"call.member_updated":this.updateMembers,"call.notification":n=>{this.updateFromCallResponse(n.call),this.setMembers(n.members)},"call.permissions_updated":this.updateOwnCapabilities,"call.reaction_new":this.updateParticipantReaction,"call.recording_started":()=>this.setCurrentValue(this.recordingSubject,!0),"call.recording_stopped":()=>this.setCurrentValue(this.recordingSubject,!1),"call.rejected":n=>this.updateFromCallResponse(n.call),"call.ring":n=>this.updateFromCallResponse(n.call),"call.missed":n=>this.updateFromCallResponse(n.call),"call.session_ended":n=>this.updateFromCallResponse(n.call),"call.session_participant_joined":this.updateFromSessionParticipantJoined,"call.session_participant_left":this.updateFromSessionParticipantLeft,"call.session_started":n=>this.updateFromCallResponse(n.call),"call.transcription_started":()=>{this.setCurrentValue(this.transcribingSubject,!0)},"call.transcription_stopped":()=>{this.setCurrentValue(this.transcribingSubject,!1)},"call.transcription_failed":()=>{this.setCurrentValue(this.transcribingSubject,!1)},"call.unblocked_user":this.unblockUser,"call.updated":n=>this.updateFromCallResponse(n.call)}}get participantCount(){return this.getCurrentValue(this.participantCount$)}get startedAt(){return this.getCurrentValue(this.startedAt$)}get anonymousParticipantCount(){return this.getCurrentValue(this.anonymousParticipantCount$)}get participants(){return this.getCurrentValue(this.participants$)}get localParticipant(){return this.getCurrentValue(this.localParticipant$)}get remoteParticipants(){return this.getCurrentValue(this.remoteParticipants$)}get dominantSpeaker(){return this.getCurrentValue(this.dominantSpeaker$)}get pinnedParticipants(){return this.getCurrentValue(this.pinnedParticipants$)}get hasOngoingScreenShare(){return this.getCurrentValue(this.hasOngoingScreenShare$)}get callingState(){return this.getCurrentValue(this.callingState$)}get callStatsReport(){return this.getCurrentValue(this.callStatsReport$)}get members(){return this.getCurrentValue(this.members$)}get ownCapabilities(){return this.getCurrentValue(this.ownCapabilities$)}get backstage(){return this.getCurrentValue(this.backstage$)}get blockedUserIds(){return this.getCurrentValue(this.blockedUserIds$)}get createdAt(){return this.getCurrentValue(this.createdAt$)}get endedAt(){return this.getCurrentValue(this.endedAt$)}get startsAt(){return this.getCurrentValue(this.startsAt$)}get updatedAt(){return this.getCurrentValue(this.updatedAt$)}get createdBy(){return this.getCurrentValue(this.createdBy$)}get custom(){return this.getCurrentValue(this.custom$)}get egress(){return this.getCurrentValue(this.egress$)}get ingress(){return this.getCurrentValue(this.ingress$)}get recording(){return this.getCurrentValue(this.recording$)}get session(){return this.getCurrentValue(this.session$)}get settings(){return this.getCurrentValue(this.settings$)}get transcribing(){return this.getCurrentValue(this.transcribing$)}get endedBy(){return this.getCurrentValue(this.endedBy$)}get thumbnails(){return this.getCurrentValue(this.thumbnails$)}},Xo=class{constructor(){this.connectedUserSubject=new F(void 0),this.callsSubject=new F([]),this.getCurrentValue=Je,this.setCurrentValue=ts,this.setConnectedUser=e=>this.setCurrentValue(this.connectedUserSubject,e),this.setCalls=e=>this.setCurrentValue(this.callsSubject,e),this.registerCall=e=>{this.calls.find(t=>t.cid===e.cid)||this.setCalls(t=>[...t,e])},this.unregisterCall=e=>this.setCalls(t=>t.filter(n=>n!==e)),this.findCall=(e,t)=>this.calls.find(n=>n.type===e&&n.id===t),this.connectedUserSubject.subscribe(e=>b(this,null,function*(){if(!e){let t=ie(["client-state"]);for(let n of this.calls)n.state.callingState!==N.LEFT&&(t("info",`User disconnected, leaving call: ${n.cid}`),yield n.leave({reason:"client.disconnectUser() called"}).catch(s=>{t("error",`Error leaving call: ${n.cid}`,s)}))}}))}get connectedUser(){return this.getCurrentValue(this.connectedUserSubject)}get calls(){return this.getCurrentValue(this.callsSubject)}},Yo=class{constructor(e){this.getCurrentValue=Je,this.connectedUser$=e.connectedUserSubject.asObservable(),this.calls$=e.callsSubject.asObservable()}get connectedUser(){return Je(this.connectedUser$)}get calls(){return Je(this.calls$)}},fp=i=>{let t=/^a=rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/.exec(i);if(t)return{original:t[0],payload:t[1],codec:t[2]}},pp=i=>{let t=/^a=fmtp:(\d*) (.*)/.exec(i);if(t)return{original:t[0],payload:t[1],config:t[2]}},mp=(i,e)=>{let n=new RegExp(`(m=${e} \\d+ [\\w/]+) ([\\d\\s]+)`).exec(i);if(n)return{original:n[0],mediaWithPorts:n[1],codecOrder:n[2]}},gp=(i,e)=>{let t,n=[],s=[],r=!1;if(i.split(/(\r\n|\r|\n)/).forEach(o=>{if(!/^([a-z])=(.*)/.test(o))return;let l=o[0];if(l==="m"){let c=mp(o,e);r=!!c,c&&(t=c)}else if(r&&l==="a"){let c=fp(o),u=pp(o);c?n.push(c):u&&s.push(u)}}),t)return{media:t,rtpMap:n,fmtp:s}},bp=i=>{let e=gp(i,"audio"),n=e?.rtpMap.find(s=>s.codec.toLowerCase()==="opus")?.payload;if(n)return e?.fmtp.find(s=>s.payload===n)},yp=(i,e)=>{let t=bp(i);if(t){let n=/usedtx=(\d)/.exec(t.config),s=`usedtx=${e?"1":"0"}`;if(n){let r=t.original.replace(/usedtx=(\d)/,s);return i.replace(t.original,r)}else{let r=`${t.original};${s}`;return i.replace(t.original,r)}}return i},Sp=(i,e,t=51e4)=>{t=Math.max(Math.min(t,51e4),96e3);let n=Fi.parse(i),s=n.media.find(a=>a.type==="audio"&&String(a.mid)===e);if(!s)return i;let r=s.rtp.find(a=>a.codec==="opus");if(!r)return i;let o=s.fmtp.find(a=>a.payload===r.payload);return o?(o.config.match(/stereo=(\d)/)?o.config=o.config.replace(/stereo=(\d)/,"stereo=1"):o.config=`${o.config};stereo=1`,o.config.match(/maxaveragebitrate=(\d*)/)?o.config=o.config.replace(/maxaveragebitrate=(\d*)/,`maxaveragebitrate=${t}`):o.config=`${o.config};maxaveragebitrate=${t}`,Fi.write(n)):i},j=ie(["Publisher"]),Qo=class{get connectionConfiguration(){return this.pc.getConfiguration?this.pc.getConfiguration():this._connectionConfiguration}constructor({connectionConfig:e,sfuClient:t,dispatcher:n,state:s,isDtxEnabled:r,isRedEnabled:o,iceRestartDelay:a=2500,onUnrecoverableError:l}){this.transceiverRegistry={[T.AUDIO]:void 0,[T.VIDEO]:void 0,[T.SCREEN_SHARE]:void 0,[T.SCREEN_SHARE_AUDIO]:void 0,[T.UNSPECIFIED]:void 0},this.publishOptionsPerTrackType=new Map,this.transceiverInitOrder=[],this.trackKindMapping={[T.AUDIO]:"audio",[T.VIDEO]:"video",[T.SCREEN_SHARE]:"video",[T.SCREEN_SHARE_AUDIO]:"audio",[T.UNSPECIFIED]:void 0},this.trackLayersCache={[T.AUDIO]:void 0,[T.VIDEO]:void 0,[T.SCREEN_SHARE]:void 0,[T.SCREEN_SHARE_AUDIO]:void 0,[T.UNSPECIFIED]:void 0},this.isIceRestarting=!1,this.createPeerConnection=c=>{let u=new RTCPeerConnection(c);return this._connectionConfiguration=c,u.addEventListener("icecandidate",this.onIceCandidate),u.addEventListener("negotiationneeded",this.onNegotiationNeeded),u.addEventListener("icecandidateerror",this.onIceCandidateError),u.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),u.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),u.addEventListener("signalingstatechange",this.onSignalingStateChange),u},this.close=({stopTracks:c=!0}={})=>{c&&(this.stopPublishing(),Object.keys(this.transceiverRegistry).forEach(u=>{this.transceiverRegistry[u]=void 0}),Object.keys(this.trackLayersCache).forEach(u=>{this.trackLayersCache[u]=void 0})),clearTimeout(this.iceRestartTimeout),this.unsubscribeOnIceRestart(),this.pc.removeEventListener("negotiationneeded",this.onNegotiationNeeded),this.pc.close()},this.publishStream=(f,p,g,...v)=>b(this,[f,p,g,...v],function*(c,u,h,d={}){if(u.readyState==="ended")throw new Error("Can't publish a track that has ended already.");let k=this.pc.getTransceivers().find(P=>P===this.transceiverRegistry[h]&&P.sender.track&&P.sender.track?.kind===this.trackKindMapping[h]),_=()=>b(this,null,function*(){j("info",`Track ${T[h]} has ended, notifying the SFU`),yield this.notifyTrackMuteStateChanged(c,h,!0),u.removeEventListener("ended",_)});if(k){let P=k.sender.track;P&&P!==u&&(P.stop(),P.removeEventListener("ended",_),u.addEventListener("ended",_)),u.enabled||(u.enabled=!0),yield k.sender.replaceTrack(u)}else{let{settings:P}=this.state,A=P?.video.target_resolution,M=P?.screensharing.target_resolution?.bitrate,$=h===T.VIDEO?Qu(u,A):h===T.SCREEN_SHARE?Zu(u,d.screenShareSettings,M):void 0,Y=d.preferredCodec;if(!Y&&h===T.VIDEO&&ue()){let ze=vc()?.name.toLowerCase();ze==="ipados"?Y="H264":ze==="android"&&(Y="VP8")}let fe=this.getCodecPreferences(h,Y);if(u.addEventListener("ended",_),u.enabled||(u.enabled=!0),k=this.pc.addTransceiver(u,{direction:"sendonly",streams:h===T.VIDEO||h===T.SCREEN_SHARE?[c]:void 0,sendEncodings:$}),j("debug",`Added ${T[h]} transceiver`),this.transceiverInitOrder.push(h),this.transceiverRegistry[h]=k,this.publishOptionsPerTrackType.set(h,d),"setCodecPreferences"in k&&fe){j("info",`Setting ${T[h]} codec preferences`,fe);try{k.setCodecPreferences(fe)}catch(ze){j("warn","Couldn't set codec preferences",ze)}}}yield this.notifyTrackMuteStateChanged(c,h,!1)}),this.unpublishStream=(c,u)=>b(this,null,function*(){let h=this.pc.getTransceivers().find(d=>d===this.transceiverRegistry[c]&&d.sender.track);h&&h.sender.track&&(u?h.sender.track.readyState==="live":h.sender.track.enabled)&&(u?h.sender.track.stop():h.sender.track.enabled=!1,this.state.localParticipant?.publishedTracks.includes(c)&&(yield this.notifyTrackMuteStateChanged(void 0,c,!0)))}),this.isPublishing=c=>{let u=this.transceiverRegistry[c];if(u&&u.sender){let h=u.sender;return!!h.track&&h.track.readyState==="live"&&h.track.enabled}return!1},this.isLive=c=>{let u=this.transceiverRegistry[c];if(u&&u.sender){let h=u.sender;return!!h.track&&h.track.readyState==="live"}return!1},this.notifyTrackMuteStateChanged=(c,u,h)=>b(this,null,function*(){yield this.sfuClient.updateMuteState(u,h);let d=sp(u);h?this.state.updateParticipant(this.sfuClient.sessionId,f=>({publishedTracks:f.publishedTracks.filter(p=>p!==u),[d]:void 0})):this.state.updateParticipant(this.sfuClient.sessionId,f=>({publishedTracks:f.publishedTracks.includes(u)?f.publishedTracks:[...f.publishedTracks,u],[d]:c}))}),this.stopPublishing=()=>{j("debug","Stopping publishing all tracks"),this.pc.getSenders().forEach(c=>{c.track?.stop(),this.pc.signalingState!=="closed"&&this.pc.removeTrack(c)})},this.updateVideoPublishQuality=c=>b(this,null,function*(){j("info","Update publish quality, requested layers by SFU:",c);let u=this.transceiverRegistry[T.VIDEO]?.sender;if(!u){j("warn","Update publish quality, no video sender found.");return}let h=u.getParameters();if(h.encodings.length===0){j("warn","Update publish quality, No suitable video encoding quality found");return}let d=!1,f=c.filter(g=>g.active).map(g=>g.name);h.encodings.forEach(g=>{let v=f.includes(g.rid);if(v!==g.active&&(g.active=v,d=!0),v){let k=c.find(_=>_.name===g.rid);k!==void 0&&(k.scaleResolutionDownBy>=1&&k.scaleResolutionDownBy!==g.scaleResolutionDownBy&&(j("debug","[dynascale]: setting scaleResolutionDownBy from server","layer",k.name,"scale-resolution-down-by",k.scaleResolutionDownBy),g.scaleResolutionDownBy=k.scaleResolutionDownBy,d=!0),k.maxBitrate>0&&k.maxBitrate!==g.maxBitrate&&(j("debug","[dynascale] setting max-bitrate from the server","layer",k.name,"max-bitrate",k.maxBitrate),g.maxBitrate=k.maxBitrate,d=!0),k.maxFramerate>0&&k.maxFramerate!==g.maxFramerate&&(j("debug","[dynascale]: setting maxFramerate from server","layer",k.name,"max-framerate",k.maxFramerate),g.maxFramerate=k.maxFramerate,d=!0))}});let p=h.encodings.filter(g=>g.active);d?(yield u.setParameters(h),j("info","Update publish quality, enabled rids: ",p)):j("info","Update publish quality, no change: ",p)}),this.getStats=c=>this.pc.getStats(c),this.getCodecPreferences=(c,u)=>{if(c===T.VIDEO)return zu("video",u||"vp8");if(c===T.AUDIO){let h=this.isRedEnabled?"red":"opus",d=this.isRedEnabled?void 0:"red";return zu("audio",u??h,d)}},this.onIceCandidate=c=>{let{candidate:u}=c;if(!u){j("debug","null ice candidate");return}this.sfuClient.iceTrickle({iceCandidate:bd(u),peerType:Ee.PUBLISHER_UNSPECIFIED}).catch(h=>{j("warn","ICETrickle failed",h)})},this.setSfuClient=c=>{this.sfuClient=c},this.migrateTo=(c,u)=>b(this,null,function*(){this.sfuClient=c,this.pc.setConfiguration(u),this._connectionConfiguration=u,this.pc.iceConnectionState==="connected"&&(yield this.negotiate({iceRestart:!0}))}),this.restartIce=()=>b(this,null,function*(){j("debug","Restarting ICE connection");let c=this.pc.signalingState;if(this.isIceRestarting||c==="have-local-offer"){j("debug","ICE restart is already in progress");return}yield this.negotiate({iceRestart:!0})}),this.onNegotiationNeeded=()=>{this.negotiate().catch(c=>j("warn","Negotiation failed.",c))},this.negotiate=c=>b(this,null,function*(){this.isIceRestarting=c?.iceRestart??!1;let u=yield this.pc.createOffer(c),h=this.mungeCodecs(u.sdp);if(h&&this.isPublishing(T.SCREEN_SHARE_AUDIO)){let p=this.transceiverRegistry[T.SCREEN_SHARE_AUDIO];if(p&&p.sender.track){let g=p.mid??this.extractMid(h,p.sender.track,T.SCREEN_SHARE_AUDIO);h=Sp(h,g)}}u.sdp=h;let d=this.getCurrentTrackInfos(u.sdp);if(d.length===0)throw new Error("Can't initiate negotiation without announcing any tracks");yield this.pc.setLocalDescription(u);let{response:f}=yield this.sfuClient.setPublisher({sdp:u.sdp||"",tracks:d});try{yield this.pc.setRemoteDescription({type:"answer",sdp:f.sdp})}catch(p){j("error","setRemoteDescription error",{sdp:f.sdp,error:p})}this.isIceRestarting=!1,this.sfuClient.iceTrickleBuffer.publisherCandidates.subscribe(p=>b(this,null,function*(){try{let g=JSON.parse(p.iceCandidate);yield this.pc.addIceCandidate(g)}catch(g){j("warn","ICE candidate error",[g,p])}}))}),this.mungeCodecs=c=>(c&&(c=yp(c,this.isDtxEnabled)),c),this.extractMid=(c,u,h)=>{if(!c)return j("warn","No SDP found. Returning empty mid"),"";j("debug","No 'mid' found for track. Trying to find it from the Offer SDP");let f=Fi.parse(c).media.find(p=>p.type===u.kind&&(p.msid?.includes(u.id)??!0));if(typeof f?.mid>"u"){j("debug",`No mid found in SDP for track type ${u.kind} and id ${u.id}. Attempting to find a heuristic mid`);let p=this.transceiverInitOrder.indexOf(h);return p!==-1?String(p):(j("debug","No heuristic mid found. Returning empty mid"),"")}return String(f.mid)},this.getCurrentTrackInfos=c=>{c=c||this.pc.localDescription?.sdp;let{settings:u}=this.state,h=u?.video.target_resolution;return this.pc.getTransceivers().filter(d=>d.direction==="sendonly"&&d.sender.track).map(d=>{let f=Number(Object.keys(this.transceiverRegistry).find(A=>this.transceiverRegistry[A]===d)),p=d.sender.track,g;if(p.readyState==="live"){let A=this.publishOptionsPerTrackType.get(f);g=f===T.VIDEO?Qu(p,h):f===T.SCREEN_SHARE?Zu(p,A?.screenShareSettings):[],this.trackLayersCache[f]=g}else g=this.trackLayersCache[f]||[],j("debug",`Track ${T[f]} is ended. Announcing last known optimal layers`,g);let v=g.map(A=>({rid:A.rid||"",bitrate:A.maxBitrate||0,fps:A.maxFramerate||0,quality:this.ridToVideoQuality(A.rid||""),videoDimension:{width:A.width,height:A.height}})),k=[T.AUDIO,T.SCREEN_SHARE_AUDIO].includes(f),_=p.getSettings(),P=k&&_.channelCount===2;return{trackId:p.id,layers:v,trackType:f,mid:d.mid??this.extractMid(c,p,f),stereo:P,dtx:k&&this.isDtxEnabled,red:k&&this.isRedEnabled}})},this.onIceCandidateError=c=>{let u=c instanceof RTCPeerConnectionIceErrorEvent&&`${c.errorCode}: ${c.errorText}`,h=this.pc.iceConnectionState;j(h==="connected"||h==="checking"?"debug":"warn","ICE Candidate error",u)},this.onIceConnectionStateChange=()=>{let c=this.pc.iceConnectionState;j("debug","ICE Connection state changed to",c);let u=this.state.callingState!==N.OFFLINE;c==="failed"?(j("debug","Attempting to restart ICE"),this.restartIce().catch(h=>{j("error","ICE restart error",h),this.onUnrecoverableError?.()})):c==="disconnected"&&u&&(j("debug",`Scheduling ICE restart in ${this.iceRestartDelay} ms.`),this.iceRestartTimeout=setTimeout(()=>{this.pc.iceConnectionState==="disconnected"||this.pc.iceConnectionState==="failed"?this.restartIce().catch(h=>{j("error","ICE restart error",h),this.onUnrecoverableError?.()}):j("debug","Scheduled ICE restart: connection recovered, canceled.")},this.iceRestartDelay))},this.onIceGatheringStateChange=()=>{j("debug","ICE Gathering State",this.pc.iceGatheringState)},this.onSignalingStateChange=()=>{j("debug","Signaling state changed",this.pc.signalingState)},this.ridToVideoQuality=c=>c==="q"?Gt.LOW_UNSPECIFIED:c==="h"?Gt.MID:Gt.HIGH,this.pc=this.createPeerConnection(e),this.sfuClient=t,this.state=s,this.isDtxEnabled=r,this.isRedEnabled=o,this.iceRestartDelay=a,this.onUnrecoverableError=l,this.unsubscribeOnIceRestart=n.on("iceRestart",c=>{c.peerType===Ee.PUBLISHER_UNSPECIFIED&&this.restartIce().catch(u=>{j("warn","ICERestart failed",u),this.onUnrecoverableError?.()})})}},X=ie(["Subscriber"]),Zo=class{get connectionConfiguration(){return this.pc.getConfiguration?this.pc.getConfiguration():this._connectionConfiguration}constructor({sfuClient:e,dispatcher:t,state:n,connectionConfig:s,iceRestartDelay:r=2500,onUnrecoverableError:o}){this.isIceRestarting=!1,this.createPeerConnection=a=>{let l=new RTCPeerConnection(a);return this._connectionConfiguration=a,l.addEventListener("icecandidate",this.onIceCandidate),l.addEventListener("track",this.handleOnTrack),l.addEventListener("icecandidateerror",this.onIceCandidateError),l.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),l.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),l},this.close=()=>{clearTimeout(this.iceRestartTimeout),this.unregisterOnSubscriberOffer(),this.unregisterOnIceRestart(),this.pc.close()},this.getStats=a=>this.pc.getStats(a),this.setSfuClient=a=>{this.sfuClient=a},this.migrateTo=(a,l)=>{this.setSfuClient(a);let c=this.pc,u=new Set;c.getReceivers().forEach(v=>{v.track.kind==="video"&&u.add(v.track.id)});let h=this.createPeerConnection(l),d,f=()=>{c.close(),clearTimeout(d)},p=v=>{X("debug",`[Migration]: Migrated track: ${v.track.id}, ${v.track.kind}`),u.delete(v.track.id),u.size===0&&(X("debug","[Migration]: Migration complete"),h.removeEventListener("track",p),f())},g=()=>{h.connectionState==="connected"&&(d=setTimeout(()=>{h.removeEventListener("track",p),f()},2e3),h.removeEventListener("connectionstatechange",g))};h.addEventListener("track",p),h.addEventListener("connectionstatechange",g),this.pc=h},this.restartIce=()=>b(this,null,function*(){if(X("debug","Restarting ICE connection"),this.pc.signalingState==="have-remote-offer"){X("debug","ICE restart is already in progress");return}if(this.pc.connectionState==="new"){X("debug","ICE connection is not yet established, skipping restart.");return}let a=this.isIceRestarting;try{this.isIceRestarting=!0,yield this.sfuClient.iceRestart({peerType:Ee.SUBSCRIBER})}catch(l){throw this.isIceRestarting=a,l}}),this.handleOnTrack=a=>{let[l]=a.streams,[c,u]=l.id.split(":"),h=this.state.participants.find(g=>g.trackLookupPrefix===c);if(X("debug",`[onTrack]: Got remote ${u} track for userId: ${h?.userId}`,a.track.id,a.track),!h){X("warn",`[onTrack]: Received track for unknown participant: ${c}`,a);return}let d=`${h.userId} ${u}:${c}`;a.track.addEventListener("mute",()=>{X("info",`[onTrack]: Track muted: ${d}`)}),a.track.addEventListener("unmute",()=>{X("info",`[onTrack]: Track unmuted: ${d}`)}),a.track.addEventListener("ended",()=>{X("info",`[onTrack]: Track ended: ${d}`)});let f={TRACK_TYPE_AUDIO:"audioStream",TRACK_TYPE_VIDEO:"videoStream",TRACK_TYPE_SCREEN_SHARE:"screenShareStream",TRACK_TYPE_SCREEN_SHARE_AUDIO:"screenShareAudioStream"}[u];if(!f){X("error",`Unknown track type: ${u}`);return}let p=h[f];p&&(X("info",`[onTrack]: Cleaning up previous remote ${a.track.kind} tracks for userId: ${h.userId}`),p.getTracks().forEach(g=>{g.stop(),p.removeTrack(g)})),this.state.updateParticipant(h.sessionId,{[f]:l})},this.onIceCandidate=a=>{let{candidate:l}=a;if(!l){X("debug","null ice candidate");return}this.sfuClient.iceTrickle({iceCandidate:bd(l),peerType:Ee.SUBSCRIBER}).catch(c=>{X("warn","ICETrickle failed",c)})},this.negotiate=a=>b(this,null,function*(){X("info","Received subscriberOffer",a),yield this.pc.setRemoteDescription({type:"offer",sdp:a.sdp}),this.sfuClient.iceTrickleBuffer.subscriberCandidates.subscribe(c=>b(this,null,function*(){try{let u=JSON.parse(c.iceCandidate);yield this.pc.addIceCandidate(u)}catch(u){X("warn","ICE candidate error",[u,c])}}));let l=yield this.pc.createAnswer();yield this.pc.setLocalDescription(l),yield this.sfuClient.sendAnswer({peerType:Ee.SUBSCRIBER,sdp:l.sdp||""}),this.isIceRestarting=!1}),this.onIceConnectionStateChange=()=>{let a=this.pc.iceConnectionState;if(X("debug","ICE connection state changed",a),this.isIceRestarting)return;let l=this.state.callingState!==N.OFFLINE;a==="failed"?(X("debug","Attempting to restart ICE"),this.restartIce().catch(c=>{X("error","ICE restart failed",c),this.onUnrecoverableError?.()})):a==="disconnected"&&l&&(X("debug",`Scheduling ICE restart in ${this.iceRestartDelay} ms.`),this.iceRestartTimeout=setTimeout(()=>{this.pc.iceConnectionState==="disconnected"||this.pc.iceConnectionState==="failed"?this.restartIce().catch(c=>{X("error","ICE restart failed",c),this.onUnrecoverableError?.()}):X("debug","Scheduled ICE restart: connection recovered, canceled.")},this.iceRestartDelay))},this.onIceGatheringStateChange=()=>{X("debug","ICE gathering state changed",this.pc.iceGatheringState)},this.onIceCandidateError=a=>{let l=a instanceof RTCPeerConnectionIceErrorEvent&&`${a.errorCode}: ${a.errorText}`,c=this.pc.iceConnectionState;X(c==="connected"||c==="checking"?"debug":"warn","ICE Candidate error",l)},this.sfuClient=e,this.state=n,this.iceRestartDelay=r,this.onUnrecoverableError=o,this.pc=this.createPeerConnection(s),this.unregisterOnSubscriberOffer=t.on("subscriberOffer",a=>{this.negotiate(a).catch(l=>{X("warn","Negotiation failed.",l)})}),this.unregisterOnIceRestart=t.on("iceRestart",a=>{a.peerType===Ee.SUBSCRIBER&&this.restartIce().catch(l=>{X("warn","ICERestart failed",l),this.onUnrecoverableError?.()})})}},kp=i=>{let e=ie(["sfu-client"]),{endpoint:t,onMessage:n}=i,s=new Dr(t);return s.binaryType="arraybuffer",s.addEventListener("error",r=>{e("error","Signaling WS channel error",r)}),s.addEventListener("close",r=>{e("info","Signaling WS channel is closed",r)}),s.addEventListener("open",r=>{e("info","Signaling WS channel is open",r)}),s.addEventListener("message",r=>{try{let o=r.data instanceof ArrayBuffer?Ju.fromBinary(new Uint8Array(r.data)):Ju.fromJsonString(r.data.toString());n(o)}catch(o){e("error","Failed to decode a message. Check whether the Proto models match.",{event:r,error:o})}}),s},Ke=i=>new Promise(e=>setTimeout(e,i));function ec(i){return i&&(Object.prototype.toString.call(i)==="[object Function]"||typeof i=="function"||i instanceof Function)}var st={TOKEN_EXPIRED:40,WS_CLOSED_SUCCESS:1e3,WS_CLOSED_ABRUPTLY:1006,WS_POLICY_VIOLATION:1008};function _t(i){let e=Math.min(500+i*2e3,5e3),t=Math.min(Math.max(250,(i-1)*2e3),5e3);return Math.floor(Math.random()*(e-t)+t)}function xi(){return wd()}function Oi(i){let e="";for(let t=0;t<i.length;t++)e+=i[t].toString(16).padStart(2,"0");return e}function wd(){let i=vp(16);return i[6]=i[6]&15|64,i[8]=i[8]&191|128,Oi(i.subarray(0,4))+"-"+Oi(i.subarray(4,6))+"-"+Oi(i.subarray(6,8))+"-"+Oi(i.subarray(8,10))+"-"+Oi(i.subarray(10,16))}function Cp(i){let e=Math.pow(2,8*i.byteLength/i.length);for(let t=0;t<i.length;t++)i[t]=Math.random()*e}var wp=typeof crypto<"u"&&typeof crypto?.getRandomValues<"u"?crypto.getRandomValues.bind(crypto):typeof msCrypto<"u"?msCrypto.getRandomValues.bind(msCrypto):Cp;function vp(i){let e=new Uint8Array(i);return wp(e),e}function Tp(i){let e={};if(!i)return e;try{Object.getOwnPropertyNames(i).forEach(t=>{e[t]=Object.getOwnPropertyDescriptor(i,t)})}catch{return{error:"failed to serialize the error"}}return e}function Rp(i){let e=typeof navigator<"u"?navigator:typeof window<"u"&&window.navigator?window.navigator:void 0;return e?typeof e.onLine!="boolean"?!0:e.onLine:(i("warn","isOnline failed to access window.navigator and assume browser is online"),!0)}function vd(i){typeof window<"u"&&window.addEventListener&&(window.addEventListener("offline",i),window.addEventListener("online",i))}function Td(i){typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("offline",i),window.removeEventListener("online",i))}var Tt=(()=>{class i{constructor({dispatcher:t,sfuServer:n,token:s,sessionId:r}){this.iceTrickleBuffer=new Go,this.isMigratingAway=!1,this.isFastReconnecting=!1,this.pingIntervalInMs=10*1e3,this.unhealthyTimeoutInMs=this.pingIntervalInMs+5*1e3,this.close=(a,l)=>{this.logger("debug",`Closing SFU WS connection: ${a} - ${l}`),this.signalWs.readyState!==this.signalWs.CLOSED&&this.signalWs.close(a,`js-client: ${l}`),this.unsubscribeIceTrickle(),clearInterval(this.keepAliveInterval),clearTimeout(this.connectionCheckTimeout)},this.updateSubscriptions=a=>b(this,null,function*(){return nt(()=>this.rpc.updateSubscriptions({sessionId:this.sessionId,tracks:a}),this.logger,"debug")}),this.setPublisher=a=>b(this,null,function*(){return nt(()=>this.rpc.setPublisher(L(E({},a),{sessionId:this.sessionId})),this.logger)}),this.sendAnswer=a=>b(this,null,function*(){return nt(()=>this.rpc.sendAnswer(L(E({},a),{sessionId:this.sessionId})),this.logger)}),this.iceTrickle=a=>b(this,null,function*(){return nt(()=>this.rpc.iceTrickle(L(E({},a),{sessionId:this.sessionId})),this.logger)}),this.iceRestart=a=>b(this,null,function*(){return nt(()=>this.rpc.iceRestart(L(E({},a),{sessionId:this.sessionId})),this.logger)}),this.updateMuteState=(a,l)=>b(this,null,function*(){return this.updateMuteStates({muteStates:[{trackType:a,muted:l}]})}),this.updateMuteStates=a=>b(this,null,function*(){return nt(()=>this.rpc.updateMuteStates(L(E({},a),{sessionId:this.sessionId})),this.logger)}),this.sendStats=a=>b(this,null,function*(){return nt(()=>this.rpc.sendStats(L(E({},a),{sessionId:this.sessionId})),this.logger,"debug")}),this.startNoiseCancellation=()=>b(this,null,function*(){return nt(()=>this.rpc.startNoiseCancellation({sessionId:this.sessionId}),this.logger)}),this.stopNoiseCancellation=()=>b(this,null,function*(){return nt(()=>this.rpc.stopNoiseCancellation({sessionId:this.sessionId}),this.logger)}),this.join=a=>b(this,null,function*(){let l=qn.create(L(E({},a),{sessionId:this.sessionId,token:this.token}));return this.send(Mn.create({requestPayload:{oneofKind:"joinRequest",joinRequest:l}}))}),this.send=a=>b(this,null,function*(){return this.signalReady.then(l=>{l.readyState===l.OPEN&&(this.logger("debug",`Sending message to: ${this.edgeName}`,Mn.toJson(a)),l.send(Mn.toBinary(a)))})}),this.keepAlive=()=>{clearInterval(this.keepAliveInterval),this.keepAliveInterval=setInterval(()=>{this.logger("trace","Sending healthCheckRequest to SFU");let a=Mn.create({requestPayload:{oneofKind:"healthCheckRequest",healthCheckRequest:{}}});this.send(a).catch(l=>{this.logger("error","Error sending healthCheckRequest to SFU",l)})},this.pingIntervalInMs)},this.scheduleConnectionCheck=()=>{clearTimeout(this.connectionCheckTimeout),this.connectionCheckTimeout=setTimeout(()=>{this.lastMessageTimestamp&&new Date().getTime()-this.lastMessageTimestamp.getTime()>this.unhealthyTimeoutInMs&&this.close(i.ERROR_CONNECTION_UNHEALTHY,`SFU connection unhealthy. Didn't receive any message for ${this.unhealthyTimeoutInMs}ms`)},this.unhealthyTimeoutInMs)},this.sessionId=r||wd(),this.sfuServer=n,this.edgeName=n.edge_name,this.token=s,this.logger=ie(["sfu-client"]);let o={interceptUnary:(a,l,c,u)=>(this.logger("trace",`Calling SFU RPC method ${l.name}`,{input:c,options:u}),a(l,c,u))};this.rpc=Wf({baseUrl:n.url,interceptors:[$f({Authorization:`Bearer ${s}`}),o]}),this.unsubscribeIceTrickle=t.on("iceTrickle",a=>{this.iceTrickleBuffer.push(a)}),this.signalWs=kp({endpoint:n.ws_endpoint,onMessage:a=>{this.lastMessageTimestamp=new Date,this.scheduleConnectionCheck(),t.dispatch(a)}}),this.signalReady=new Promise(a=>{let l=()=>{this.signalWs.removeEventListener("open",l),this.keepAlive(),a(this.signalWs)};this.signalWs.addEventListener("open",l)})}}return i.NORMAL_CLOSURE=1e3,i.ERROR_CONNECTION_UNHEALTHY=4001,i.ERROR_CONNECTION_BROKEN=4002,i})(),Ep=5,nt=(i,e,t="error")=>b(void 0,null,function*(){let n=0,s;do n>0&&(yield Ke(_t(n))),s=yield i(),s.response.error&&e(t,`SFU RPC Error (${s.method.name}):`,s.response.error),n++;while(s.response.error?.shouldRetry&&n<Ep);if(s.response.error)throw s.response.error;return s}),Ip=i=>function(t){return b(this,null,function*(){if(t.user.id===i.currentUserId)return;let{state:n}=i;t.call.created_by.id===i.currentUserId&&n.callingState===N.RINGING&&(yield i.join())})},_p=i=>function(t){return b(this,null,function*(){if(t.user.id===i.currentUserId)return;let{call:n}=t,{session:s}=n;if(!s){i.logger("warn","No call session provided. Ignoring call.rejected event.",t);return}let r=s.rejected_by,{members:o,callingState:a}=i.state;if(a!==N.RINGING){i.logger("info","Call is not in ringing mode (it is either accepted or rejected already). Ignoring call.rejected event.",t);return}i.isCreatedByMe?o.filter(c=>c.user_id!==i.currentUserId).every(c=>r[c.user_id])&&(i.logger("info","everyone rejected, leaving the call"),yield i.leave({reason:"ring: everyone rejected"})):r[n.created_by.id]&&(i.logger("info","call creator rejected, leaving call"),yield i.leave({reason:"ring: creator rejected"}))})},Pp=i=>function(){return b(this,null,function*(){let{callingState:t}=i.state;(t===N.RINGING||t===N.JOINED||t===N.JOINING)&&(yield i.leave({reason:"call.ended event received"}))})},Np=i=>function(t){let{currentGrants:n}=t;if(n){let{canPublishAudio:s,canPublishVideo:r,canScreenshare:o}=n,a={[xe.SEND_AUDIO]:s,[xe.SEND_VIDEO]:r,[xe.SCREENSHARE]:o},l=i.ownCapabilities.filter(c=>a[c]!==!1);Object.entries(a).forEach(([c,u])=>{u&&!l.includes(c)&&l.push(c)}),i.setOwnCapabilities(l)}},Rd=ie(["events"]),Op=(i,e)=>i.on("changePublishQuality",t=>{let{videoSenders:n}=t;n.forEach(s=>{let{layers:r}=s;e.updatePublishQuality(r.filter(o=>o.active))})}),xp=(i,e)=>i.on("connectionQualityChanged",t=>{let{connectionQualityUpdates:n}=t;n&&e.updateParticipants(n.reduce((s,r)=>{let{sessionId:o,connectionQuality:a}=r;return s[o]={connectionQuality:a},s},{}))}),Dp=(i,e)=>i.on("healthCheckResponse",t=>{let{participantCount:n}=t;n&&(e.setParticipantCount(n.total),e.setAnonymousParticipantCount(n.anonymous))}),Ap=(i,e)=>i.on("error",t=>{t.error&&t.error.code!==es.LIVE_ENDED||e.permissionsContext.hasPermission(xe.JOIN_BACKSTAGE)||e.leave({reason:"live ended"}).catch(n=>{Rd("error","Failed to leave call after live ended",n)})}),Up=i=>i.on("error",e=>{if(!e.error)return;let{error:t}=e;Rd("error","SFU reported error",{code:es[t.code],message:t.message,shouldRetry:t.shouldRetry})}),Lp=i=>function(t){let{pins:n}=t;i.setServerSidePins(n)},Fp=i=>i.on("trackUnpublished",e=>b(void 0,null,function*(){let{cause:t,type:n,sessionId:s}=e,{localParticipant:r}=i.state;if(t===wc.MODERATION&&s===r?.sessionId){let o=i.logger;o("info",`Local participant's ${T[n]} track is muted remotely`);try{n===T.VIDEO?yield i.camera.disable():n===T.AUDIO?yield i.microphone.disable():o("warn","Unsupported track type to soft mute",T[n]),i.publisher?.isPublishing(n)&&(yield i.stopPublish(n))}catch(a){o("error","Failed to stop publishing",a)}}})),Bp=i=>function(t){let{participant:n}=t;n&&i.updateOrAddParticipant(n.sessionId,Object.assign(n,{viewportVisibilityState:{videoTrack:re.UNKNOWN,screenShareTrack:re.UNKNOWN}}))},Vp=i=>function(t){let{participant:n}=t;n&&i.setParticipants(s=>s.filter(r=>r.sessionId!==n.sessionId))},jp=i=>function(t){let{participant:n}=t;n&&i.updateParticipant(n.sessionId,n)},Mp=i=>function(t){let{type:n,sessionId:s,participant:r}=t;r?i.updateOrAddParticipant(s,r):i.updateParticipant(s,o=>({publishedTracks:[...o.publishedTracks,n].filter(Wp)}))},$p=i=>function(t){let{type:n,sessionId:s,participant:r}=t;r?i.updateOrAddParticipant(s,r):i.updateParticipant(s,o=>({publishedTracks:o.publishedTracks.filter(a=>a!==n)}))},Wp=(i,e,t)=>t.indexOf(i)===e,Hp=(i,e)=>i.on("dominantSpeakerChanged",t=>{let{sessionId:n}=t;n!==e.dominantSpeaker?.sessionId&&e.setParticipants(s=>s.map(r=>r.sessionId===n?L(E({},r),{isDominantSpeaker:!0}):r.isDominantSpeaker?L(E({},r),{isDominantSpeaker:!1}):r))}),qp=(i,e)=>i.on("audioLevelChanged",t=>{let{audioLevels:n}=t;e.updateParticipants(n.reduce((s,r)=>(s[r.sessionId]={audioLevel:r.level,isSpeaking:r.isSpeaking},s),{}))}),Gp=(i,e,t)=>{let n=[i.on("call.ended",Pp(i)),Ap(t,i),Up(t),Op(t,i),xp(t,e),Dp(t,e),i.on("participantJoined",Bp(e)),i.on("participantLeft",Vp(e)),i.on("participantUpdated",jp(e)),i.on("trackPublished",Mp(e)),i.on("trackUnpublished",$p(e)),qp(t,e),Hp(t,e),i.on("callGrantsUpdated",Np(e)),i.on("pinsUpdated",Lp(e)),Fp(i)];return i.ringing&&n.push(Ed(i)),()=>{n.forEach(s=>s())}},Ed=i=>{let e={"call.accepted":Ip(i),"call.rejected":_p(i)},t=Object.keys(e).map(n=>{let s=n;return i.on(s,e[s])});return()=>{t.forEach(n=>n())}},Jp=(i,e,t,n)=>b(void 0,null,function*(){let{call:s,credentials:r,members:o,own_capabilities:a,stats_options:l}=yield Kp(i,e,t,n);return{connectionConfig:zp(r.ice_servers),sfuServer:r.server,token:r.token,metadata:s,members:o,ownCapabilities:a,statsOptions:l}}),Kp=(i,e,t,n)=>b(void 0,null,function*(){let s=yield i.getLocationHint(),r=L(E({},n),{location:s});return i.post(`/call/${e}/${t}/join`,r)}),zp=i=>!i||i.length===0?void 0:{iceServers:i.map(t=>({urls:t.urls,username:t.username,credential:t.password}))},Kn=i=>{let e=[];return i.forEach(t=>{e.push(t)}),e},Xp=i=>{let r=i,{sdk:e}=r,t=ps(r,["sdk"]),n=Id(e),s=_d(e);return E({sdkName:n,sdkVersion:s},t)},Id=i=>i&&i.type===Di.REACT?"stream-react":i&&i.type===Di.REACT_NATIVE?"stream-react-native":"stream-js",_d=i=>i?`${i.major}.${i.minor}.${i.patch}`:"0.0.0-development",Yp=({subscriber:i,publisher:e,state:t,datacenter:n,pollingIntervalInMs:s=2e3})=>{let r=ie(["stats"]),o=(p,g)=>b(void 0,null,function*(){return p==="subscriber"&&i?i.getStats(g):p==="publisher"&&e?e.getStats(g):void 0}),a=(p,g)=>b(void 0,null,function*(){let v=p==="subscriber"?i:e;if(!v)return[];let k=[];for(let _ of g.getTracks()){let P=yield v.getStats(_),A=Ca(P,{trackKind:_.kind,kind:p});k.push(A)}return k}),l=p=>{u.add(p),h()},c=p=>{u.delete(p),h()},u=new Set,h=()=>b(void 0,null,function*(){let p={},g=new Set(u);if(g.size>0)for(let A of t.participants){if(!g.has(A.sessionId))continue;let M=A.isLocalParticipant?"publisher":"subscriber";try{let $=new MediaStream([...A.videoStream?.getVideoTracks()||[],...A.audioStream?.getAudioTracks()||[]]);p[A.sessionId]=yield a(M,$),$.getTracks().forEach(Y=>{$.removeTrack(Y)})}catch($){r("error",`Failed to collect stats for ${M} of ${A.userId}`,$)}}let[v,k]=yield Promise.all([i.getStats().then(A=>Ca(A,{kind:"subscriber",trackKind:"video"})).then(id),e?e.getStats().then(A=>Ca(A,{kind:"publisher",trackKind:"video"})).then(id):Pd()]),[_,P]=yield Promise.all([o("subscriber"),e?o("publisher"):void 0]);t.setCallStatsReport({datacenter:n,publisherStats:k,subscriberStats:v,subscriberRawStats:_,publisherRawStats:P,participants:p,timestamp:Date.now()})}),d;if(s>0){let p=()=>b(void 0,null,function*(){yield h().catch(g=>{r("debug","Failed to collect stats",g)}),d=setTimeout(p,s)});p()}return{getRawStatsForTrack:o,getStatsForStream:a,startReportingStatsFor:l,stopReportingStatsFor:c,stop:()=>{d&&clearTimeout(d)}}},Ca=(i,e)=>{let{trackKind:t,kind:n}=e,s=n==="subscriber"?"inbound-rtp":"outbound-rtp",r=Kn(i),o=r.filter(a=>a.type===s&&a.kind===t).map(a=>{let l=a,c=r.find(d=>d.type==="codec"&&d.id===l.codecId),u=r.find(d=>d.type==="transport"&&d.id===l.transportId),h;return u&&u.dtlsState==="connected"&&(h=r.find(f=>f.type==="candidate-pair"&&f.id===u.selectedCandidatePairId)?.currentRoundTripTime),{bytesSent:l.bytesSent,bytesReceived:l.bytesReceived,codec:c?.mimeType,currentRoundTripTime:h,frameHeight:l.frameHeight,frameWidth:l.frameWidth,framesPerSecond:l.framesPerSecond,jitter:l.jitter,kind:l.kind,qualityLimitationReason:l.qualityLimitationReason,rid:l.rid,ssrc:l.ssrc}});return{rawStats:i,streams:o,timestamp:Date.now()}},Pd=i=>({rawReport:i??{streams:[],timestamp:Date.now()},totalBytesSent:0,totalBytesReceived:0,averageJitterInMs:0,averageRoundTripTimeInMs:0,qualityLimitationReasons:"none",highestFrameWidth:0,highestFrameHeight:0,highestFramesPerSecond:0,timestamp:Date.now()}),id=i=>{let e=Pd(i),t=-1,n=(l,c)=>l*c,s=new Set,r=i.streams,o=r.reduce((l,c)=>{l.totalBytesSent+=c.bytesSent||0,l.totalBytesReceived+=c.bytesReceived||0,l.averageJitterInMs+=c.jitter||0,l.averageRoundTripTimeInMs+=c.currentRoundTripTime||0;let u=n(c.frameWidth||0,c.frameHeight||0);return u>t&&(l.highestFrameWidth=c.frameWidth||0,l.highestFrameHeight=c.frameHeight||0,l.highestFramesPerSecond=c.framesPerSecond||0,t=u),s.add(c.qualityLimitationReason||""),l},e);r.length>0&&(o.averageJitterInMs=Math.round(o.averageJitterInMs/r.length*1e3),o.averageRoundTripTimeInMs=Math.round(o.averageRoundTripTimeInMs/r.length*1e3));let a=[s.has("cpu")&&"cpu",s.has("bandwidth")&&"bandwidth",s.has("other")&&"other"].filter(Boolean).join(", ");return a&&(o.qualityLimitationReasons=a),o},tc=class{constructor(e,{options:t,clientDetails:n,subscriber:s,publisher:r}){this.logger=ie(["SfuStatsReporter"]),this.run=()=>b(this,null,function*(){let[c,u]=yield Promise.all([this.subscriber.getStats().then(Kn).then(JSON.stringify),this.publisher?.getStats().then(Kn).then(JSON.stringify)??"[]"]);yield this.sfuClient.sendStats({sdk:this.sdkName,sdkVersion:this.sdkVersion,webrtcVersion:this.webRTCVersion,subscriberStats:c,publisherStats:u})}),this.start=()=>{this.options.reporting_interval_ms<=0||(this.intervalId=setInterval(()=>{this.run().catch(c=>{this.logger("warn","Failed to report stats",c)})},this.options.reporting_interval_ms))},this.stop=()=>{clearInterval(this.intervalId),this.intervalId=void 0},this.sfuClient=e,this.options=t,this.subscriber=s,this.publisher=r;let o=Zf(),{sdk:a,browser:l}=n;this.sdkName=Id(a),this.sdkVersion=_d(a),this.webRTCVersion=o?.version||`${l?.name||""}-${l?.version||""}`||"N/A"}},Qp=.35,ic=class{constructor(){this.elementHandlerMap=new Map,this.observer=null,this.queueSet=new Set,this.setViewport=(e,t)=>{let n=()=>{this.observer?.disconnect(),this.observer=null,this.elementHandlerMap.clear()};return this.observer=new IntersectionObserver(s=>{s.forEach(r=>{this.elementHandlerMap.get(r.target)?.(r)})},L(E({root:e},t),{threshold:t?.threshold??Qp})),this.queueSet.size&&(this.queueSet.forEach(([s,r])=>{e.contains(s)&&(this.observer.observe(s),this.elementHandlerMap.set(s,r))}),this.queueSet.clear()),n},this.observe=(e,t)=>{let n=[e,t],s=()=>{this.elementHandlerMap.delete(e),this.observer?.unobserve(e),this.queueSet.delete(n)};return this.elementHandlerMap.has(e)?s:this.observer?(this.observer.root.contains(e)&&(this.elementHandlerMap.set(e,t),this.observer.observe(e)),s):(this.queueSet.add(n),s)}}},Zp=()=>typeof navigator>"u"?!1:/^((?!chrome|android).)*safari/i.test(navigator.userAgent||""),em=()=>typeof navigator>"u"?!1:navigator.userAgent?.includes("Firefox");var nd={videoTrack:re.UNKNOWN,screenShareTrack:re.UNKNOWN},nc=class{constructor(e){this.viewportTracker=new ic,this.logger=ie(["DynascaleManager"]),this.trackElementVisibility=(t,n,s)=>{let r=this.viewportTracker.observe(t,o=>{this.call.state.updateParticipant(n,a=>{let l=a.viewportVisibilityState??nd,c=o.isIntersecting||document.fullscreenElement===t?re.VISIBLE:re.INVISIBLE;return L(E({},a),{viewportVisibilityState:L(E({},l),{[s]:c})})})});return()=>{r(),this.call.state.updateParticipant(n,o=>{let a=o.viewportVisibilityState??nd;return L(E({},o),{viewportVisibilityState:L(E({},a),{[s]:re.UNKNOWN})})})}},this.setViewport=t=>this.viewportTracker.setViewport(t),this.bindVideoElement=(t,n,s)=>{let r=this.call.state.findParticipantBySessionId(n);if(!r)return;let o=(p,g)=>{g&&(g.width===0||g.height===0)&&(this.logger("debug","Ignoring 0x0 dimension",r),g=void 0),this.call.updateSubscriptionsPartial(s,{[n]:{dimension:g}},p)},a=this.call.state.participants$.pipe(we(p=>p.find(g=>g.sessionId===n)),Hi(p=>!!p),pe(),ve({bufferSize:1,refCount:!0})),l,c=r.isLocalParticipant?null:a.pipe(we(p=>p.viewportVisibilityState?.[s]),pe()).subscribe(p=>{if(!l){l=p??re.UNKNOWN;return}if(l=p??re.UNKNOWN,p===re.INVISIBLE)return o(Be.MEDIUM,void 0);o(Be.MEDIUM,{width:t.clientWidth,height:t.clientHeight})}),u,h=r.isLocalParticipant?null:new ResizeObserver(()=>{let p=`${t.clientWidth},${t.clientHeight}`;if(!u){u=p;return}u===p||l===re.INVISIBLE||(o(Be.SLOW,{width:t.clientWidth,height:t.clientHeight}),u=p)});h?.observe(t);let d=r.isLocalParticipant?null:a.pipe(ai("publishedTracks"),we(p=>s==="videoTrack"?qt(p):Et(p)),pe()).subscribe(p=>{p?o(Be.FAST,{width:t.clientWidth,height:t.clientHeight}):o(Be.FAST,void 0)});t.autoplay=!0,t.playsInline=!0,t.muted=!0;let f=a.pipe(ai(s==="videoTrack"?"videoStream":"screenShareStream")).subscribe(p=>{let g=s==="videoTrack"?p.videoStream:p.screenShareStream;t.srcObject!==g&&(t.srcObject=g??null,(Zp()||em())&&setTimeout(()=>{t.srcObject=g??null,t.play().catch(v=>{this.logger("warn","Failed to play stream",v)})},25))});return()=>{o(Be.FAST,void 0),c?.unsubscribe(),d?.unsubscribe(),f.unsubscribe(),h?.disconnect()}},this.bindAudioElement=(t,n,s)=>{let r=this.call.state.findParticipantBySessionId(n);if(!r||r.isLocalParticipant)return;let o=this.call.state.participants$.pipe(we(u=>u.find(h=>h.sessionId===n)),Hi(u=>!!u),pe(),ve({bufferSize:1,refCount:!0})),a=o.pipe(ai(s==="screenShareAudioTrack"?"screenShareAudioStream":"audioStream")).subscribe(u=>{let h=s==="screenShareAudioTrack"?u.screenShareAudioStream:u.audioStream;t.srcObject!==h&&setTimeout(()=>{if(t.srcObject=h??null,t.srcObject){t.play().catch(f=>{this.logger("warn","Failed to play stream",f)});let{selectedDevice:d}=this.call.speaker.state;d&&"setSinkId"in t&&t.setSinkId(d)}})}),l="setSinkId"in t?this.call.speaker.state.selectedDevice$.subscribe(u=>{u&&t.setSinkId(u)}):null,c=Nt([this.call.speaker.state.volume$,o.pipe(ai("audioVolume"))]).subscribe(([u,h])=>{t.volume=h.audioVolume??u});return t.autoplay=!0,()=>{l?.unsubscribe(),c.unsubscribe(),a.unsubscribe()}},this.call=e}},sc=class{constructor(){this.permissions=[],this.setPermissions=e=>{this.permissions=e||[]},this.setCallSettings=e=>{this.settings=e},this.hasPermission=e=>this.permissions.includes(e),this.canRequest=(e,t=this.settings)=>{if(!t)return!1;let{audio:n,video:s,screensharing:r}=t;switch(e){case xe.SEND_AUDIO:return n.access_request_enabled;case xe.SEND_VIDEO:return s.access_request_enabled;case xe.SCREENSHARE:return r.access_request_enabled;default:return!1}}}},It=class{constructor(e,t={sortParticipantsBy:Jn}){this.name=e,this.options=t}},rc=class{constructor(e){this.register=t=>{this.callTypes[t.name]=t},this.unregister=t=>{delete this.callTypes[t]},this.get=t=>(this.callTypes[t]||this.register(new It(t)),this.callTypes[t]),this.callTypes=e.reduce((t,n)=>(t[n.name]=n,t),{})}},tm=new rc([new It("default",{sortParticipantsBy:Jn}),new It("development",{sortParticipantsBy:Jn}),new It("livestream",{sortParticipantsBy:td}),new It("audio_room",{sortParticipantsBy:td})]),zn=class{constructor(e){this.permission=e,this.disposeController=new AbortController,this.wasPrompted=!1,this.listeners=new Set,this.logger=ie(["permissions"]);let t=this.disposeController.signal;this.ready=b(this,null,function*(){let n=s=>{this.logger("warn","Can't query permissions, assuming granted",{permission:e,error:s}),this.setState("granted")};if(!im())return n();try{let s=yield navigator.permissions.query({name:e.queryName});t.aborted||(this.setState(s.state),s.addEventListener("change",()=>this.setState(s.state),{signal:t}))}catch(s){n(s)}})}dispose(){this.state=void 0,this.disposeController.abort()}getState(){return b(this,null,function*(){if(yield this.ready,!this.state)throw new Error("BrowserPermission instance possibly disposed");return this.state})}prompt(){return b(this,arguments,function*({forcePrompt:e=!1,throwOnNotAllowed:t=!1}={}){yield Ko(`permission-prompt-${this.permission.queryName}`,()=>b(this,null,function*(){if((yield this.getState())!=="prompt"||this.wasPrompted&&!e){let n=this.state==="granted";if(!n&&t)throw new DOMException("Permission was not granted previously, and prompting again is not allowed","NotAllowedError");return n}try{this.wasPrompted=!0;let n=yield navigator.mediaDevices.getUserMedia(this.permission.constraints);return um(n),!0}catch(n){if(n instanceof DOMException&&n.name==="NotAllowedError"){if(this.logger("info","Browser permission was not granted",{permission:this.permission}),t)throw n;return!1}throw this.logger("error","Failed to getUserMedia",{error:n,permission:this.permission}),n}}))})}listen(e){return this.listeners.add(e),this.state&&e(this.state),()=>this.listeners.delete(e)}asObservable(){return jc(e=>this.listen(e),(e,t)=>t()).pipe(we(e=>e!=="denied"))}setState(e){this.state!==e&&(this.state=e,this.listeners.forEach(t=>t(e)))}};function im(){return!ue()&&typeof navigator<"u"&&!!navigator.permissions?.query}var sd=Symbol("uninitialized");function os(i){let e=sd;return()=>(e===sd&&(e=i()),e)}var Ec=(i,e)=>gs(b(void 0,null,function*(){let t=yield navigator.mediaDevices.enumerateDevices();return t.some(s=>s.kind===e&&s.label==="")&&(yield i.prompt({throwOnNotAllowed:!0}),t=yield navigator.mediaDevices.enumerateDevices()),t.filter(s=>s.kind===e)})),nm=()=>typeof document>"u"?!1:"setSinkId"in document.createElement("audio"),Nd={audio:{autoGainControl:!0,noiseSuppression:!0,echoCancellation:!0}},Od={video:{width:1280,height:720}},Qt=os(()=>new zn({constraints:Nd,queryName:"microphone"})),Xn=os(()=>new zn({constraints:Od,queryName:"camera"})),cs=os(()=>navigator.mediaDevices.addEventListener?Vc(navigator.mediaDevices,"devicechange").pipe(we(()=>{}),Hc(500)):gs([])),sm=os(()=>Wi(cs(),Qt().asObservable()).pipe(oi(void 0),ri(()=>Ec(Qt(),"audioinput")),ve(1))),rm=()=>Wi(cs(),Xn().asObservable()).pipe(oi(void 0),ri(()=>Ec(Xn(),"videoinput")),ve(1)),am=()=>Wi(cs(),Qt().asObservable()).pipe(oi(void 0),ri(()=>Ec(Qt(),"audiooutput")),ve(1)),xd=i=>b(void 0,null,function*(){return yield navigator.mediaDevices.getUserMedia(i)}),om=i=>b(void 0,null,function*(){let e={audio:E(E({},Nd.audio),i)};try{return yield Qt().prompt({throwOnNotAllowed:!0,forcePrompt:!0}),xd(e)}catch(t){throw ie(["devices"])("error","Failed to get audio stream",{error:t,constraints:e}),t}}),cm=i=>b(void 0,null,function*(){let e={video:E(E({},Od.video),i)};try{return yield Xn().prompt({throwOnNotAllowed:!0,forcePrompt:!0}),xd(e)}catch(t){throw ie(["devices"])("error","Failed to get video stream",{error:t,constraints:e}),t}}),lm=i=>b(void 0,null,function*(){try{return yield navigator.mediaDevices.getDisplayMedia(E({video:!0,audio:{channelCount:{ideal:2},echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1},systemAudio:"include"},i))}catch(e){throw ie(["devices"])("error","Failed to get screen share stream",e),e}}),Yn=typeof navigator<"u"&&typeof navigator.mediaDevices<"u"?cs().pipe(oi(void 0),ri(()=>navigator.mediaDevices.enumerateDevices()),ve(1)):void 0,um=i=>{i.active&&(i.getTracks().forEach(e=>{e.stop(),i.removeTrack(e)}),typeof i.release=="function"&&i.release())},Ui=class{constructor(e,t,n){this.call=e,this.state=t,this.trackType=n,this.stopOnLeave=!0,this.subscriptions=[],this.isTrackStoppedDueToTrackEnd=!1,this.filters=[],this.statusChangeConcurrencyTag=Symbol("statusChangeConcurrencyTag"),this.dispose=()=>{this.subscriptions.forEach(s=>s())},this.logger=ie([`${T[n].toLowerCase()} manager`]),Yn&&!ue()&&(this.trackType===T.AUDIO||this.trackType===T.VIDEO)&&this.handleDisconnectedOrReplacedDevices()}listDevices(){return this.getDevices()}enable(){return b(this,null,function*(){this.state.optimisticStatus!=="enabled"&&(this.state.setPendingStatus("enabled"),yield ed(this.statusChangeConcurrencyTag,e=>b(this,null,function*(){try{yield this.unmuteStream(),this.state.setStatus("enabled")}finally{e.aborted||this.state.setPendingStatus(this.state.status)}})))})}disable(e=!1){return b(this,null,function*(){this.state.prevStatus=this.state.status,!(!e&&this.state.optimisticStatus==="disabled")&&(this.state.setPendingStatus("disabled"),yield ed(this.statusChangeConcurrencyTag,t=>b(this,null,function*(){try{let n=e||this.state.disableMode==="stop-tracks";yield this.muteStream(n),this.state.setStatus("disabled")}finally{t.aborted||this.state.setPendingStatus(this.state.status)}})))})}statusChangeSettled(){return b(this,null,function*(){yield ap(this.statusChangeConcurrencyTag)})}resume(){return b(this,null,function*(){this.state.prevStatus==="enabled"&&this.state.status==="disabled"&&(yield this.enable())})}toggle(){return b(this,null,function*(){return this.state.optimisticStatus==="enabled"?yield this.disable():yield this.enable()})}registerFilter(e){return b(this,null,function*(){return this.filters.push(e),yield this.applySettingsToStream(),()=>b(this,null,function*(){this.filters=this.filters.filter(t=>t!==e),yield this.applySettingsToStream()})})}setDefaultConstraints(e){this.state.setDefaultConstraints(e)}select(e){return b(this,null,function*(){if(ue())throw new Error("This method is not supported in React Native. Please visit https://getstream.io/video/docs/reactnative/core/camera-and-microphone/#speaker-management for reference.");e!==this.state.selectedDevice&&(this.state.setDevice(e),yield this.applySettingsToStream())})}applySettingsToStream(){return b(this,null,function*(){this.state.status==="enabled"&&(yield this.muteStream(),yield this.unmuteStream())})}getTracks(){return this.state.mediaStream?.getTracks()??[]}muteStream(e=!0){return b(this,null,function*(){if(!this.state.mediaStream)return;this.logger("debug",`${e?"Stopping":"Disabling"} stream`),this.call.state.callingState===N.JOINED&&(yield this.stopPublishStream(e)),this.muteLocalStream(e),this.getTracks().every(n=>n.readyState==="ended")&&(this.state.mediaStream&&typeof this.state.mediaStream.release=="function"&&this.state.mediaStream.release(),this.state.setMediaStream(void 0,void 0))})}muteTracks(){this.getTracks().forEach(e=>{e.enabled&&(e.enabled=!1)})}unmuteTracks(){this.getTracks().forEach(e=>{e.enabled||(e.enabled=!0)})}stopTracks(){this.getTracks().forEach(e=>{e.readyState==="live"&&e.stop()})}muteLocalStream(e){this.state.mediaStream&&(e?this.stopTracks():this.muteTracks())}unmuteStream(){return b(this,null,function*(){this.logger("debug","Starting stream");let e,t;if(this.state.mediaStream&&this.getTracks().every(n=>n.readyState==="live"))e=this.state.mediaStream,this.unmuteTracks();else{let n=this.state.defaultConstraints,s=L(E({},n),{deviceId:this.state.selectedDevice}),r=o=>a=>b(this,null,function*(){if(!o)return a;let l=yield o;return a.getTracks().forEach(c=>{let u=c.stop;c.stop=function(){u.call(c),l.getTracks().forEach(d=>{d.kind===c.kind&&d.stop()})}}),l.getTracks().forEach(c=>{let u=()=>{a.getTracks().forEach(h=>{c.kind===h.kind&&(h.stop(),h.dispatchEvent(new Event("ended")))})};c.addEventListener("ended",u),this.subscriptions.push(()=>{c.removeEventListener("ended",u)})}),a});t=this.getStream(s),e=yield this.filters.reduce((o,a)=>o.then(a).then(r(o)),t)}this.call.state.callingState===N.JOINED&&(yield this.publishStream(e)),this.state.mediaStream!==e&&(this.state.setMediaStream(e,yield t),this.getTracks().forEach(n=>{n.addEventListener("ended",()=>b(this,null,function*(){yield this.statusChangeSettled(),this.state.status==="enabled"&&(this.isTrackStoppedDueToTrackEnd=!0,setTimeout(()=>{this.isTrackStoppedDueToTrackEnd=!1},2e3),yield this.disable())}))}))})}get mediaDeviceKind(){return this.trackType===T.AUDIO?"audioinput":this.trackType===T.VIDEO?"videoinput":""}handleDisconnectedOrReplacedDevices(){this.subscriptions.push(Oe(Nt([Yn.pipe(qc()),this.state.selectedDevice$]),s=>b(this,[s],function*([[e,t],n]){try{if(!n)return;yield this.statusChangeSettled();let r=!1,o=!1,a=this.findDeviceInList(t,n),l=this.findDeviceInList(e,n);!a&&l?r=!0:a&&l&&a.deviceId===l.deviceId&&a.groupId!==l.groupId&&(o=!0),r&&(yield this.disable(),yield this.select(void 0)),o&&(this.isTrackStoppedDueToTrackEnd&&this.state.status==="disabled"?(yield this.enable(),this.isTrackStoppedDueToTrackEnd=!1):yield this.applySettingsToStream())}catch(r){this.logger("warn","Unexpected error while handling disconnected or replaced device",r)}})))}findDeviceInList(e,t){return e.find(n=>n.deviceId===t&&n.kind===this.mediaDeviceKind)}},Li=class{constructor(e="stop-tracks",t){this.disableMode=e,this.statusSubject=new F(void 0),this.optimisticStatusSubject=new F(void 0),this.mediaStreamSubject=new F(void 0),this.selectedDeviceSubject=new F(void 0),this.defaultConstraintsSubject=new F(void 0),this.mediaStream$=this.mediaStreamSubject.asObservable(),this.selectedDevice$=this.selectedDeviceSubject.asObservable().pipe(pe()),this.status$=this.statusSubject.asObservable().pipe(pe()),this.optimisticStatus$=this.optimisticStatusSubject.asObservable().pipe(pe()),this.defaultConstraints$=this.defaultConstraintsSubject.asObservable(),this.getCurrentValue=Je,this.setCurrentValue=ts,this.hasBrowserPermission$=t?t.asObservable().pipe(ve(1)):bs(!0)}get status(){return this.getCurrentValue(this.status$)}get optimisticStatus(){return this.getCurrentValue(this.optimisticStatus$)}get selectedDevice(){return this.getCurrentValue(this.selectedDevice$)}get mediaStream(){return this.getCurrentValue(this.mediaStream$)}setStatus(e){this.setCurrentValue(this.statusSubject,e)}setPendingStatus(e){this.setCurrentValue(this.optimisticStatusSubject,e)}setMediaStream(e,t){this.setCurrentValue(this.mediaStreamSubject,e),t&&this.setDevice(this.getDeviceIdFromStream(t))}setDevice(e){this.setCurrentValue(this.selectedDeviceSubject,e)}get defaultConstraints(){return this.getCurrentValue(this.defaultConstraints$)}setDefaultConstraints(e){this.setCurrentValue(this.defaultConstraintsSubject,e)}},ac=class extends Li{constructor(){super("stop-tracks",Xn()),this.directionSubject=new F(void 0),this.direction$=this.directionSubject.asObservable().pipe(pe())}get direction(){return this.getCurrentValue(this.direction$)}setDirection(e){this.setCurrentValue(this.directionSubject,e)}setMediaStream(e,t){if(super.setMediaStream(e,t),e){let n=ue()?this.direction:e.getVideoTracks()[0]?.getSettings().facingMode==="environment"?"back":"front";this.setDirection(n)}}getDeviceIdFromStream(e){let[t]=e.getVideoTracks();return t?.getSettings().deviceId}},oc=class extends Ui{constructor(e){super(e,new ac,T.VIDEO),this.targetResolution={width:1280,height:720}}selectDirection(e){return b(this,null,function*(){this.state.setDirection(e),this.state.setDevice(void 0),yield this.applySettingsToStream()})}flip(){return b(this,null,function*(){let e=this.state.direction==="front"?"back":"front";yield this.selectDirection(e)})}selectTargetResolution(e){return b(this,null,function*(){if(this.targetResolution.height=e.height,this.targetResolution.width=e.width,this.state.optimisticStatus==="enabled")try{yield this.statusChangeSettled()}catch(t){this.logger("warn","could not apply target resolution",t)}if(this.state.status==="enabled"){let{width:t,height:n}=this.state.mediaStream.getVideoTracks()[0]?.getSettings();(t!==this.targetResolution.width||n!==this.targetResolution.height)&&(yield this.applySettingsToStream(),this.logger("debug",`${t}x${n} target resolution applied to media stream`))}})}setPreferredCodec(e){this.preferredCodec=e}getDevices(){return rm()}getStream(e){return e.width=this.targetResolution.width,e.height=this.targetResolution.height,!e.deviceId&&this.state.direction&&(e.facingMode=this.state.direction==="front"?"user":"environment"),cm(e)}publishStream(e){return this.call.publishVideoStream(e,{preferredCodec:this.preferredCodec})}stopPublishStream(e){return this.call.stopPublish(T.VIDEO,e)}},cc=class extends Li{constructor(e){super(e,Qt()),this.speakingWhileMutedSubject=new F(!1),this.speakingWhileMuted$=this.speakingWhileMutedSubject.asObservable().pipe(pe())}get speakingWhileMuted(){return this.getCurrentValue(this.speakingWhileMuted$)}setSpeakingWhileMuted(e){this.setCurrentValue(this.speakingWhileMutedSubject,e)}getDeviceIdFromStream(e){let[t]=e.getAudioTracks();return t?.getSettings().deviceId}},dm=500,hm=150,fm=128,pm=(i,e,t={})=>{let{detectionFrequencyInMs:n=dm,audioLevelThreshold:s=hm,fftSize:r=fm,destroyStreamOnStop:o=!0}=t,a=new AudioContext,l=a.createAnalyser();l.fftSize=r;let c=a.createMediaStreamSource(i);c.connect(l);let u=setInterval(()=>{let h=new Uint8Array(l.frequencyBinCount);l.getByteFrequencyData(h);let d=h.some(g=>g>=s),f=h.reduce((g,v)=>g+v,0)/h.length,p=f>s?100:Math.round(f/s*100);i.getAudioTracks()[0]?.enabled?e({isSoundDetected:d,audioLevel:p}):e({isSoundDetected:!1,audioLevel:0})},n);return function(){return b(this,null,function*(){clearInterval(u),c.disconnect(),l.disconnect(),a.state!=="closed"&&(yield a.close()),o&&i.getTracks().forEach(d=>{d.stop(),i.removeTrack(d)})})}},mm=.2,lc=class{constructor(){this.pc1=new RTCPeerConnection({}),this.pc2=new RTCPeerConnection({})}start(){return b(this,null,function*(){try{let e=yield navigator.mediaDevices.getUserMedia({audio:!0});this.pc1.addEventListener("icecandidate",r=>b(this,null,function*(){yield this.pc2.addIceCandidate(r.candidate)})),this.pc2.addEventListener("icecandidate",r=>b(this,null,function*(){yield this.pc1.addIceCandidate(r.candidate)})),e.getTracks().forEach(r=>this.pc1.addTrack(r,e));let t=yield this.pc1.createOffer({});yield this.pc2.setRemoteDescription(t),yield this.pc1.setLocalDescription(t);let n=yield this.pc2.createAnswer();yield this.pc1.setRemoteDescription(n),yield this.pc2.setLocalDescription(n),e.getAudioTracks().forEach(r=>r.enabled=!1)}catch(e){console.error("Error connecting and negotiating between PeerConnections:",e)}})}stop(){this.pc1.close(),this.pc2.close(),this.intervalId&&clearInterval(this.intervalId)}onSpeakingDetectedStateChange(e){return this.intervalId=setInterval(()=>b(this,null,function*(){let t=yield this.pc1.getStats(),s=Kn(t).find(r=>r.type==="media-source"&&r.kind==="audio");if(s){let{audioLevel:r}=s;r&&(r>=mm?e({isSoundDetected:!0,audioLevel:r}):e({isSoundDetected:!1,audioLevel:0}))}}),1e3),()=>{clearInterval(this.intervalId)}}},uc=class extends Ui{constructor(e,t=ue()?"disable-tracks":"stop-tracks"){super(e,new cc(t),T.AUDIO),this.speakingWhileMutedNotificationEnabled=!0,this.soundDetectorConcurrencyTag=Symbol("soundDetectorConcurrencyTag"),this.subscriptions.push(Oe(Nt([this.call.state.callingState$,this.call.state.ownCapabilities$,this.state.selectedDevice$,this.state.status$]),a=>b(this,[a],function*([n,s,r,o]){try{if(n===N.LEFT&&(yield this.stopSpeakingWhileMutedDetection()),n!==N.JOINED||!this.speakingWhileMutedNotificationEnabled)return;s.includes(xe.SEND_AUDIO)?o==="disabled"?yield this.startSpeakingWhileMutedDetection(r):yield this.stopSpeakingWhileMutedDetection():yield this.stopSpeakingWhileMutedDetection()}catch(l){this.logger("warn","Could not enable speaking while muted",l)}}))),this.subscriptions.push(Oe(this.call.state.callingState$,n=>{if(!this.noiseCancellationRegistration||!this.noiseCancellation)return;this.call.state.settings?.audio.noise_cancellation?.mode===Ur.AUTO_ON&&n===N.JOINED?this.noiseCancellationRegistration.then(()=>this.noiseCancellation?.enable()).catch(r=>(this.logger("warn","Failed to enable noise cancellation",r),this.call.notifyNoiseCancellationStopped())):n===N.LEFT&&this.noiseCancellationRegistration.then(()=>this.noiseCancellation?.disable()).catch(r=>{this.logger("warn","Failed to disable noise cancellation",r)})}))}enableNoiseCancellation(e){return b(this,null,function*(){if(ue())throw new Error("Noise cancellation is not supported in React Native");let{ownCapabilities:t,settings:n}=this.call.state;if(!t.includes(xe.ENABLE_NOISE_CANCELLATION))throw new Error("Noise cancellation is not available.");let r=n?.audio.noise_cancellation;if(!r||r.mode===Ur.DISABLED)throw new Error("Noise cancellation is disabled for this call type.");try{this.noiseCancellation=e,this.noiseCancellationChangeUnsubscribe=this.noiseCancellation.on("change",o=>{o?this.call.notifyNoiseCancellationStarting().catch(a=>{this.logger("warn","notifyNoiseCancellationStart failed",a)}):this.call.notifyNoiseCancellationStopped().catch(a=>{this.logger("warn","notifyNoiseCancellationStop failed",a)})}),this.noiseCancellationRegistration=this.registerFilter(e.toFilter()),yield this.noiseCancellationRegistration,r.mode===Ur.AUTO_ON&&this.call.state.callingState===N.JOINED&&e.enable()}catch(o){this.logger("warn","Failed to enable noise cancellation",o),yield this.disableNoiseCancellation().catch(a=>{this.logger("warn","Failed to disable noise cancellation",a)})}})}disableNoiseCancellation(){return b(this,null,function*(){if(ue())throw new Error("Noise cancellation is not supported in React Native");yield this.noiseCancellationRegistration?.then(e=>e()).then(()=>this.noiseCancellation?.disable()).then(()=>this.noiseCancellationChangeUnsubscribe?.()).catch(e=>{this.logger("warn","Failed to unregister noise cancellation",e)}),yield this.call.notifyNoiseCancellationStopped()})}enableSpeakingWhileMutedNotification(){return b(this,null,function*(){this.speakingWhileMutedNotificationEnabled=!0,this.state.status==="disabled"&&(yield this.startSpeakingWhileMutedDetection(this.state.selectedDevice))})}disableSpeakingWhileMutedNotification(){return b(this,null,function*(){this.speakingWhileMutedNotificationEnabled=!1,yield this.stopSpeakingWhileMutedDetection()})}getDevices(){return sm()}getStream(e){return om(e)}publishStream(e){return this.call.publishAudioStream(e)}stopPublishStream(e){return this.call.stopPublish(T.AUDIO,e)}startSpeakingWhileMutedDetection(e){return b(this,null,function*(){yield Ko(this.soundDetectorConcurrencyTag,()=>b(this,null,function*(){if(yield this.stopSpeakingWhileMutedDetection(),ue()){this.rnSpeechDetector=new lc,yield this.rnSpeechDetector.start();let t=this.rnSpeechDetector?.onSpeakingDetectedStateChange(n=>{this.state.setSpeakingWhileMuted(n.isSoundDetected)});this.soundDetectorCleanup=()=>{t(),this.rnSpeechDetector?.stop(),this.rnSpeechDetector=void 0}}else{let t=yield this.getStream({deviceId:e});this.soundDetectorCleanup=pm(t,n=>{this.state.setSpeakingWhileMuted(n.isSoundDetected)})}}))})}stopSpeakingWhileMutedDetection(){return b(this,null,function*(){yield Ko(this.soundDetectorConcurrencyTag,()=>b(this,null,function*(){if(!this.soundDetectorCleanup)return;let e=this.soundDetectorCleanup;this.soundDetectorCleanup=void 0,this.state.setSpeakingWhileMuted(!1),yield e()}))})}},dc=class extends Li{constructor(){super(...arguments),this.audioEnabledSubject=new F(!0),this.settingsSubject=new F(void 0),this.audioEnabled$=this.audioEnabledSubject.asObservable().pipe(pe()),this.settings$=this.settingsSubject.asObservable(),this.getDeviceIdFromStream=e=>{let[t]=e.getTracks();return t?.getSettings().deviceId}}get audioEnabled(){return this.getCurrentValue(this.audioEnabled$)}setAudioEnabled(e){this.setCurrentValue(this.audioEnabledSubject,e)}get settings(){return this.getCurrentValue(this.settings$)}setSettings(e){this.setCurrentValue(this.settingsSubject,e)}},hc=class extends Ui{constructor(e){super(e,new dc,T.SCREEN_SHARE),this.subscriptions.push(Oe(e.state.settings$,t=>{let n=t?.screensharing.target_resolution;n&&this.setDefaultConstraints({video:{width:n.width,height:n.height}})}))}enableScreenShareAudio(){this.state.setAudioEnabled(!0)}disableScreenShareAudio(){return b(this,null,function*(){this.state.setAudioEnabled(!1),this.call.publisher?.isPublishing(T.SCREEN_SHARE_AUDIO)&&(yield this.call.stopPublish(T.SCREEN_SHARE_AUDIO,!0))})}getSettings(){return this.state.settings}setSettings(e){this.state.setSettings(e)}getDevices(){return bs([])}getStream(e){return this.state.audioEnabled||(e.audio=!1),lm(e)}publishStream(e){return this.call.publishScreenShareStream(e,{screenShareSettings:this.state.settings})}stopPublishStream(e){return b(this,null,function*(){yield this.call.stopPublish(T.SCREEN_SHARE,e),yield this.call.stopPublish(T.SCREEN_SHARE_AUDIO,e)})}select(e){return b(this,null,function*(){throw new Error("This method is not supported in for Screen Share")})}},fc=class{constructor(){this.selectedDeviceSubject=new F(""),this.volumeSubject=new F(1),this.isDeviceSelectionSupported=nm(),this.getCurrentValue=Je,this.setCurrentValue=ts,this.selectedDevice$=this.selectedDeviceSubject.asObservable().pipe(pe()),this.volume$=this.volumeSubject.asObservable().pipe(pe())}get selectedDevice(){return this.getCurrentValue(this.selectedDevice$)}get volume(){return this.getCurrentValue(this.volume$)}setDevice(e){this.setCurrentValue(this.selectedDeviceSubject,e)}setVolume(e){this.setCurrentValue(this.volumeSubject,e)}},pc=class{constructor(e){this.state=new fc,this.subscriptions=[],this.dispose=()=>{this.subscriptions.forEach(t=>t.unsubscribe())},this.call=e,Yn&&!ue()&&this.subscriptions.push(Nt([Yn,this.state.selectedDevice$]).subscribe(([t,n])=>{if(!n)return;t.find(r=>r.deviceId===n&&r.kind==="audiooutput")||this.select("")}))}listDevices(){if(ue())throw new Error("This feature is not supported in React Native. Please visit https://getstream.io/video/docs/reactnative/core/camera-and-microphone/#speaker-management for more details");return am()}select(e){if(ue())throw new Error("This feature is not supported in React Native. Please visit https://getstream.io/video/docs/reactnative/core/camera-and-microphone/#speaker-management for more details");this.state.setDevice(e)}setVolume(e){if(ue())throw new Error("This feature is not supported in React Native. Please visit https://getstream.io/video/docs/reactnative/core/camera-and-microphone/#speaker-management for more details");if(e&&(e<0||e>1))throw new Error("Volume must be between 0 and 1");this.state.setVolume(e)}setParticipantVolume(e,t){if(ue())throw new Error("This feature is not supported in React Native. Please visit https://getstream.io/video/docs/reactnative/core/camera-and-microphone/#speaker-management for more details");if(t&&(t<0||t>1))throw new Error("Volume must be between 0 and 1, or undefined");this.call.state.updateParticipant(e,{audioVolume:t})}},Rt=class{constructor({type:e,id:t,streamClient:n,members:s,ownCapabilities:r,sortParticipantsBy:o,clientStore:a,ringing:l=!1,watching:c=!1}){this.state=new zo,this.dynascaleManager=new nc(this),this.permissionsContext=new sc,this.dispatcher=new qo,this.trackSubscriptionsSubject=new F({type:Be.MEDIUM,data:[]}),this.reconnectAttempts=0,this.maxReconnectAttempts=10,this.isLeaving=!1,this.leaveCallHooks=new Set,this.streamClientEventHandlers=new Map,this.on=(d,f)=>{if(Xu(d))return this.dispatcher.on(d,f);let p=this.streamClient.on(d,g=>{let v=g;v.call_cid&&v.call_cid===this.cid&&f(v)});return this.streamClientEventHandlers.set(f,p),()=>{this.off(d,f)}},this.off=(d,f)=>{if(Xu(d))return this.dispatcher.off(d,f);let p=this.streamClientEventHandlers.get(f);p&&p()},this.leave=(...p)=>b(this,[...p],function*({reject:d=!1,reason:f="user is leaving the call"}={}){let g=this.state.callingState;if(g===N.LEFT)throw new Error("Cannot leave call that has already been left.");if(g===N.JOINING&&(yield this.assertCallJoined()),this.isLeaving=!0,this.ringing){let k=this.state.remoteParticipants.length>0;this.isCreatedByMe&&!k&&g===N.RINGING?yield this.reject():d&&g===N.RINGING&&(yield this.reject())}this.statsReporter?.stop(),this.statsReporter=void 0,this.sfuStatsReporter?.stop(),this.sfuStatsReporter=void 0,this.subscriber?.close(),this.subscriber=void 0,this.publisher?.close(),this.publisher=void 0,this.sfuClient?.close(Tt.NORMAL_CLOSURE,f),this.sfuClient=void 0,this.dispatcher.offAll(),this.state.setCallingState(N.LEFT),this.leaveCallHooks.forEach(k=>k()),this.clientStore.unregisterCall(this),this.camera.dispose(),this.microphone.dispose(),this.screenShare.dispose(),this.speaker.dispose();let v=[];this.camera.stopOnLeave&&v.push(this.camera.disable(!0)),this.microphone.stopOnLeave&&v.push(this.microphone.disable(!0)),this.screenShare.stopOnLeave&&v.push(this.screenShare.disable(!0)),yield Promise.all(v)}),this.get=d=>b(this,null,function*(){let f=yield this.streamClient.get(this.streamClientBasePath,d);return d?.ring&&!this.ringing&&this.ringingSubject.next(!0),this.state.updateFromCallResponse(f.call),this.state.setMembers(f.members),this.state.setOwnCapabilities(f.own_capabilities),this.streamClient._hasConnectionID()&&(this.watching=!0,this.clientStore.registerCall(this)),yield this.applyDeviceConfig(),f}),this.getOrCreate=d=>b(this,null,function*(){let f=yield this.streamClient.post(this.streamClientBasePath,d);return d?.ring&&!this.ringing&&this.ringingSubject.next(!0),this.state.updateFromCallResponse(f.call),this.state.setMembers(f.members),this.state.setOwnCapabilities(f.own_capabilities),this.streamClient._hasConnectionID()&&(this.watching=!0,this.clientStore.registerCall(this)),yield this.applyDeviceConfig(),f}),this.create=d=>b(this,null,function*(){return this.getOrCreate(d)}),this.ring=()=>b(this,null,function*(){return yield this.get({ring:!0})}),this.notify=()=>b(this,null,function*(){return yield this.get({notify:!0})}),this.accept=()=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/accept`)}),this.reject=d=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/reject`,{reason:d})}),this.join=d=>b(this,null,function*(){let f=this.state.callingState;if([N.JOINED,N.JOINING].includes(f))throw this.logger("warn","Join method called twice, you should only call this once"),new Error("Illegal State: Already joined.");if(f===N.LEFT)throw new Error("Illegal State: Cannot join already left call. Create a new Call instance to join a call.");let p=f===N.MIGRATING,g=f===N.RECONNECTING;this.state.setCallingState(N.JOINING),this.logger("debug","Starting join flow"),d?.ring&&!this.ringing&&this.ringingSubject.next(!0),this.ringing&&!this.isCreatedByMe&&(yield this.accept());let v,k,_,P;try{if(this.sfuClient?.isFastReconnecting)_=this.publisher?.connectionConfiguration,v=this.sfuClient.sfuServer,k=this.sfuClient.token,P=this.sfuStatsReporter?.options;else{let O=yield Jp(this.streamClient,this.type,this.id,d);this.state.updateFromCallResponse(O.metadata),this.state.setMembers(O.members),this.state.setOwnCapabilities(O.ownCapabilities),_=O.connectionConfig,v=O.sfuServer,k=O.token,P=O.statsOptions}this.streamClient._hasConnectionID()&&(this.watching=!0,this.clientStore.registerCall(this))}catch(O){throw this.state.setCallingState(f),O}let A=this.sfuClient,M=this.sfuClient=new Tt({dispatcher:this.dispatcher,sfuServer:v,token:k,sessionId:A?.sessionId}),$=(O,Q)=>b(this,null,function*(){let ye=this.state.callingState;if(ye===N.MIGRATING||ye===N.RECONNECTING)return;this.reconnectAttempts++,this.state.setCallingState(O==="migrate"?N.MIGRATING:N.RECONNECTING),O==="migrate"?(this.logger("debug",`[Migration]: migrating call ${this.cid} away from ${v.edge_name}`),M.isMigratingAway=!0):this.logger("debug",`[Rejoin]: ${O} rejoin call ${this.cid} (${this.reconnectAttempts})...`);let ne=this.state.localParticipant;if(O==="fast"?M.close(Tt.ERROR_CONNECTION_BROKEN,`attempting fast reconnect: ${Q}`):O==="full"&&(yield Ke(_t(this.reconnectAttempts)),this.subscriber?.close(),this.subscriber=void 0,this.publisher?.close({stopTracks:!1}),this.publisher=void 0,this.statsReporter?.stop(),this.statsReporter=void 0,this.sfuStatsReporter?.stop(),this.sfuStatsReporter=void 0,M.close(Tt.NORMAL_CLOSURE,`attempting full reconnect: ${Q}`)),yield this.join(E(E({},d),O==="migrate"&&{migrating_from:v.edge_name})),O==="migrate"&&M.close(Tt.NORMAL_CLOSURE,"attempting migration"),this.logger("info",`[Rejoin]: Attempt ${this.reconnectAttempts} successful!`),ne&&O==="full"){let{audioStream:Se,videoStream:Xe,screenShareStream:Ye,screenShareAudioStream:he}=ne,ke;(Ye||he)&&(ke=new MediaStream,Ye?.getVideoTracks().forEach(Ce=>{ke?.addTrack(Ce)}),he?.getAudioTracks().forEach(Ce=>{ke?.addTrack(Ce)})),Se&&(yield this.publishAudioStream(Se)),Xe&&(yield this.publishVideoStream(Xe,{preferredCodec:this.camera.preferredCodec})),ke&&(yield this.publishScreenShareStream(ke)),this.logger("info",`[Rejoin]: State restored. Attempt: ${this.reconnectAttempts}`)}});M.signalReady.then(()=>{let O=this.dispatcher.on("goAway",Q=>{let{reason:ye}=Q;this.logger("info",`[Migration]: Going away from SFU... Reason: ${Gn[ye]}`),$("migrate",Gn[ye]).catch(ne=>{this.logger("warn","[Migration]: Failed to migrate to another SFU.",ne)})});M.signalWs.addEventListener("close",Q=>{if(O(),this.isLeaving||Q.code===Tt.NORMAL_CLOSURE||Q.code===st.WS_POLICY_VIOLATION)return;let ye=Q.code===st.WS_CLOSED_ABRUPTLY&&M.isMigratingAway,ne=Q.code===st.WS_CLOSED_ABRUPTLY&&M.isFastReconnecting;if(!(ye||ne)&&Q.code!==Tt.ERROR_CONNECTION_BROKEN)if(this.reconnectAttempts<this.maxReconnectAttempts){M.isFastReconnecting=this.reconnectAttempts===0;let Se=M.isFastReconnecting?"fast":"full";$(Se,`SFU closed the WS with code: ${Q.code}`).catch(Xe=>{this.logger("error",`[Rejoin]: ${Se} rejoin failed for ${this.reconnectAttempts} times. Giving up.`,Xe),this.state.setCallingState(N.RECONNECTING_FAILED)})}else this.logger("error","[Rejoin]: Reconnect attempts exceeded. Giving up..."),this.state.setCallingState(N.RECONNECTING_FAILED)})});let Y=this.streamClient.on("connection.changed",O=>b(this,null,function*(){if(O.type!=="connection.changed"||!O.online)return;Y();let Q=this.state.callingState;if(!(Q===N.OFFLINE||Q===N.RECONNECTING_FAILED))return;this.logger("info","[Rejoin]: Going online...");let ne=!0;do{try{M.isFastReconnecting=ne,yield $(ne?"fast":"full","Network: online");return}catch(Se){this.logger("error",`[Rejoin][Network]: Rejoin failed for attempt ${this.reconnectAttempts}`,Se)}yield Ke(_t(this.reconnectAttempts)),ne=!1}while(this.reconnectAttempts<this.maxReconnectAttempts);this.logger("error","[Rejoin][Network]: Rejoin failed. Giving up."),this.state.setCallingState(N.RECONNECTING_FAILED)})),fe=this.streamClient.on("connection.changed",O=>{O.type==="connection.changed"&&(O.online||(fe(),this.state.setCallingState(N.OFFLINE)))});this.leaveCallHooks.add(()=>{Y(),fe()}),this.subscriber||(this.subscriber=new Zo({sfuClient:M,dispatcher:this.dispatcher,state:this.state,connectionConfig:_,onUnrecoverableError:()=>{$("full","unrecoverable subscriber error").catch(O=>{this.logger("debug","[Rejoin]: Rejoin failed",O)})}}));let ze=this.streamClient.user?.type==="anonymous";if(!this.publisher&&!ze){let O=this.state.settings?.audio,Q=!!O?.opus_dtx_enabled,ye=!!O?.redundant_coding_enabled;this.publisher=new Qo({sfuClient:M,dispatcher:this.dispatcher,state:this.state,connectionConfig:_,isDtxEnabled:Q,isRedEnabled:ye,onUnrecoverableError:()=>{$("full","unrecoverable publisher error").catch(ne=>{this.logger("debug","[Rejoin]: Rejoin failed",ne)})}})}this.statsReporter||(this.statsReporter=Yp({subscriber:this.subscriber,publisher:this.publisher,state:this.state,datacenter:this.sfuClient.edgeName}));let ei=Yu();!this.sfuStatsReporter&&P&&(this.sfuStatsReporter=new tc(M,{clientDetails:ei,options:P,subscriber:this.subscriber,publisher:this.publisher}),this.sfuStatsReporter.start());try{M.signalReady.catch(he=>this.logger("error","Signal ready failed",he)).then(()=>Gf("recvonly")).then(he=>{let ke=Je(this.trackSubscriptionsSubject),Ce=p?{fromSfuId:d?.migrating_from||"",subscriptions:ke.data||[],announcedTracks:this.publisher?.getCurrentTrackInfos()||[]}:void 0;return M.join({subscriberSdp:he||"",clientDetails:ei,migration:Ce,fastReconnect:A?.isFastReconnecting??!1})});let{callState:O,reconnected:Q}=yield this.waitForJoinResponse();if(g&&this.logger("debug","[Rejoin] fast reconnected:",Q),p)yield this.subscriber.migrateTo(M,_),yield this.publisher?.migrateTo(M,_);else if(g){if(Q)this.subscriber.setSfuClient(M),this.publisher&&(this.publisher.setSfuClient(M),yield this.publisher.restartIce());else if(A?.isFastReconnecting)return yield $("full","re-attempting").catch(he=>{this.logger("error","[Rejoin]: Rejoin failed forced full rejoin.",he)})}let ye=O?.participants||[],ne=O?.participantCount,Se=O?.startedAt?_e.toDate(O.startedAt):new Date,Xe=O?.pins??[];this.state.setParticipants(()=>{let he=this.state.getParticipantLookupBySessionId();return ye.map(ke=>{let Ce=he[ke.sessionId];return Object.assign(ke,Ce,{isLocalParticipant:ke.sessionId===M.sessionId,viewportVisibilityState:Ce?.viewportVisibilityState??{videoTrack:re.UNKNOWN,screenShareTrack:re.UNKNOWN}})})}),this.state.setParticipantCount(ne?.total||0),this.state.setAnonymousParticipantCount(ne?.anonymous||0),this.state.setStartedAt(Se),this.state.setServerSidePins(Xe),this.reconnectAttempts=0,this.state.setCallingState(N.JOINED);try{yield this.initCamera({setStatus:!0}),yield this.initMic({setStatus:!0})}catch(he){this.logger("warn","Camera and/or mic init failed during join call",he)}let{remoteParticipants:Ye}=this.state;Ye.length>0&&this.updateSubscriptions(Ye,Be.FAST),this.logger("info",`Joined call ${this.cid}`)}catch(O){if(this.reconnectAttempts<this.maxReconnectAttempts)this.logger("error",`[Rejoin]: Rejoin ${this.reconnectAttempts} failed.`,O),yield $("full","previous attempt failed"),this.logger("info",`[Rejoin]: Rejoin ${this.reconnectAttempts} successful!`);else throw this.logger("error",`[Rejoin]: Rejoin failed for ${this.reconnectAttempts} times. Giving up.`),this.state.setCallingState(N.RECONNECTING_FAILED),new Error("Join failed")}}),this.waitForJoinResponse=(d=5e3)=>new Promise((f,p)=>{let g=this.on("joinResponse",k=>{clearTimeout(v),g(),f(k)}),v=setTimeout(()=>{g(),p(new Error('Waiting for "joinResponse" has timed out'))},d)}),this.publishVideoStream=(p,...g)=>b(this,[p,...g],function*(d,f={}){if(yield this.assertCallJoined(),!this.publisher)throw this.logger("error","Trying to publish video before join is completed"),new Error("Call not joined yet.");let[v]=d.getVideoTracks();if(!v){this.logger("error","There is no video track to publish in the stream.");return}yield this.publisher.publishStream(d,v,T.VIDEO,f)}),this.publishAudioStream=d=>b(this,null,function*(){if(yield this.assertCallJoined(),!this.publisher)throw this.logger("error","Trying to publish audio before join is completed"),new Error("Call not joined yet.");let[f]=d.getAudioTracks();if(!f){this.logger("error","There is no audio track in the stream to publish");return}yield this.publisher.publishStream(d,f,T.AUDIO)}),this.publishScreenShareStream=(p,...g)=>b(this,[p,...g],function*(d,f={}){if(yield this.assertCallJoined(),!this.publisher)throw this.logger("error","Trying to publish screen share before join is completed"),new Error("Call not joined yet.");let[v]=d.getVideoTracks();if(!v){this.logger("error","There is no video track in the screen share stream to publish");return}yield this.publisher.publishStream(d,v,T.SCREEN_SHARE,f);let[k]=d.getAudioTracks();k&&(yield this.publisher.publishStream(d,k,T.SCREEN_SHARE_AUDIO,f))}),this.stopPublish=(d,f=!0)=>b(this,null,function*(){this.logger("info",`stopPublish ${T[d]}, stop tracks: ${f}`),yield this.publisher?.unpublishStream(d,f)}),this.notifyNoiseCancellationStarting=()=>b(this,null,function*(){return this.sfuClient?.startNoiseCancellation().catch(d=>{this.logger("warn","Failed to notify start of noise cancellation",d)})}),this.notifyNoiseCancellationStopped=()=>b(this,null,function*(){return this.sfuClient?.stopNoiseCancellation().catch(d=>{this.logger("warn","Failed to notify stop of noise cancellation",d)})}),this.updateSubscriptionsPartial=(d,f,p=Be.SLOW)=>{d==="video"?(this.logger("warn",`updateSubscriptionsPartial: ${d} is deprecated. Please switch to 'videoTrack'`),d="videoTrack"):d==="screen"&&(this.logger("warn",`updateSubscriptionsPartial: ${d} is deprecated. Please switch to 'screenShareTrack'`),d="screenShareTrack");let g=this.state.updateParticipants(Object.entries(f).reduce((v,[k,_])=>{_.dimension?.height&&(_.dimension.height=Math.ceil(_.dimension.height)),_.dimension?.width&&(_.dimension.width=Math.ceil(_.dimension.width));let P=d==="videoTrack"?"videoDimension":d==="screenShareTrack"?"screenShareDimension":void 0;return P&&(v[k]={[P]:_.dimension}),v},{}));g&&this.updateSubscriptions(g,p)},this.updateSubscriptions=(d,f=Be.SLOW)=>{let p=[];for(let g of d)g.isLocalParticipant||(g.videoDimension&&qt(g)&&p.push({userId:g.userId,sessionId:g.sessionId,trackType:T.VIDEO,dimension:g.videoDimension}),g.screenShareDimension&&Et(g)&&p.push({userId:g.userId,sessionId:g.sessionId,trackType:T.SCREEN_SHARE,dimension:g.screenShareDimension}),up(g)&&p.push({userId:g.userId,sessionId:g.sessionId,trackType:T.SCREEN_SHARE_AUDIO}));this.trackSubscriptionsSubject.next({type:f,data:p})},this.startReportingStatsFor=d=>this.statsReporter?.startReportingStatsFor(d),this.stopReportingStatsFor=d=>this.statsReporter?.stopReportingStatsFor(d),this.resetReaction=d=>{this.state.updateParticipant(d,{reaction:void 0})},this.setSortParticipantsBy=d=>this.state.setSortParticipantsBy(d),this.updatePublishQuality=d=>b(this,null,function*(){return this.publisher?.updateVideoPublishQuality(d)}),this.assertCallJoined=()=>new Promise(d=>{this.state.callingState$.pipe(Hi(f=>f!==N.JOINED,!0),$c(f=>f===N.JOINED)).subscribe(()=>d())}),this.sendReaction=d=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/reaction`,d)}),this.blockUser=d=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/block`,{user_id:d})}),this.unblockUser=d=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/unblock`,{user_id:d})}),this.muteSelf=d=>{let f=this.currentUserId;if(f)return this.muteUser(f,d)},this.muteOthers=d=>{let f=rp(d);if(!f)return;let p=[];for(let g of this.state.remoteParticipants)g.publishedTracks.includes(f)&&p.push(g.userId);return this.muteUser(p,d)},this.muteUser=(d,f)=>this.streamClient.post(`${this.streamClientBasePath}/mute_users`,{user_ids:Array.isArray(d)?d:[d],[f]:!0}),this.muteAllUsers=d=>this.streamClient.post(`${this.streamClientBasePath}/mute_users`,{mute_all_users:!0,[d]:!0}),this.startRecording=d=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/start_recording`,d||{})}),this.stopRecording=()=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/stop_recording`,{})}),this.startTranscription=d=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/start_transcription`,d)}),this.stopTranscription=()=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/stop_transcription`)}),this.requestPermissions=d=>b(this,null,function*(){let{permissions:f}=d;if(!f.every(g=>this.permissionsContext.canRequest(g)))throw new Error(`You are not allowed to request permissions: ${f.join(", ")}`);return this.streamClient.post(`${this.streamClientBasePath}/request_permission`,d)}),this.grantPermissions=(d,f)=>b(this,null,function*(){return this.updateUserPermissions({user_id:d,grant_permissions:f})}),this.revokePermissions=(d,f)=>b(this,null,function*(){return this.updateUserPermissions({user_id:d,revoke_permissions:f})}),this.updateUserPermissions=d=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/user_permissions`,d)}),this.goLive=(...p)=>b(this,[...p],function*(d={},f){return this.streamClient.post(`${this.streamClientBasePath}/go_live`,d,f)}),this.stopLive=()=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/stop_live`,{})}),this.startHLS=()=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/start_broadcasting`,{})}),this.stopHLS=()=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/stop_broadcasting`,{})}),this.update=d=>b(this,null,function*(){let f=yield this.streamClient.patch(`${this.streamClientBasePath}`,d),{call:p,members:g,own_capabilities:v}=f;return this.state.updateFromCallResponse(p),this.state.setMembers(g),this.state.setOwnCapabilities(v),f}),this.endCall=()=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/mark_ended`)}),this.pin=d=>{this.state.updateParticipant(d,{pin:{isLocalPin:!0,pinnedAt:Date.now()}})},this.unpin=d=>{this.state.updateParticipant(d,{pin:void 0})},this.pinForEveryone=d=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/pin`,d)}),this.unpinForEveryone=d=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/unpin`,d)}),this.queryMembers=d=>this.streamClient.post("/call/members",L(E({},d||{}),{id:this.id,type:this.type})),this.updateCallMembers=d=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/members`,d)}),this.scheduleAutoDrop=()=>{clearTimeout(this.dropTimeout),this.leaveCallHooks.add(Oe(this.state.settings$,d=>{if(!d||this.state.callingState!==N.RINGING)return;let f=d.ring.auto_cancel_timeout_ms;f<=0||(clearTimeout(this.dropTimeout),this.dropTimeout=setTimeout(()=>{this.leave({reason:"ring: timeout"}).catch(p=>{this.logger("error","Failed to drop call",p)})},f))}))},this.queryRecordings=d=>b(this,null,function*(){let f=this.streamClientBasePath;return d&&(f=`${f}/${d}`),this.streamClient.get(`${f}/recordings`)}),this.queryTranscriptions=()=>b(this,null,function*(){return this.streamClient.get(`${this.streamClientBasePath}/transcriptions`)}),this.getCallStats=d=>b(this,null,function*(){let f=`${this.streamClientBasePath}/stats/${d}`;return this.streamClient.get(f)}),this.submitFeedback=(g,...v)=>b(this,[g,...v],function*(d,{reason:f,custom:p}={}){if(d<1||d>5)throw new Error("Rating must be between 1 and 5");let k=this.state.session?.id;if(!k)throw new Error("Feedback can be submitted only in the context of a call session");let Y=Xp(Yu()),{sdkName:_,sdkVersion:P}=Y,A=ps(Y,["sdkName","sdkVersion"]),M=this.sfuClient?.sessionId??"N/A",$=`${this.streamClientBasePath}/feedback/${k}`;return this.streamClient.post($,{rating:d,reason:f,user_session_id:M,sdk:_,sdk_version:P,custom:L(E({},p),{"x-stream-platform-data":A})})}),this.sendCustomEvent=d=>b(this,null,function*(){return this.streamClient.post(`${this.streamClientBasePath}/event`,{custom:d})}),this.applyDeviceConfig=()=>b(this,null,function*(){yield this.initCamera({setStatus:!1}).catch(d=>{this.logger("warn","Camera init failed",d)}),yield this.initMic({setStatus:!1}).catch(d=>{this.logger("warn","Mic init failed",d)})}),this.trackElementVisibility=(d,f,p)=>this.dynascaleManager.trackElementVisibility(d,f,p),this.setViewport=d=>this.dynascaleManager.setViewport(d),this.bindVideoElement=(d,f,p)=>{let g=this.dynascaleManager.bindVideoElement(d,f,p);if(g)return this.leaveCallHooks.add(g),()=>{this.leaveCallHooks.delete(g),g()}},this.bindAudioElement=(d,f,p="audioTrack")=>{let g=this.dynascaleManager.bindAudioElement(d,f,p);if(g)return this.leaveCallHooks.add(g),()=>{this.leaveCallHooks.delete(g),g()}},this.bindCallThumbnailElement=(d,f={})=>{let p=()=>{d.src=f.fallbackImageSource||"https://getstream.io/random_svg/?name=x&id=x"},g=Oe(this.state.thumbnails$,v=>{if(!v)return;d.addEventListener("error",p);let k=new URL(v.image_url);k.searchParams.set("w",String(d.clientWidth)),k.searchParams.set("h",String(d.clientHeight)),d.src=k.toString()});return()=>{g(),d.removeEventListener("error",p)}},this.type=e,this.id=t,this.cid=`${e}:${t}`,this.ringingSubject=new F(l),this.watching=c,this.streamClient=n,this.clientStore=a,this.streamClientBasePath=`/call/${this.type}/${this.id}`,this.logger=ie(["Call"]);let u=tm.get(e),h=o||u.options.sortParticipantsBy;h&&this.state.setSortParticipantsBy(h),this.state.setMembers(s||[]),this.state.setOwnCapabilities(r||[]),this.state.setCallingState(l?N.RINGING:N.IDLE),this.on("all",d=>{this.state.updateFromEvent(d)}),this.leaveCallHooks.add(Gp(this,this.state,this.dispatcher)),this.registerEffects(),this.leaveCallHooks.add(Oe(this.trackSubscriptionsSubject.pipe(Wc(d=>Mc(d.type)),we(d=>d.data)),d=>this.sfuClient?.updateSubscriptions(d).catch(f=>{this.logger("debug","Failed to update track subscriptions",f)}))),this.camera=new oc(this),this.microphone=new uc(this),this.speaker=new pc(this),this.screenShare=new hc(this)}registerEffects(){this.leaveCallHooks.add(Oe(this.state.settings$,e=>{e&&this.permissionsContext.setCallSettings(e)})),this.leaveCallHooks.add(Oe(this.state.ownCapabilities$,e=>{if(this.permissionsContext.setPermissions(e),!this.publisher)return;let t={[xe.SEND_AUDIO]:T.AUDIO,[xe.SEND_VIDEO]:T.VIDEO,[xe.SCREENSHARE]:T.SCREEN_SHARE};for(let[n,s]of Object.entries(t))!this.permissionsContext.hasPermission(n)&&(this.publisher.isPublishing(s)||this.publisher.isLive(s))&&this.stopPublish(s).catch(o=>{this.logger("error",`Error stopping publish ${s}`,o)}).then(()=>{s===T.VIDEO&&this.camera.state.status==="enabled"&&this.camera.disable().catch(o=>this.logger("error","Error disabling camera after permission revoked",o)),s===T.AUDIO&&this.microphone.state.status==="enabled"&&this.microphone.disable().catch(o=>this.logger("error","Error disabling microphone after permission revoked",o))})})),this.leaveCallHooks.add(Oe(this.state.blockedUserIds$,e=>b(this,null,function*(){if(!e||e.length===0)return;let t=this.currentUserId;t&&e.includes(t)&&(this.logger("info","Leaving call because of being blocked"),yield this.leave({reason:"user blocked"}).catch(n=>{this.logger("error","Error leaving call after being blocked",n)}))}))),this.leaveCallHooks.add(Oe(this.state.callingState$,e=>{this.ringing&&(e===N.JOINED||e===N.JOINING||e===N.LEFT)&&(clearTimeout(this.dropTimeout),this.dropTimeout=void 0)})),this.leaveCallHooks.add(Oe(this.ringingSubject,e=>{e&&(this.scheduleAutoDrop(),this.state.callingState===N.IDLE&&this.state.setCallingState(N.RINGING),this.leaveCallHooks.add(Ed(this)))}))}get ringing(){return Je(this.ringingSubject)}get currentUserId(){return this.clientStore.connectedUser?.id}get isCreatedByMe(){return this.state.createdBy?.id===this.currentUserId}initCamera(e){return b(this,null,function*(){if(yield this.camera.statusChangeSettled(),this.state.localParticipant?.videoStream||!this.permissionsContext.hasPermission("send-video"))return;if(!this.camera.state.direction&&!this.camera.state.selectedDevice){let n="front",s=this.state.settings?.video.camera_facing;s&&(n=s==="front"?"front":"back"),this.camera.state.setDirection(n)}let t=this.state.settings?.video.target_resolution;t&&(yield this.camera.selectTargetResolution(t)),e.setStatus&&(this.camera.state.status==="enabled"&&this.camera.state.mediaStream&&!this.publisher?.isPublishing(T.VIDEO)&&(yield this.publishVideoStream(this.camera.state.mediaStream,{preferredCodec:this.camera.preferredCodec})),this.camera.state.status===void 0&&this.state.settings?.video.camera_default_on&&(yield this.camera.enable()))})}initMic(e){return b(this,null,function*(){yield this.microphone.statusChangeSettled(),!(this.state.localParticipant?.audioStream||!this.permissionsContext.hasPermission("send-audio"))&&e.setStatus&&(this.microphone.state.status==="enabled"&&this.microphone.state.mediaStream&&!this.publisher?.isPublishing(T.AUDIO)&&(yield this.publishAudioStream(this.microphone.state.mediaStream)),this.microphone.state.status===void 0&&this.state.settings?.audio.mic_default_on&&(yield this.microphone.enable()))})}},gm=null,mc=class{constructor(){this.connectionStartTimestamp=null,this.wsTotalFailures=0,this.wsConsecutiveFailures=0,this.instanceClientId=xi()}},gc=(i,e)=>b(void 0,null,function*(){for(let n=0;n<3;n++){try{yield Ct.post(`https://chat-insights.getstream.io/insights/${i}`,e)}catch{yield Ke((n+1)*3e3);continue}break}});function bm(i,e){return E(E({},e),Dd(i))}function Dd(i){let{client:e}=i;return{ready_state:i.ws?.readyState,url:i._buildUrl(),api_key:e.key,start_ts:e.insightMetrics.connectionStartTimestamp,end_ts:new Date().getTime(),auth_type:e.getAuthType(),token:e.tokenManager.token,user_id:e.userID,user_details:e._user,device:"browser",client_id:i.connectionID,ws_details:i.ws,ws_consecutive_failures:e.insightMetrics.wsConsecutiveFailures,ws_total_failures:e.insightMetrics.wsTotalFailures,request_id:i.requestID,online:typeof navigator<"u"?navigator?.onLine:null,user_agent:typeof navigator<"u"?navigator?.userAgent:null,instance_client_id:e.insightMetrics.instanceClientId}}function ym(i){return Dd(i)}var Sm=i=>i.code!==void 0,km=i=>i.error!==void 0,bc=class{constructor(e){this._log=(t,n={},s="info")=>{this.client.logger(s,"connection:"+t,E({},n))},this.setClient=t=>{this.client=t},this._buildUrl=()=>{let t=new URLSearchParams;return t.set("api_key",this.client.key),t.set("stream-auth-type",this.client.getAuthType()),t.set("X-Stream-Client",this.client.getUserAgent()),`${this.client.wsBaseURL}/connect?${t.toString()}`},this.onlineStatusChanged=t=>{t.type==="offline"?(this._log("onlineStatusChanged() - Status changing to offline"),this._setHealth(!1,!0)):t.type==="online"&&(this._log(`onlineStatusChanged() - Status changing to online. isHealthy: ${this.isHealthy}`),this.isHealthy||this._reconnect({interval:10}))},this.onopen=t=>{if(this.wsID!==t)return;let n=this.client.user;if(!n){this.client.logger("error","User not set, can't connect to WS");return}let s=this.client._getToken();if(!s){this.client.logger("error","Token not set, can't connect authenticate");return}let r={token:s,user_details:{id:n.id,name:n.name,image:n.image,custom:n.custom}};this.authenticationSent=!0,this.ws?.send(JSON.stringify(r)),this._log("onopen() - onopen callback",{wsID:t})},this.onmessage=(t,n)=>{if(this.wsID!==t)return;this._log("onmessage() - onmessage callback",{event:n,wsID:t});let s=typeof n.data=="string"?JSON.parse(n.data):null;if(!this.isResolved&&s&&s.type==="connection.error"&&(this.isResolved=!0,s.error)){this.rejectPromise?.(this._errorFromWSEvent(s,!1));return}if(this.lastEvent=new Date,s&&(s.type==="health.check"||s.type==="connection.ok")&&this.scheduleNextPing(),s&&s.type==="connection.ok"&&(this.resolvePromise?.(s),this._setHealth(!0)),s&&s.type==="connection.error"&&s.error){let{code:r}=s.error;this.isHealthy=!1,this.isConnecting=!1,this.consecutiveFailures+=1,r===st.TOKEN_EXPIRED&&!this.client.tokenManager.isStatic()&&(clearTimeout(this.connectionCheckTimeoutRef),this._log("connect() - WS failure due to expired token, so going to try to reload token and reconnect"),this._reconnect({refreshToken:!0}))}s&&this.client.dispatchEvent(s),this.scheduleConnectionCheck()},this.onclose=(t,n)=>{if(this.wsID===t)if(this._log("onclose() - onclose callback - "+n.code,{event:n,wsID:t}),n.code===st.WS_CLOSED_SUCCESS){let s=new Error(`WS connection reject with error ${n.reason}`);s.reason=n.reason,s.code=n.code,s.wasClean=n.wasClean,s.target=n.target,this.rejectPromise?.(s),this._log(`onclose() - WS connection reject with error ${n.reason}`,{event:n})}else this.consecutiveFailures+=1,this.totalFailures+=1,this._setHealth(!1),this.isConnecting=!1,this.rejectPromise?.(this._errorFromWSEvent(n)),this._log("onclose() - WS connection closed. Calling reconnect ...",{event:n}),this._reconnect()},this.onerror=(t,n)=>{this.wsID===t&&(this.consecutiveFailures+=1,this.totalFailures+=1,this._setHealth(!1),this.isConnecting=!1,this.rejectPromise?.(this._errorFromWSEvent(n)),this._log("onerror() - WS connection resulted into error",{event:n}),this._reconnect())},this._setHealth=(t,n=!1)=>{if(t!==this.isHealthy){if(this.isHealthy=t,this.isHealthy||n){this.client.dispatchEvent({type:"connection.changed",online:this.isHealthy});return}setTimeout(()=>{this.isHealthy||this.client.dispatchEvent({type:"connection.changed",online:this.isHealthy})},5e3)}},this._errorFromWSEvent=(t,n=!0)=>{let s,r,o;Sm(t)&&(s=t.code,r="unknown",o=t.reason),km(t)&&(s=t.error.code,r=t.error.StatusCode,o=t.error.message),this._log(`_errorFromWSEvent() - WS failed with code ${s}`,{event:t},"warn");let a=new Error(`WS failed with code ${s} and reason - ${o}`);return a.code=s,a.StatusCode=r,a.isWSFailure=n,a},this._setupConnectionPromise=()=>{this.isResolved=!1,this.connectionOpen=new Promise((t,n)=>{this.resolvePromise=t,this.rejectPromise=n})},this.scheduleNextPing=()=>{this.healthCheckTimeoutRef&&clearTimeout(this.healthCheckTimeoutRef),this.healthCheckTimeoutRef=setTimeout(()=>{let t=[{type:"health.check",client_id:this.client.clientID}];try{this.ws?.send(JSON.stringify(t))}catch{}},this.pingInterval)},this.scheduleConnectionCheck=()=>{this.connectionCheckTimeoutRef&&clearTimeout(this.connectionCheckTimeoutRef),this.connectionCheckTimeoutRef=setTimeout(()=>{let t=new Date;this.lastEvent&&t.getTime()-this.lastEvent.getTime()>this.connectionCheckTimeout&&(this._log("scheduleConnectionCheck - going to reconnect"),this._setHealth(!1),this._reconnect())},this.connectionCheckTimeout)},this.client=e,this.consecutiveFailures=0,this.totalFailures=0,this.isConnecting=!1,this.authenticationSent=!1,this.isDisconnected=!1,this.isResolved=!1,this.isHealthy=!1,this.wsID=1,this.lastEvent=null,this.pingInterval=25*1e3,this.connectionCheckTimeout=this.pingInterval+10*1e3,vd(this.onlineStatusChanged)}connect(e=15e3){return b(this,null,function*(){if(this.isConnecting)throw Error("You've called connect twice, can only attempt 1 connection at the time");this.isDisconnected=!1;try{let t=yield this._connect();this.consecutiveFailures=0,this._log(`connect() - Established ws connection with healthcheck: ${t}`)}catch(t){if(this.isHealthy=!1,this.consecutiveFailures+=1,t.code===st.TOKEN_EXPIRED&&!this.client.tokenManager.isStatic())this._log("connect() - WS failure due to expired token, so going to try to reload token and reconnect"),this._reconnect({refreshToken:!0});else if(!t.isWSFailure)throw new Error(JSON.stringify({code:t.code,StatusCode:t.StatusCode,message:t.message,isWSFailure:t.isWSFailure}))}return yield this._waitForHealthy(e)})}_waitForHealthy(e=15e3){return b(this,null,function*(){return Promise.race([b(this,null,function*(){for(let n=0;n<=e;n+=50)try{return yield this.connectionOpen}catch(s){if(n===e)throw new Error(JSON.stringify({code:s.code,StatusCode:s.StatusCode,message:s.message,isWSFailure:s.isWSFailure}));yield Ke(50)}}),b(this,null,function*(){throw yield Ke(e),this.isConnecting=!1,new Error(JSON.stringify({code:"",StatusCode:"",message:"initial WS connection could not be established",isWSFailure:!0}))})])})}disconnect(e){this._log(`disconnect() - Closing the websocket connection for wsID ${this.wsID}`),this.wsID+=1,this.isConnecting=!1,this.isDisconnected=!0,this.healthCheckTimeoutRef&&clearInterval(this.healthCheckTimeoutRef),this.connectionCheckTimeoutRef&&clearInterval(this.connectionCheckTimeoutRef),Td(this.onlineStatusChanged),this.isHealthy=!1,this.ws&&this.ws.removeAllListeners&&this.ws.removeAllListeners();let t,{ws:n}=this;return n&&n.close&&n.readyState===n.OPEN?(t=new Promise(s=>{let r=o=>{this._log(`disconnect() - resolving isClosedPromise ${o?"with":"without"} close frame`,{event:o}),s()};n.onclose=r,setTimeout(r,e??1e3)}),this._log("disconnect() - Manually closed connection by calling client.disconnect()"),n.close(st.WS_CLOSED_SUCCESS,"Manually closed connection by calling client.disconnect()")):(this._log("disconnect() - ws connection doesn't exist or it is already closed."),t=Promise.resolve()),delete this.ws,t}_connect(){return b(this,null,function*(){if(this.isConnecting||this.isDisconnected&&this.client.options.enableWSFallback)return;this.isConnecting=!0,this.requestID=xi(),this.client.insightMetrics.connectionStartTimestamp=new Date().getTime();let e=!1;try{this._log("_connect() - waiting for token"),yield this.client.tokenManager.tokenReady(),e=!0}catch{}try{e||(this._log("_connect() - tokenProvider failed before, so going to retry"),yield this.client.tokenManager.loadToken()),this._setupConnectionPromise();let t=this._buildUrl();this._log(`_connect() - Connecting to ${t}`,{wsURL:t,requestID:this.requestID}),this.ws=new Dr(t),this.ws.onopen=this.onopen.bind(this,this.wsID),this.ws.onclose=this.onclose.bind(this,this.wsID),this.ws.onerror=this.onerror.bind(this,this.wsID),this.ws.onmessage=this.onmessage.bind(this,this.wsID);let n=yield this.connectionOpen;if(this.isConnecting=!1,n)return this.connectionID=n.connection_id,this.client.resolveConnectionId?.(this.connectionID),this.client.insightMetrics.wsConsecutiveFailures>0&&this.client.options.enableInsights&&(gc("ws_success_after_failure",ym(this)),this.client.insightMetrics.wsConsecutiveFailures=0),n}catch(t){if(this.isConnecting=!1,this._log("_connect() - Error - ",t),this.client.options.enableInsights){this.client.insightMetrics.wsConsecutiveFailures++,this.client.insightMetrics.wsTotalFailures++;let n=bm(this,Tp(t));gc?.("ws_fatal",n)}throw this.client.rejectConnectionId?.(),t}})}_reconnect(){return b(this,arguments,function*(e={}){if(this._log("_reconnect() - Initiating the reconnect"),this.isConnecting||this.isHealthy){this._log("_reconnect() - Abort (1) since already connecting or healthy");return}let t=e.interval;if(t||(t=_t(this.consecutiveFailures)),yield Ke(t),this.isConnecting||this.isHealthy){this._log("_reconnect() - Abort (2) since already connecting or healthy");return}if(this.isDisconnected&&this.client.options.enableWSFallback){this._log("_reconnect() - Abort (3) since disconnect() is called");return}this._log("_reconnect() - Destroying current WS connection"),this._destroyCurrentWSConnection(),e.refreshToken&&(yield this.client.tokenManager.loadToken());try{yield this._connect(),this._log("_reconnect() - Waiting for recoverCallBack"),this._log("_reconnect() - Finished recoverCallBack"),this.consecutiveFailures=0}catch(n){if(this.isHealthy=!1,this.consecutiveFailures+=1,n.code===st.TOKEN_EXPIRED&&!this.client.tokenManager.isStatic())return this._log("_reconnect() - WS failure due to expired token, so going to try to reload token and reconnect"),this._reconnect({refreshToken:!0});n.isWSFailure&&(this._log("_reconnect() - WS failure, so going to try to reconnect"),this._reconnect())}this._log("_reconnect() - == END ==")})}_destroyCurrentWSConnection(){this.wsID+=1;try{this?.ws?.removeAllListeners(),this?.ws?.close()}catch{}}};function yc(i){return typeof i=="string"}function rd(i,e){return!!e&&yc(i)}function Cm(i,e){let t=[];if(yc(i)&&rd(i,e)){for(let n=0,s=i.length;n<s;n++)if(i.charAt(n)){let r=i.charAt(n),o=e(r,n,i);t[n]=o}}else if(!yc(i)&&!rd(i,e)){for(let n=0,s=i.length;n<s;n++)if(n in i){let r=i[n],o=e(r,n,i);t[n]=o}}return t}var wm=i=>(0,ud.fromByteArray)(new Uint8Array(Cm(i,e=>e.charCodeAt(0)))),vm=i=>{let e={},t=String.fromCharCode,n=i.length,s,r=0,o,a,l=0,c,u="",h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(s=0;s<64;s++)e[h.charAt(s)]=s;for(a=0;a<n;a++)for(o=e[i.charAt(a)],r=(r<<6)+o,l+=6;l>=8;)((c=r>>>(l-=8)&255)||a<n-2)&&(u+=t(c));return u};function Tm(i){return["eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9",wm(JSON.stringify({user_id:i})),"devtoken"].join(".")}function Rm(i){let e=i.split(".");if(e.length!==3)return"";let t=e[1],n=vm(t);return JSON.parse(n).user_id}var Sc=class{constructor(e){this.setTokenOrProvider=(t,n,s)=>b(this,null,function*(){this.validateToken(t,n,s),this.user=n,ec(t)&&(this.tokenProvider=t,this.type="provider"),typeof t=="string"&&(this.token=t,this.type="static"),yield this.loadToken()}),this.reset=()=>{this.token=void 0,this.user=void 0,this.loadTokenPromise=null},this.validateToken=(t,n,s)=>{if(!(n&&s&&!t)){if(!this.secret&&!t)throw new Error("UserWithId token can not be empty");if(t&&typeof t!="string"&&!ec(t))throw new Error("user token should either be a string or a function");if(typeof t=="string"){if(s&&t==="")return;let r=Rm(t);if(t!=null&&(r==null||r===""||!s&&r!==n.id))throw new Error("userToken does not have a user_id or is not matching with user.id")}}},this.tokenReady=()=>this.loadTokenPromise,this.loadToken=()=>(this.loadTokenPromise=new Promise((t,n)=>b(this,null,function*(){if(this.type==="static")return t(this.token);if(this.tokenProvider&&typeof this.tokenProvider!="string"){try{this.token=yield this.tokenProvider()}catch(s){return n(new Error(`Call to tokenProvider failed with message: ${s}`))}t(this.token)}})),this.loadTokenPromise),this.getToken=()=>{if(this.token)return this.token;if(this.user&&!this.token)return this.token;throw new Error("Both secret and user tokens are not set. Either client.connectUser wasn't called or client.disconnect was called")},this.isStatic=()=>this.type==="static",this.loadTokenPromise=null,e&&(this.secret=e),this.type="static"}},Em={"-1":{name:"InternalSystemError",retryable:!0},2:{name:"AccessKeyError",retryable:!1},3:{name:"AuthenticationFailedError",retryable:!0},4:{name:"InputError",retryable:!1},6:{name:"DuplicateUsernameError",retryable:!1},9:{name:"RateLimitError",retryable:!0},16:{name:"DoesNotExistError",retryable:!1},17:{name:"NotAllowedError",retryable:!1},18:{name:"EventNotSupportedError",retryable:!1},19:{name:"ChannelFeatureNotSupportedError",retryable:!1},20:{name:"MessageTooLongError",retryable:!1},21:{name:"MultipleNestingLevelError",retryable:!1},22:{name:"PayloadTooBigError",retryable:!1},23:{name:"RequestTimeoutError",retryable:!0},24:{name:"MaxHeaderSizeExceededError",retryable:!1},40:{name:"AuthErrorTokenExpired",retryable:!1},41:{name:"AuthErrorTokenNotValidYet",retryable:!1},42:{name:"AuthErrorTokenUsedBeforeIssuedAt",retryable:!1},43:{name:"AuthErrorTokenSignatureInvalid",retryable:!1},44:{name:"CustomCommandEndpointMissingError",retryable:!1},45:{name:"CustomCommandEndpointCallError",retryable:!0},46:{name:"ConnectionIDNotFoundError",retryable:!1},60:{name:"CoolDownError",retryable:!0},69:{name:"ErrWrongRegion",retryable:!1},70:{name:"ErrQueryChannelPermissions",retryable:!1},71:{name:"ErrTooManyConnections",retryable:!0},99:{name:"AppSuspendedError",retryable:!1}};function Im(i){return i.code!==void 0}function ad(i){if(!i.code)return!1;let e=Em[`${i.code}`];return e?e.retryable:!1}function _m(i){return i.code===46}function Pm(i){if(typeof i.isWSFailure=="boolean")return i.isWSFailure;try{return JSON.parse(i.message).isWSFailure}catch{return!1}}function Nm(i){return!i.status||i.status<200||300<=i.status}var le=function(i){return i.Closed="CLOSED",i.Connected="CONNECTED",i.Connecting="CONNECTING",i.Disconnected="DISCONNECTED",i.Init="INIT",i}(le||{}),kc=class{constructor(e){this._onlineStatusChanged=t=>{if(this._log(`_onlineStatusChanged() - ${t.type}`),t.type==="offline"){this._setState(le.Closed),this.cancelToken?.cancel("disconnect() is called"),this.cancelToken=void 0;return}t.type==="online"&&this.state===le.Closed&&this.connect(!0)},this._req=(t,n,s)=>b(this,null,function*(){!this.cancelToken&&!t.close&&(this.cancelToken=Ct.CancelToken.source());try{let r=yield this.client.doAxiosRequest("get",this.client.baseURL.replace(":3030",":8900")+"/longpoll",void 0,{config:L(E({},n),{cancelToken:this.cancelToken?.token}),params:t,publicEndpoint:!0});return this.consecutiveFailures=0,r}catch(r){if(this.consecutiveFailures+=1,s&&ad(r))return this._log("_req() - Retryable error, retrying request"),yield Ke(_t(this.consecutiveFailures)),this._req(t,n,s);throw r}}),this._poll=()=>b(this,null,function*(){for(;this.state===le.Connected;)try{let t=yield this._req({},{timeout:3e4},!0);if(t.events?.length)for(let n=0;n<t.events.length;n++)this.client.dispatchEvent(t.events[n])}catch(t){if(Ct.isCancel(t)){this._log("_poll() - axios canceled request");return}if(_m(t)){this._log("_poll() - ConnectionID error, connecting without ID..."),this._setState(le.Disconnected),this.connect(!0);return}if(Im(t)&&!ad(t)){this._setState(le.Closed);return}yield Ke(_t(this.consecutiveFailures))}}),this.connect=(t=!1)=>b(this,null,function*(){if(this.state===le.Connecting){this._log("connect() - connecting already in progress",{reconnect:t},"warn");return}if(this.state===le.Connected){this._log("connect() - already connected and polling",{reconnect:t},"warn");return}this._setState(le.Connecting),this.connectionID=void 0;try{let{event:n}=yield this._req({json:this.client._buildWSPayload()},{timeout:8e3},t);return this._setState(le.Connected),this.connectionID=n.connection_id,this.client.resolveConnectionId?.(),this.client.dispatchEvent(n),this._poll(),n}catch(n){throw this._setState(le.Closed),this.client.rejectConnectionId?.(),n}}),this.isHealthy=()=>!!this.connectionID&&this.state===le.Connected,this.disconnect=(t=2e3)=>b(this,null,function*(){Td(this._onlineStatusChanged),this._setState(le.Disconnected),this.cancelToken?.cancel("disconnect() is called"),this.cancelToken=void 0;let n=this.connectionID;this.connectionID=void 0;try{yield this._req({close:!0,connection_id:n},{timeout:t},!1),this._log("disconnect() - Closed connectionID")}catch(s){this._log("disconnect() - Failed",{err:s},"error")}}),this.client=e,this.state=le.Init,this.consecutiveFailures=0,vd(this._onlineStatusChanged)}_log(e,t={},n="info"){this.client.logger(n,"WSConnectionFallback:"+e,E({},t))}_setState(e){this._log(`_setState() - ${e}`),this.state===le.Connecting&&e===le.Connected&&this.client.dispatchEvent({type:"connection.changed",online:!0}),(e===le.Closed||e===le.Disconnected)&&this.client.dispatchEvent({type:"connection.changed",online:!1}),this.state=e}},od=ie(["location"]),Om="https://hint.stream-io-video.com/",cd=(...t)=>b(void 0,[...t],function*(i=Om,e=2e3){let n=new AbortController,s=setTimeout(()=>n.abort(),e);try{let o=(yield fetch(i,{method:"HEAD",signal:n.signal})).headers.get("x-amz-cf-pop")||"ERR";return od("debug",`Location header: ${o}`),o.substring(0,3)}catch(r){return od("warn",`Failed to get location hint from ${i}`,r),"ERR"}finally{clearTimeout(s)}}),Qn=class{constructor(e,t){this.listeners={},this.nextRequestAbortController=null,this.devToken=s=>Tm(s),this.getAuthType=()=>this.anonymous?"anonymous":"jwt",this.setBaseURL=s=>{this.baseURL=s,this.wsBaseURL=this.baseURL.replace("http","ws").replace(":3030",":8800")},this.getLocationHint=(s,r)=>b(this,null,function*(){let o=yield this.locationHint;return!o||o==="ERR"?(this.locationHint=cd(s??this.options.locationHintUrl,r??this.options.locationHintTimeout),this.locationHint):o}),this._getConnectionID=()=>this.wsConnection?.connectionID||this.wsFallback?.connectionID,this._hasConnectionID=()=>!!this._getConnectionID(),this.connectUser=(s,r)=>b(this,null,function*(){if(!s.id)throw new Error('The "id" field on the user is missing');if(this.userID===s.id&&this.setUserPromise)return this.logger("warn","Consecutive calls to connectUser is detected, ideally you should only call this function once in your app."),this.setUserPromise;if(this.userID)throw new Error("Use client.disconnect() before trying to connect as a different user. connectUser was called twice.");(this._isUsingServerAuth()||this.node)&&!this.options.allowServerSideConnect&&this.logger("warn",'Please do not use connectUser server side. connectUser impacts MAU and concurrent connection usage and thus your bill. If you have a valid use-case, add "allowServerSideConnect: true" to the client options to disable this warning.'),this.userID=s.id,this.anonymous=!1;let o=this._setToken(s,r,this.anonymous);this._setUser(s);let a=this.openConnection();this.setUserPromise=Promise.all([o,a]).then(l=>l[1]);try{return yield this.setUserPromise}catch(l){throw this.persistUserOnConnectionFailure?this.closeConnection():this.disconnectUser(),l}}),this._setToken=(s,r,o)=>this.tokenManager.setTokenOrProvider(r,s,o),this._setUser=s=>{this.user=s,this.userID=s.id,this._user=E({},s)},this.closeConnection=s=>b(this,null,function*(){return this.cleaningIntervalRef!=null&&(clearInterval(this.cleaningIntervalRef),this.cleaningIntervalRef=void 0),yield Promise.all([this.wsConnection?.disconnect(s),this.wsFallback?.disconnect(s)]),Promise.resolve()}),this.openConnection=()=>b(this,null,function*(){if(!this.userID)throw Error("UserWithId is not set on client, use client.connectUser or client.connectAnonymousUser instead");return this.wsConnection?.isConnecting&&this.wsPromise?(this.logger("info","client:openConnection() - connection already in progress"),this.wsPromise):(this.wsConnection?.isHealthy||this.wsFallback?.isHealthy())&&this._hasConnectionID()?(this.logger("info","client:openConnection() - openConnection called twice, healthy connection already exists"),Promise.resolve()):(this.connectionIdPromise=new Promise((s,r)=>{this.resolveConnectionId=s,this.rejectConnectionId=r}),this.clientID=`${this.userID}--${xi()}`,this.wsPromise=this.connect(),this.wsPromise)}),this._normalizeDate=s=>{if(s instanceof Date&&(s=s.toISOString()),s==="")throw new Error("Don't pass blank string for since, use null instead if resetting the token revoke");return s},this.disconnectUser=s=>b(this,null,function*(){this.logger("info","client:disconnect() - Disconnecting the client"),delete this.user,delete this._user,delete this.userID,this.anonymous=!1,yield this.closeConnection(s),this.tokenManager.reset(),this.connectionIdPromise=void 0,this.rejectConnectionId=void 0,this.resolveConnectionId=void 0}),this.connectGuestUser=s=>b(this,null,function*(){this.guestUserCreatePromise=this.doAxiosRequest("post","/guest",{user:E({},s)},{publicEndpoint:!0});let r=yield this.guestUserCreatePromise;return this.guestUserCreatePromise.finally(()=>this.guestUserCreatePromise=void 0),this.connectUser(r.user,r.access_token)}),this.connectAnonymousUser=(s,r)=>b(this,null,function*(){this.connectionIdPromise=new Promise((o,a)=>{this.resolveConnectionId=o,this.rejectConnectionId=a}),this.anonymous=!0,yield this._setToken(s,r,this.anonymous),this._setUser(s),this.resolveConnectionId?.()}),this.on=(s,r)=>(this.listeners[s]||(this.listeners[s]=[]),this.logger("debug",`Adding listener for ${s} event`),this.listeners[s]?.push(r),()=>{this.off(s,r)}),this.off=(s,r)=>{this.listeners[s]||(this.listeners[s]=[]),this.logger("debug",`Removing listener for ${s} event`),this.listeners[s]=this.listeners[s]?.filter(o=>o!==r)},this._logApiRequest=(s,r,o,a)=>{this.logger("trace",`client: ${s} - Request - ${r}`,{payload:o,config:a})},this._logApiResponse=(s,r,o)=>{this.logger("trace",`client:${s} - Response - url: ${r} > status ${o.status}`,{response:o})},this._logApiError=(s,r,o)=>{this.logger("error",`client:${s} - Error - url: ${r}`,{url:r,error:o})},this.doAxiosRequest=(l,c,u,...h)=>b(this,[l,c,u,...h],function*(s,r,o,a={}){a.publicEndpoint||(yield Promise.all([this.tokenManager.tokenReady(),this.guestUserCreatePromise,this.connectionIdPromise]));let d=this._enrichAxiosOptions(a);try{let f;switch(this._logApiRequest(s,r,o,d),s){case"get":f=yield this.axiosInstance.get(r,d);break;case"delete":f=yield this.axiosInstance.delete(r,d);break;case"post":f=yield this.axiosInstance.post(r,o,d);break;case"put":f=yield this.axiosInstance.put(r,o,d);break;case"patch":f=yield this.axiosInstance.patch(r,o,d);break;case"options":f=yield this.axiosInstance.options(r,d);break;default:throw new Error("Invalid request type")}return this._logApiResponse(s,r,f),this.consecutiveFailures=0,this.handleResponse(f)}catch(f){if(f.client_request_id=d.headers?.["x-client-request-id"],this.consecutiveFailures+=1,f.response)return this._logApiError(s,r,f.response),f.response.data.code===st.TOKEN_EXPIRED&&!this.tokenManager.isStatic()?(this.consecutiveFailures>1&&(yield Ke(_t(this.consecutiveFailures))),yield this.tokenManager.loadToken(),yield this.doAxiosRequest(s,r,o,a)):this.handleResponse(f.response);throw this._logApiError(s,r,f),f}}),this.get=(s,r)=>this.doAxiosRequest("get",s,null,{params:r}),this.put=(s,r,o)=>this.doAxiosRequest("put",s,r,{params:o}),this.post=(s,r,o)=>this.doAxiosRequest("post",s,r,{params:o}),this.patch=(s,r,o)=>this.doAxiosRequest("patch",s,r,{params:o}),this.delete=(s,r)=>this.doAxiosRequest("delete",s,null,{params:r}),this.errorFromResponse=s=>{let r;return r=new wa(`Stream error HTTP code: ${s.status}`),s.data&&s.data.code&&(r=new Error(`Stream error code ${s.data.code}: ${s.data.message}`),r.code=s.data.code),r.response=s,r.status=s.status,r},this.handleResponse=s=>{let r=s.data;if(Nm(s))throw this.errorFromResponse(s);return r},this.dispatchEvent=s=>{if(s.received_at||(s.received_at=new Date),this.logger("debug",`Dispatching event: ${s.type}`,s),!!this.listeners){for(let r of this.listeners.all||[])r(s);for(let r of this.listeners[s.type]||[])r(s)}},this.connect=()=>b(this,null,function*(){if(!this.userID||!this._user)throw Error("Call connectUser or connectAnonymousUser before starting the connection");if(!this.wsBaseURL)throw Error("Websocket base url not set");if(!this.clientID)throw Error("clientID is not set");!this.wsConnection&&(this.options.warmUp||this.options.enableInsights)&&this._sayHi(),this.options.wsConnection&&this.node?(this.options.wsConnection.setClient(this),this.wsConnection=this.options.wsConnection):this.wsConnection=new bc(this);try{return this.wsFallback?yield this.wsFallback.connect():(this.logger("info","StreamClient.connect: this.wsConnection.connect()"),yield this.wsConnection.connect(this.options.enableWSFallback?this.defaultWSTimeoutWithFallback:this.defaultWSTimeout))}catch(s){if(this.options.enableWSFallback&&Pm(s)&&Rp(this.logger))return this.logger("warn","client:connect() - WS failed, fallback to longpoll"),this.dispatchEvent({type:"transport.changed",mode:"longpoll"}),this.wsConnection._destroyCurrentWSConnection(),this.wsConnection.disconnect().then(),this.wsFallback=new kc(this),yield this.wsFallback.connect();throw s}}),this._sayHi=()=>{let s=xi(),r={headers:Ou.from({"x-client-request-id":s})};this.doAxiosRequest("get",this.baseURL+"/hi",null,r).catch(o=>{this.options.enableInsights&&gc("http_hi_failed",{api_key:this.key,err:o,client_request_id:s})})},this.getUserAgent=()=>this.userAgent||`stream-video-javascript-client-${this.node?"node":"browser"}-1.4.3`,this.setUserAgent=s=>{this.userAgent=s},this._isUsingServerAuth=()=>!!this.secret,this._enrichAxiosOptions=(s={params:{},headers:{},config:{}})=>{let r=s.publicEndpoint&&!this.user?void 0:this._getToken(),o=r?{Authorization:r}:void 0,a=null;return this.nextRequestAbortController!==null&&(a=this.nextRequestAbortController.signal,this.nextRequestAbortController=null),s.headers?.["x-client-request-id"]||(s.headers=L(E({},s.headers),{"x-client-request-id":xi()})),E(E(E({params:E({user_id:this.userID,connection_id:this._getConnectionID(),api_key:this.key},s.params),headers:E(L(E({},o),{"stream-auth-type":s.publicEndpoint&&!this.user?"anonymous":this.getAuthType(),"X-Stream-Client":this.getUserAgent()}),s.headers)},a?{signal:a}:{}),s.config),this.options.axiosRequestConfig)},this._getToken=()=>this.tokenManager?this.tokenManager.getToken():null,this._buildWSPayload=s=>JSON.stringify({user_id:this.userID,user_details:this._user,client_request_id:s}),this.createAbortControllerForNextRequest=()=>this.nextRequestAbortController=new AbortController,this.key=e,this.secret=t?.secret;let n=t||{browser:typeof window<"u"};this.browser=n.browser||typeof window<"u",this.node=!this.browser,this.browser&&(this.locationHint=cd(t?.locationHintUrl,t?.locationHintTimeout)),this.options=E({timeout:5e3,withCredentials:!1,warmUp:!1},n),this.node&&!this.options.httpsAgent&&(this.options.httpsAgent=new gm.Agent({keepAlive:!0,keepAliveMsecs:3e3})),this.setBaseURL(this.options.baseURL||"https://video.stream-io-api.com/video"),typeof process<"u"&&process.env.STREAM_LOCAL_TEST_RUN&&this.setBaseURL("http://localhost:3030/video"),typeof process<"u"&&process.env.STREAM_LOCAL_TEST_HOST&&this.setBaseURL(`http://${process.env.STREAM_LOCAL_TEST_HOST}/video`),this.axiosInstance=Ct.create(L(E({},this.options),{baseURL:this.baseURL})),this.wsConnection=null,this.wsPromise=null,this.setUserPromise=null,this.anonymous=!1,this.persistUserOnConnectionFailure=this.options?.persistUserOnConnectionFailure,this.tokenManager=new Sc(this.secret),this.consecutiveFailures=0,this.insightMetrics=new mc,this.defaultWSTimeoutWithFallback=6e3,this.defaultWSTimeout=15e3,this.logger=ec(n.logger)?n.logger:()=>null}},Zn=class{constructor(e,t){this.logLevel="warn",this.eventHandlersToUnregister=[],this.disconnectUser=r=>b(this,null,function*(){if(!this.streamClient.user&&!this.connectionPromise)return;let o=()=>this.streamClient.disconnectUser(r);this.disconnectionPromise=this.connectionPromise?this.connectionPromise.then(()=>o()):o(),this.disconnectionPromise.finally(()=>this.disconnectionPromise=void 0),yield this.disconnectionPromise,this.eventHandlersToUnregister.forEach(a=>a()),this.eventHandlersToUnregister=[],this.writeableStateStore.setConnectedUser(void 0)}),this.on=(r,o)=>this.streamClient.on(r,o),this.off=(r,o)=>this.streamClient.off(r,o),this.call=(r,o)=>new Rt({streamClient:this.streamClient,id:o,type:r,clientStore:this.writeableStateStore}),this.createGuestUser=r=>b(this,null,function*(){return this.streamClient.doAxiosRequest("post","/guest",r,{publicEndpoint:!0})}),this.queryCalls=(...o)=>b(this,[...o],function*(r={}){let a=yield this.streamClient.post("/calls",r),l=[];for(let c of a.calls){let u=new Rt({streamClient:this.streamClient,id:c.call.id,type:c.call.type,members:c.members,ownCapabilities:c.own_capabilities,watching:r.watch,clientStore:this.writeableStateStore});u.state.updateFromCallResponse(c.call),yield u.applyDeviceConfig(),r.watch&&this.writeableStateStore.registerCall(u),l.push(u)}return L(E({},a),{calls:l})}),this.queryCallStats=(...o)=>b(this,[...o],function*(r={}){return this.streamClient.post("/call/stats",r)}),this.edges=()=>b(this,null,function*(){return this.streamClient.get("/edges")}),this.addDevice=(r,o,a,l,c)=>b(this,null,function*(){return yield this.streamClient.post("/devices",E(E({id:r,push_provider:o,voip_token:c},l!=null?{user_id:l}:{}),a!=null?{push_provider_name:a}:{}))}),this.getDevices=r=>b(this,null,function*(){return yield this.streamClient.get("/devices",r?{user_id:r}:{})}),this.removeDevice=(r,o)=>b(this,null,function*(){return yield this.streamClient.delete("/devices",E({id:r},o?{user_id:o}:{}))}),this.onRingingCall=r=>b(this,null,function*(){let o=this.readOnlyStateStore.calls.find(a=>a.cid===r&&a.ringing);if(!o){let[a,l]=r.split(":");o=new Rt({streamClient:this.streamClient,type:a,id:l,clientStore:this.writeableStateStore,ringing:!0}),yield o.get()}return o}),this.connectAnonymousUser=(r,o)=>b(this,null,function*(){let a=()=>this.streamClient.connectAnonymousUser(r,o);return this.connectionPromise=this.disconnectionPromise?this.disconnectionPromise.then(()=>a()):a(),this.connectionPromise.finally(()=>this.connectionPromise=void 0),this.connectionPromise});let n=gd,s="warn";if(typeof e=="string"?(s=t?.logLevel||s,n=t?.logger||n):(s=e.options?.logLevel||s,n=e.options?.logger||n),Hf(n,s),this.logger=ie(["client"]),typeof e=="string")this.streamClient=new Qn(e,L(E({persistUserOnConnectionFailure:!0},t),{logLevel:s,logger:this.logger}));else{this.streamClient=new Qn(e.apiKey,L(E({persistUserOnConnectionFailure:!0},e.options),{logLevel:s,logger:this.logger}));let r=Jo();r&&this.streamClient.setUserAgent(this.streamClient.getUserAgent()+`-video-${Di[r.type].toLowerCase()}-sdk-${r.major}.${r.minor}.${r.patch}`)}if(this.writeableStateStore=new Xo,this.readOnlyStateStore=new Yo(this.writeableStateStore),typeof e!="string"){let r=e.user,o=e.token||e.tokenProvider;r&&this.connectUser(r,o).catch(a=>{this.logger("error","Failed to connect",a)})}}get state(){return this.readOnlyStateStore}connectUser(e,t){return b(this,null,function*(){if(e.type==="anonymous")return e.id="!anon",this.connectAnonymousUser(e,t);let n=()=>this.streamClient.connectUser(e,t);e.type==="guest"&&(n=()=>b(this,null,function*(){return this.streamClient.connectGuestUser(e)})),this.connectionPromise=this.disconnectionPromise?this.disconnectionPromise.then(()=>n()):n(),this.connectionPromise?.finally(()=>this.connectionPromise=void 0);let s=yield this.connectionPromise;return s?.me&&this.writeableStateStore.setConnectedUser(s.me),this.eventHandlersToUnregister.push(this.on("connection.changed",r=>{if(r.online){let o=this.writeableStateStore.calls.filter(a=>a.watching).map(a=>a.cid);this.logger("info",`Rewatching calls after connection changed ${o.join(", ")}`),o.length>0&&this.queryCalls({watch:!0,filter_conditions:{cid:{$in:o}},sort:[{field:"cid",direction:1}]}).catch(a=>{this.logger("error","Failed to re-watch calls",a)})}})),this.eventHandlersToUnregister.push(this.on("call.created",r=>{let{call:o,members:a}=r;if(e.id===o.created_by.id){this.logger("warn","Received `call.created` sent by the current user");return}this.logger("info",`New call created and registered: ${o.cid}`);let l=new Rt({streamClient:this.streamClient,type:o.type,id:o.id,members:a,clientStore:this.writeableStateStore});l.state.updateFromCallResponse(o),this.writeableStateStore.registerCall(l)})),this.eventHandlersToUnregister.push(this.on("call.ring",r=>b(this,null,function*(){let{call:o,members:a}=r;if(e.id===o.created_by.id){this.logger("debug","Received `call.ring` sent by the current user so ignoring the event");return}yield this.writeableStateStore.findCall(o.type,o.id)?.leave({reason:"cleaning-up in call.ring"});let c=new Rt({streamClient:this.streamClient,type:o.type,id:o.id,members:a,clientStore:this.writeableStateStore,ringing:!0});c.state.updateFromCallResponse(o),yield c.get(),this.writeableStateStore.registerCall(c)}))),s})}addVoipDevice(e,t,n,s){return b(this,null,function*(){return yield this.addDevice(e,t,n,s,!0)})}};var Ad={production:!1,STREAM_VIDEO_API_KEY:"qybp6wc6myjg"};var Zt=(()=>{let e=class e{getParticipantsToLocalStorage(){let n=localStorage.getItem("participants");return n===null?[]:JSON.parse(n)}constructor(){this.callId=ge(void 0),this.isCallCreated=ge(void 0),this.asyncEffectCallId=At(()=>b(this,null,function*(){let n=this.callId();if(n===void 0)return;let s=this.client.call("default",n);yield s.join({create:!0}),yield s.camera.enable(),yield s.microphone.enable(),this.isCallCreated.update(()=>s)})),this.usersData=ge([{token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiRmVkZXJpY29fU2lsdmEifQ.Vk-x6Id5xbzTGz1cfdjHplkOtA92RdrYoRUjEZrB7p8",user:{id:"Federico_Silva",name:"Federico Silva"}},{token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiTWF4X1NhYXZlZHJhIn0.eEzYzoSWuOvB-I-_syIjpJnUS3Nb8qsas7gd-FCHPsM",user:{id:"Max_Saavedra",name:"Max Saavedra"}},{token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiSm9yZ2VfQ2F5ZXRhbm8ifQ.0kAE6NdbRBAqlDjLuIhyd54puxhME5yQ53y_2-4QTp8",user:{id:"Jorge_Cayetano",name:"Jorge Cayetano"}},{token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiRmFicmljaW9fVmlkYWwifQ.duQcWNxXm0R4u1Akpe8TYenPtEk1TZfiDYF9ChBJENQ",user:{id:"Fabricio_Vidal",name:"Fabricio Vidal"}},{token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiTWFyaWFfRG9lIn0.HPGg_-Gut6QBho-C28tdiumz9leDy5mKgjqWKQZTyHU",user:{id:"Maria_Doe",name:"Maria Doe"}},{token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiSmhvbl9Eb2UifQ.BcMKHlIpD92BbNhF72NgNkqTHC10fJnlvsmu2NWvbVs",user:{id:"Jhon_Doe",name:"Jhon Doe"}},{token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiUGltcG9sbG8ifQ.6xZzSAmR2HV4Ax6JLyzIPlOUIqY9LeQjGCz9x-02oqY",user:{id:"Pimpollo",name:"Pimpollo"}},{token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiRGFmbmEifQ.d5h0DDyduV3HbIgc-jppkwLwQLbrRxguX0BcwfUtbgY",user:{id:"Dafna",name:"Dafna"}},{token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiRmlvcmVsbGEifQ.EBcPenRpnogdEfr90hiTnIqeDom33-rO8CN_4SNYHBs",user:{id:"Fiorella",name:"Fiorella"}},{token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiTWF0ZW8ifQ.wInimUBtrPxVXomtOn-Rnj7-ryjR1oyWFKg26i5l51k",user:{id:"Mateo",name:"Mateo"}}]),localStorage.setItem("participants",JSON.stringify(this.usersData())),this.client=this.streamVideoClient()}streamVideoClient(){let n=this.getParticipantsToLocalStorage(),s=this.usersData().find(o=>!n.find(a=>a.userId===o.user.id)),r={apiKey:Ad.STREAM_VIDEO_API_KEY,token:s?.token,user:s?.user};return new Zn(r)}setCallId(n){if(n===void 0){let s=this.isCallCreated();s&&s.leave(),this.isCallCreated.update(()=>n)}this.callId.update(()=>n)}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=Gc({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var xm=["videoCallElement"],Dm=i=>({height:i});function Am(i,e){i&1&&(J(0,"div",2),be(1,"div",3),Z())}var Ud=(()=>{let e=class e{constructor(){this.callingService=at(Zt),this.participant=ys.required(),this.sessionId=ge([]),this.isCameraOn=ys(!0),this.effectParticipants=At(()=>{let n=this.callingService.isCallCreated(),s=document.getElementById(`video-${this.participant().sessionId}`);if(n&&this.participant().sessionId!==void 0&&!s){let r=document.createElement("video");r.autoplay=!0,r.style.maxHeight="25rem",r.id=`video-${this.participant().sessionId}`,r.setAttribute("sessionId",this.participant().sessionId);let o=document.createElement("audio");o.id=`audio-${this.participant().sessionId}`,this.videoElement.nativeElement.appendChild(r),this.videoElement.nativeElement.appendChild(o),this.unbindVideoElement=n.bindVideoElement(r,this.participant().sessionId,"videoTrack"),this.unbindAudioElement=n.bindAudioElement(o,this.participant().sessionId)}},{allowSignalWrites:!0})}ngOnDestroy(){this.unbindVideoElement?.(),this.unbindAudioElement?.()}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=Ot({type:e,selectors:[["dashboard-participant-video-card"]],viewQuery:function(s,r){if(s&1&&Qc(xm,5),s&2){let o;Zc(o=el())&&(r.videoElement=o.first)}},inputs:{participant:[1,"participant"],isCameraOn:[1,"isCameraOn"]},standalone:!0,features:[Dt],decls:3,vars:5,consts:[["videoCallElement",""],[1,"relative","w-full","flex","flex-col","items-center","justify-center","bg-no-repeat","bg-center","my-6"],[1,"w-full","absolute","flex","flex-col","items-center","z-99","top-0","bottom-0","bg-indigo-500",2,"height","25rem"],[1,"bg-cover","bg-top","bg-no-repeat","rounded-lg",2,"width","25rem","height","25rem","background-image","url('https://i.ibb.co/bLcpXrR/32a0d2d2-1-Photoroom.png')"]],template:function(s,r){s&1&&(J(0,"div",1,0),ot(2,Am,2,0,"div",2),Z()),s&2&&(Kc(il(3,Dm,r.isCameraOn()?"":"25rem")),me(2),lt(r.isCameraOn()?-1:2))},styles:["[_nghost-%COMP%]{width:100%!important}"]});let i=e;return i})();function Um(i,e){if(i&1&&be(0,"dashboard-participant-video-card",3),i&2){let t=e.$implicit;ct("participant",t)}}function Lm(i,e){i&1&&(Me(),J(0,"svg",7),be(1,"path",15),Z())}function Fm(i,e){i&1&&(Me(),J(0,"svg",8),be(1,"path",16),Z())}function Bm(i,e){i&1&&(Me(),J(0,"svg",10),be(1,"path",17),Z())}function Vm(i,e){i&1&&(Me(),J(0,"svg",8),be(1,"path",18),Z())}var Ld=(()=>{let e=class e{constructor(){this.callingService=at(Zt),this.remoteParticipants=ge([]),this.localParticipant=ge({}),this.callResponse=ge(null),this.isCamera=ge(!0),this.isMicrophone=ge(!0),this.isLeaveCall=Jc(),this.setInterval=ge(void 0),this.asyncEffectCallResponse=At(()=>b(this,null,function*(){let n=this.callingService.isCallCreated();if(n){let s=(yield n.get()).call;this.callResponse.update(()=>s)}}))}toggleMicrophone(){let n=this.callingService.isCallCreated();n&&(n.microphone.toggle(),this.isMicrophone.update(()=>!this.isMicrophone()))}toggleCamera(){let n=this.callingService.isCallCreated();n&&(n.camera.toggle(),this.isCamera.update(()=>!this.isCamera()))}leaveCall(){this.isLeaveCall.emit(void 0)}ngOnInit(){this.setInterval.update(()=>setInterval(()=>this.initializeParticipants(),1e3))}initializeParticipants(){let n=this.callingService.isCallCreated();n&&(n.state.localParticipant$.subscribe(s=>{s&&this.localParticipant.update(()=>s)}),n.state.remoteParticipants$.subscribe(s=>{this.remoteParticipants.update(()=>s)}))}ngOnDestroy(){clearInterval(this.setInterval())}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=Ot({type:e,selectors:[["dashboard-video-call-card"]],outputs:{isLeaveCall:"isLeaveCall"},standalone:!0,features:[Dt],decls:20,vars:5,consts:[[1,"w-full","h-full","flex","flex-col","items-center"],[3,"isCameraOn","participant"],[1,"w-full","h-full","flex","flex-row","space-x-8","p-8","flex-nowrap"],[3,"participant"],[1,"flex","flex-row","space-x-4","py-4"],[1,"camera-item"],["type","button",1,"flex","flex-row","items-center","text-white","bg-indigo-500","border-0","p-4","focus:outline-none","hover:bg-indigo-600","rounded-full","text-lg","transition-colors","duration-150",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 576 512","stroke","currentColor","fill","currentColor",1,"size-4"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 640 512","stroke","currentColor","fill","currentColor",1,"size-4"],[1,"microphone-item"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 384 512","stroke","currentColor","fill","currentColor",1,"size-4"],[1,"leave-item"],["type","button",1,"flex","flex-row","items-center","text-white","bg-red-500","border-0","p-4","focus:outline-none","hover:bg-red-600","rounded-full","text-lg","transition-colors","duration-150",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 512 512","stroke","currentColor","fill","currentColor",1,"size-4",2,"transform","rotate(135deg)"],["d","M164.9 24.6c-7.7-18.6-28-28.5-47.4-23.2l-88 24C12.1 30.2 0 46 0 64C0 311.4 200.6 512 448 512c18 0 33.8-12.1 38.6-29.5l24-88c5.3-19.4-4.6-39.7-23.2-47.4l-96-40c-16.3-6.8-35.2-2.1-46.3 11.6L304.7 368C234.3 334.7 177.3 277.7 144 207.3L193.3 167c13.7-11.2 18.4-30 11.6-46.3l-40-96z"],["d","M0 128C0 92.7 28.7 64 64 64H320c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128zM559.1 99.8c10.4 5.6 16.9 16.4 16.9 28.2V384c0 11.8-6.5 22.6-16.9 28.2s-23 5-32.9-1.6l-96-64L416 337.1V320 192 174.9l14.2-9.5 96-64c9.8-6.5 22.4-7.2 32.9-1.6z"],["d","M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7l-86.4-67.7 13.8 9.2c9.8 6.5 22.4 7.2 32.9 1.6s16.9-16.4 16.9-28.2V128c0-11.8-6.5-22.6-16.9-28.2s-23-5-32.9 1.6l-96 64L448 174.9V192 320v5.8l-32-25.1V128c0-35.3-28.7-64-64-64H113.9L38.8 5.1zM407 416.7L32.3 121.5c-.2 2.1-.3 4.3-.3 6.5V384c0 35.3 28.7 64 64 64H352c23.4 0 43.9-12.6 55-31.3z"],["d","M192 0C139 0 96 43 96 96V256c0 53 43 96 96 96s96-43 96-96V96c0-53-43-96-96-96zM64 216c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c0 89.1 66.2 162.7 152 174.4V464H120c-13.3 0-24 10.7-24 24s10.7 24 24 24h72 72c13.3 0 24-10.7 24-24s-10.7-24-24-24H216V430.4c85.8-11.7 152-85.3 152-174.4V216c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c0 70.7-57.3 128-128 128s-128-57.3-128-128V216z"],["d","M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L472.1 344.7c15.2-26 23.9-56.3 23.9-88.7V216c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c0 21.2-5.1 41.1-14.2 58.7L416 300.8V96c0-53-43-96-96-96s-96 43-96 96v54.3L38.8 5.1zm362.5 407l-43.1-33.9C346.1 382 333.3 384 320 384c-70.7 0-128-57.3-128-128v-8.7L144.7 210c-.5 1.9-.7 3.9-.7 6v40c0 89.1 66.2 162.7 152 174.4V464H248c-13.3 0-24 10.7-24 24s10.7 24 24 24h72 72c13.3 0 24-10.7 24-24s-10.7-24-24-24H344V430.4c20.4-2.8 39.7-9.1 57.3-18.2z"]],template:function(s,r){if(s&1&&(J(0,"div",0),be(1,"dashboard-participant-video-card",1),J(2,"span"),xt(3),Z(),J(4,"div",2),Xc(5,Um,1,1,"dashboard-participant-video-card",3,zc),Z(),J(7,"div",4)(8,"div",5)(9,"button",6),ut("click",function(){return r.toggleCamera()}),ot(10,Lm,2,0,":svg:svg",7)(11,Fm,2,0,":svg:svg",8),Z()(),J(12,"div",9)(13,"button",6),ut("click",function(){return r.toggleMicrophone()}),ot(14,Bm,2,0,":svg:svg",10)(15,Vm,2,0,":svg:svg",8),Z()(),J(16,"div",11)(17,"button",12),ut("click",function(){return r.leaveCall()}),Me(),J(18,"svg",13),be(19,"path",14),Z()()()()()),s&2){let o;me(),ct("isCameraOn",r.isCamera())("participant",r.localParticipant()),me(2),tl("Sala: ",(o=r.callResponse())==null?null:o.id,""),me(2),Yc(r.remoteParticipants()),me(5),lt(r.isCamera()?10:11),me(4),lt(r.isMicrophone()?14:15)}},dependencies:[Ud],styles:["[_nghost-%COMP%]{width:100%!important}"]});let i=e;return i})();function jm(i,e){if(i&1){let t=Ss();J(0,"dashboard-video-call-card",4),ut("isLeaveCall",function(s){qi(t);let r=ci();return Gi(r.leaveCall(s))}),Z()}}function Mm(i,e){i&1&&(Me(),J(0,"svg",16),be(1,"path",17),Z(),Ji(),J(2,"span",15),xt(3,"Cargando"),Z())}function $m(i,e){i&1&&(J(0,"span",15),xt(1,"Unirse"),Z())}function Wm(i,e){if(i&1){let t=Ss();J(0,"div",1)(1,"div",5)(2,"div")(3,"button",6),ut("click",function(){qi(t);let s=ci();return Gi(s.onCallCreate())}),Me(),J(4,"svg",7),be(5,"path",8),Z(),Ji(),J(6,"span",9),xt(7,"Reuni\xF3n nueva"),Z()()(),J(8,"form",10),ut("ngSubmit",function(){qi(t);let s=ci();return Gi(s.onCallJoin())}),J(9,"div")(10,"coral-input",11),Me(),J(11,"svg",12),be(12,"path",13),Z()()(),Ji(),J(13,"div")(14,"button",14),ot(15,Mm,4,0)(16,$m,2,0,"span",15),Z()()()()()}if(i&2){let t=ci();me(3),ct("disabled",t.isLoading()),me(5),ct("formGroup",t.form),me(6),ct("disabled",t.isLoading()),me(),lt(t.isLoading()?15:16)}}var Iw=(()=>{let e=class e{constructor(){this.callingService=at(Zt),this.chatService=at(fl),this.fb=at(ll),this.isLoading=ge(!1),this.form=this.fb.group({callId:["",nl.required]}),this.getChatItems=ks(()=>this.chatService.chatItems()),this.isCallCreated=ks(()=>this.callingService.isCallCreated())}onCallJoin(){if(this.form.invalid)return;this.isLoading.set(!0);let{callId:n}=this.form.value;this.callingService.setCallId(n??"")}onCallCreate(){this.isLoading.set(!0);let n=this.randomCallId(10);this.callingService.setCallId(n)}randomCallId(n){return Math.random().toString(36).substring(2,n+2)}leaveCall(n){this.callingService.setCallId(n),this.isLoading.set(!1),localStorage.removeItem("participants")}getChatItemsToLocalStorage(){localStorage.getItem("chatItems")===null?localStorage.setItem("chatItems",JSON.stringify(this.chatService.chatItems())):this.chatService.chatItems.set(JSON.parse(localStorage.getItem("chatItems")))}ngOnInit(){this.getChatItemsToLocalStorage()}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=Ot({type:e,selectors:[["app-group-page"]],standalone:!0,features:[Dt],decls:5,vars:2,consts:[[1,"w-full","h-full","flex","flex-row","justify-between"],[1,"w-full","h-full","flex","flex-col","items-center","justify-center"],[2,"max-width","30rem"],["isVideoCall","",3,"chatItems"],[3,"isLeaveCall"],[1,"flex","flex-row","items-center","space-x-4"],["type","button",1,"w-full","flex","flex-row","items-center","space-x-2","text-white","bg-indigo-500","border-0","py-2","px-8","focus:outline-none","hover:bg-indigo-600","rounded","text-lg","transition-colors","duration-150",3,"click","disabled"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 512 512","stroke","currentColor","fill","currentColor",1,"size-4"],["d","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM232 344V280H168c-13.3 0-24-10.7-24-24s10.7-24 24-24h64V168c0-13.3 10.7-24 24-24s24 10.7 24 24v64h64c13.3 0 24 10.7 24 24s-10.7 24-24 24H280v64c0 13.3-10.7 24-24 24s-24-10.7-24-24z"],[1,"font-semibold"],["autocomplete","off",1,"flex","flex-row","items-center","space-x-4",3,"ngSubmit","formGroup"],["inputPlaceholder","Ingresa un c\xF3digo","inputClass","bg-white","formControlName","callId"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 576 512","stroke","currentColor","fill","currentColor",1,"size-4","text-gray-500"],["d","M64 64C28.7 64 0 92.7 0 128V384c0 35.3 28.7 64 64 64H512c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H64zm16 64h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V144c0-8.8 7.2-16 16-16zM64 240c0-8.8 7.2-16 16-16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V240zm16 80h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V336c0-8.8 7.2-16 16-16zm80-176c0-8.8 7.2-16 16-16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16V144zm16 80h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16V240c0-8.8 7.2-16 16-16zM160 336c0-8.8 7.2-16 16-16H400c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16V336zM272 128h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H272c-8.8 0-16-7.2-16-16V144c0-8.8 7.2-16 16-16zM256 240c0-8.8 7.2-16 16-16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H272c-8.8 0-16-7.2-16-16V240zM368 128h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H368c-8.8 0-16-7.2-16-16V144c0-8.8 7.2-16 16-16zM352 240c0-8.8 7.2-16 16-16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H368c-8.8 0-16-7.2-16-16V240zM464 128h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H464c-8.8 0-16-7.2-16-16V144c0-8.8 7.2-16 16-16zM448 240c0-8.8 7.2-16 16-16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H464c-8.8 0-16-7.2-16-16V240zm16 80h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H464c-8.8 0-16-7.2-16-16V336c0-8.8 7.2-16 16-16z"],["type","submit",1,"w-full","flex","flex-row","items-center","space-x-2","text-white","bg-transparent","border-0","py-2","px-4","focus:outline-none","hover:bg-indigo-100","rounded","text-lg","transition-colors","duration-150",3,"disabled"],[1,"text-indigo-500","font-semibold"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 512 512","stroke","currentColor","fill","currentColor",1,"size-4","text-indigo-500","animate-spin"],["d","M222.7 32.1c5 16.9-4.6 34.8-21.5 39.8C121.8 95.6 64 169.1 64 256c0 106 86 192 192 192s192-86 192-192c0-86.9-57.8-160.4-137.1-184.1c-16.9-5-26.6-22.9-21.5-39.8s22.9-26.6 39.8-21.5C434.9 42.1 512 140 512 256c0 141.4-114.6 256-256 256S0 397.4 0 256C0 140 77.1 42.1 182.9 10.6c16.9-5 34.8 4.6 39.8 21.5z"]],template:function(s,r){s&1&&(J(0,"div",0),ot(1,jm,1,0,"dashboard-video-call-card")(2,Wm,17,4,"div",1),J(3,"div",2),be(4,"dashboard-search-card",3),Z()()),s&2&&(me(),lt(r.isCallCreated()?1:2),me(3),ct("chatItems",r.getChatItems()))},dependencies:[hl,dl,ul,al,sl,rl,ol,cl,Ld],styles:["[_nghost-%COMP%]{width:100%!important}"]});let i=e;return i})();export{Iw as default};
